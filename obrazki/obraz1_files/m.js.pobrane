(()=>{"use strict";var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{debug:()=>ng,error:()=>og,fatal:()=>ig,fmt:()=>Zm,info:()=>sg,trace:()=>tg,warn:()=>rg});var n={};e.r(n),e.d(n,{count:()=>lg,distribution:()=>pg,gauge:()=>dg});var s={};e.r(s),e.d(s,{BrowserClient:()=>pr,OpenFeatureIntegrationHook:()=>Dy,SDK_VERSION:()=>o,SEMANTIC_ATTRIBUTE_SENTRY_OP:()=>gt,SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN:()=>yt,SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE:()=>ft,SEMANTIC_ATTRIBUTE_SENTRY_SOURCE:()=>ht,Scope:()=>fe,WINDOW:()=>ar,addBreadcrumb:()=>Rr,addEventProcessor:()=>nr,addIntegration:()=>Ae,breadcrumbsIntegration:()=>Zr,browserApiErrorsIntegration:()=>to,browserProfilingIntegration:()=>Mc,browserSessionIntegration:()=>oo,browserTracingIntegration:()=>tc,buildLaunchDarklyFlagUsedHandler:()=>Ep,captureConsoleIntegration:()=>gf,captureEvent:()=>qs,captureException:()=>Hs,captureFeedback:()=>Ip,captureMessage:()=>zs,captureSession:()=>ir,chromeStackLineParser:()=>Io,close:()=>Zs,consoleLoggingIntegration:()=>_f,contextLinesIntegration:()=>Ug,continueTrace:()=>hi,createConsolaReporter:()=>wf,createTransport:()=>Vo,createUserFeedbackEnvelope:()=>Cg,dedupeIntegration:()=>Ye,defaultRequestInstrumentationOptions:()=>Xa,defaultStackLineParsers:()=>Fo,defaultStackParser:()=>$o,diagnoseSdkConnectivity:()=>By,endSession:()=>rr,eventFiltersIntegration:()=>Le,eventFromException:()=>Fs,eventFromMessage:()=>$s,exceptionFromError:()=>Rs,extraErrorDataIntegration:()=>Tf,featureFlagsIntegration:()=>If,feedbackAsyncIntegration:()=>ff,feedbackIntegration:()=>mf,feedbackSyncIntegration:()=>mf,flush:()=>Qs,forceLoad:()=>ei,functionToStringIntegration:()=>Ue,geckoStackLineParser:()=>Ro,getActiveSpan:()=>un,getClient:()=>Ee,getCurrentScope:()=>Se,getDefaultIntegrations:()=>Qo,getFeedback:()=>Up,getGlobalScope:()=>ke,getIsolationScope:()=>we,getReplay:()=>bp,getRootSpan:()=>cn,getSpanDescendants:()=>an,getSpanStatusFromHttpCode:()=>Lt,getTraceData:()=>Wa,globalHandlersIntegration:()=>ho,graphqlClientIntegration:()=>Wg,growthbookIntegration:()=>$y,httpClientIntegration:()=>Ng,httpContextIntegration:()=>go,inboundFiltersIntegration:()=>Pe,init:()=>Zo,instrumentAnthropicAiClient:()=>fm,instrumentGoogleGenAIClient:()=>xm,instrumentOpenAiClient:()=>Bm,instrumentOutgoingRequests:()=>Ya,instrumentSupabaseClient:()=>Xm,isEnabled:()=>tr,isInitialized:()=>er,lastEventId:()=>Ys,launchDarklyIntegration:()=>Tp,lazyLoadIntegration:()=>hf,linkedErrorsIntegration:()=>So,logger:()=>t,makeBrowserOfflineTransport:()=>Oy,makeFetchTransport:()=>Yo,makeMultiplexedTransport:()=>cg,metrics:()=>n,moduleMetadataIntegration:()=>yg,onLoad:()=>ti,openFeatureIntegration:()=>Ny,opera10StackLineParser:()=>Do,opera11StackLineParser:()=>Po,parameterize:()=>Qm,registerSpanErrorInstrumentation:()=>Ei,registerWebWorker:()=>zy,replayCanvasIntegration:()=>wy,replayIntegration:()=>mp,reportPageLoaded:()=>ky,reportingObserverIntegration:()=>Ag,rewriteFramesIntegration:()=>Sg,sendFeedback:()=>Ap,setActiveSpanInBrowser:()=>xy,setContext:()=>Ws,setCurrentClient:()=>tt,setExtra:()=>Js,setExtras:()=>Vs,setHttpStatus:()=>Pt,setMeasurement:()=>si,setTag:()=>Gs,setTags:()=>Ks,setUser:()=>Xs,showReportDialog:()=>Mg,spanToBaggageHeader:()=>yn,spanToJSON:()=>en,spanToTraceHeader:()=>Xt,spotlightBrowserIntegration:()=>Ay,startBrowserTracingNavigationSpan:()=>sc,startBrowserTracingPageLoadSpan:()=>nc,startInactiveSpan:()=>pi,startNewTrace:()=>gi,startSession:()=>sr,startSpan:()=>li,startSpanManual:()=>di,statsigIntegration:()=>jy,supabaseIntegration:()=>Ym,suppressTracing:()=>mi,thirdPartyErrorFilterIntegration:()=>wg,unleashIntegration:()=>Ly,updateSpanName:()=>dn,webWorkerIntegration:()=>Uy,winjsStackLineParser:()=>Ao,withActiveSpan:()=>fi,withIsolationScope:()=>Te,withScope:()=>xe,zodErrorsIntegration:()=>Ig});const r="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,o="10.20.0",i=globalThis;function a(){return c(i),i}function c(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||o,t[o]=t[o]||{}}function u(e,t,n=i){const s=n.__SENTRY__=n.__SENTRY__||{},r=s[o]=s[o]||{};return r[e]||(r[e]=t())}const l=Object.prototype.toString;function d(e){switch(l.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return S(e,Error)}}function p(e,t){return l.call(e)===`[object ${t}]`}function h(e){return p(e,"ErrorEvent")}function f(e){return p(e,"DOMError")}function m(e){return p(e,"String")}function g(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function y(e){return null===e||g(e)||"object"!=typeof e&&"function"!=typeof e}function b(e){return p(e,"Object")}function v(e){return"undefined"!=typeof Event&&S(e,Event)}function _(e){return Boolean(e?.then&&"function"==typeof e.then)}function S(e,t){try{return e instanceof t}catch{return!1}}function w(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}function k(e){return"undefined"!=typeof Request&&S(e,Request)}const x=i,T=80;function E(e,t={}){if(!e)return"<unknown>";try{let n=e;const s=5,r=[];let o=0,i=0;const a=" > ",c=a.length;let u;const l=Array.isArray(t)?t:t.keyAttrs,d=!Array.isArray(t)&&t.maxStringLength||T;for(;n&&o++<s&&(u=I(n,l),!("html"===u||o>1&&i+r.length*c+u.length>=d));)r.push(u),i+=u.length,n=n.parentNode;return r.reverse().join(a)}catch{return"<unknown>"}}function I(e,t){const n=e,s=[];if(!n?.tagName)return"";if(x.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}s.push(n.tagName.toLowerCase());const r=t?.length?t.filter(e=>n.getAttribute(e)).map(e=>[e,n.getAttribute(e)]):null;if(r?.length)r.forEach(e=>{s.push(`[${e[0]}="${e[1]}"]`)});else{n.id&&s.push(`#${n.id}`);const e=n.className;if(e&&m(e)){const t=e.split(/\s+/);for(const e of t)s.push(`.${e}`)}}const o=["aria-label","type","name","title","alt"];for(const e of o){const t=n.getAttribute(e);t&&s.push(`[${e}="${t}"]`)}return s.join("")}function C(){try{return x.document.location.href}catch{return""}}function M(e){if(!x.HTMLElement)return null;let t=e;for(let e=0;e<5;e++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}const R=["debug","info","warn","error","log","assert","trace"],O={};function A(e){if(!("console"in i))return e();const t=i.console,n={},s=Object.keys(O);s.forEach(e=>{const s=O[e];n[e]=t[e],t[e]=s});try{return e()}finally{s.forEach(e=>{t[e]=n[e]})}}function N(){return L().enabled}function D(e,...t){r&&N()&&A(()=>{i.console[e](`Sentry Logger [${e}]:`,...t)})}function L(){return r?u("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const P={enable:function(){L().enabled=!0},disable:function(){L().enabled=!1},isEnabled:N,log:function(...e){D("log",...e)},warn:function(...e){D("warn",...e)},error:function(...e){D("error",...e)}};function F(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function $(e,t){let n=e;const s=n.length;if(s<=150)return n;t>s&&(t=s);let r=Math.max(t-60,0);r<5&&(r=0);let o=Math.min(r+140,s);return o>s-5&&(o=s),o===s&&(r=Math.max(o-140,0)),n=n.slice(r,o),r>0&&(n=`'{snip} ${n}`),o<s&&(n+=" {snip}"),n}function j(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const s=e[t];try{w(s)?n.push("[VueViewModel]"):n.push(String(s))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function B(e,t,n=!1){return!!m(e)&&(p(t,"RegExp")?t.test(e):!!m(t)&&(n?e===t:e.includes(t)))}function U(e,t=[],n=!1){return t.some(t=>B(e,t,n))}function H(e,t,n){if(!(t in e))return;const s=e[t];if("function"!=typeof s)return;const o=n(s);"function"==typeof o&&q(o,s);try{e[t]=o}catch{r&&P.log(`Failed to replace method "${t}" in object`,e)}}function z(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{r&&P.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function q(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,z(e,"__sentry_original__",t)}catch{}}function W(e){return e.__sentry_original__}function V(e){if(d(e))return{message:e.message,name:e.name,stack:e.stack,...K(e)};if(v(e)){const t={type:e.type,target:J(e.target),currentTarget:J(e.currentTarget),...K(e)};return"undefined"!=typeof CustomEvent&&S(e,CustomEvent)&&(t.detail=e.detail),t}return e}function J(e){try{return"undefined"!=typeof Element&&S(e,Element)?E(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function K(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function G(e=function(){const e=i;return e.crypto||e.msCrypto}()){let t=()=>16*Math.random();try{if(e?.randomUUID)return e.randomUUID().replace(/-/g,"");e?.getRandomValues&&(t=()=>{const t=new Uint8Array(1);return e.getRandomValues(t),t[0]})}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,e=>(e^(15&t())>>e/4).toString(16))}function X(e){return e.exception?.values?.[0]}function Y(e){const{message:t,event_id:n}=e;if(t)return t;const s=X(e);return s?s.type&&s.value?`${s.type}: ${s.value}`:s.type||s.value||n||"<unknown>":n||"<unknown>"}function Q(e,t,n){const s=e.exception=e.exception||{},r=s.values=s.values||[],o=r[0]=r[0]||{};o.value||(o.value=t||""),o.type||(o.type=n||"Error")}function Z(e,t){const n=X(e);if(!n)return;const s=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...s,...t},t&&"data"in t){const e={...s?.data,...t.data};n.mechanism.data=e}}function ee(e){if(function(e){try{return e.__sentry_captured__}catch{}}(e))return!0;try{z(e,"__sentry_captured__",!0)}catch{}return!1}const te=1e3;function ne(){return Date.now()/te}let se,re;function oe(){const e=se??(se=function(){const{performance:e}=i;if(!e?.now||!e.timeOrigin)return ne;const t=e.timeOrigin;return()=>(t+e.now())/te}());return e()}function ie(){return re||(re=function(){const{performance:e}=i;if(!e?.now)return[void 0,"none"];const t=36e5,n=e.now(),s=Date.now(),r=e.timeOrigin?Math.abs(e.timeOrigin+n-s):t,o=r<t,a=e.timing?.navigationStart,c="number"==typeof a?Math.abs(a+n-s):t;return o||c<t?r<=c?[e.timeOrigin,"timeOrigin"]:[a,"navigationStart"]:[s,"dateNow"]}()),re[0]}function ae(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||oe(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:G()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function ce(e,t,n=2){if(!t||"object"!=typeof t||n<=0)return t;if(e&&0===Object.keys(t).length)return e;const s={...e};for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(s[e]=ce(s[e],t[e],n-1));return s}function ue(){return G()}function le(){return G().substring(16)}const de="_sentrySpan";function pe(e,t){t?z(e,de,t):delete e[de]}function he(e){return e[de]}class fe{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:ue(),sampleRand:Math.random()}}clone(){const e=new fe;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,pe(e,he(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&ae(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e,n=t instanceof fe?t.getScopeData():b(t)?e:void 0,{tags:s,extra:r,user:o,contexts:i,level:a,fingerprint:c=[],propagationContext:u}=n||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...r},this._contexts={...this._contexts,...i},o&&Object.keys(o).length&&(this._user=o),a&&(this._level=a),c.length&&(this._fingerprint=c),u&&(this._propagationContext=u),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,pe(this,void 0),this._attachments=[],this.setPropagationContext({traceId:ue(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const s={timestamp:ne(),...e,message:e.message?F(e.message,2048):e.message};return this._breadcrumbs.push(s),this._breadcrumbs.length>n&&(this._breadcrumbs=this._breadcrumbs.slice(-n),this._client?.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:he(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=ce(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t?.event_id||G();if(!this._client)return r&&P.warn("No client configured on scope - will not capture exception!"),n;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...t,event_id:n},this),n}captureMessage(e,t,n){const s=n?.event_id||G();if(!this._client)return r&&P.warn("No client configured on scope - will not capture message!"),s;const o=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:o,...n,event_id:s},this),s}captureEvent(e,t){const n=t?.event_id||G();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(r&&P.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}class me{constructor(e,t){let n,s;n=e||new fe,s=t||new fe,this._stack=[{scope:n}],this._isolationScope=s}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(e){throw this._popScope(),e}return _(n)?n.then(e=>(this._popScope(),e),e=>{throw this._popScope(),e}):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1||!this._stack.pop())}}function ge(){const e=c(a());return e.stack=e.stack||new me(u("defaultCurrentScope",()=>new fe),u("defaultIsolationScope",()=>new fe))}function ye(e){return ge().withScope(e)}function be(e,t){const n=ge();return n.withScope(()=>(n.getStackTop().scope=e,t(e)))}function ve(e){return ge().withScope(()=>e(ge().getIsolationScope()))}function _e(e){const t=c(e);return t.acs?t.acs:{withIsolationScope:ve,withScope:ye,withSetScope:be,withSetIsolationScope:(e,t)=>ve(t),getCurrentScope:()=>ge().getScope(),getIsolationScope:()=>ge().getIsolationScope()}}function Se(){return _e(a()).getCurrentScope()}function we(){return _e(a()).getIsolationScope()}function ke(){return u("globalScope",()=>new fe)}function xe(...e){const t=_e(a());if(2===e.length){const[n,s]=e;return n?t.withSetScope(n,s):t.withScope(s)}return t.withScope(e[0])}function Te(...e){const t=_e(a());if(2===e.length){const[n,s]=e;return n?t.withSetIsolationScope(n,s):t.withIsolationScope(s)}return t.withIsolationScope(e[0])}function Ee(){return Se().getClient()}function Ie(e){const t=e.getPropagationContext(),{traceId:n,parentSpanId:s,propagationSpanId:r}=t,o={trace_id:n,span_id:r||le()};return s&&(o.parent_span_id=s),o}const Ce=[];function Me(e){const t=e.defaultIntegrations||[],n=e.integrations;let s;if(t.forEach(e=>{e.isDefaultInstance=!0}),Array.isArray(n))s=[...t,...n];else if("function"==typeof n){const e=n(t);s=Array.isArray(e)?e:[e]}else s=t;return function(e){const t={};return e.forEach(e=>{const{name:n}=e,s=t[n];s&&!s.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)}),Object.values(t)}(s)}function Re(e,t){for(const n of t)n?.afterAllSetup&&n.afterAllSetup(e)}function Oe(e,t,n){if(n[t.name])r&&P.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===Ce.indexOf(t.name)&&"function"==typeof t.setupOnce&&(t.setupOnce(),Ce.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",(t,s)=>n(t,s,e))}if("function"==typeof t.processEvent){const n=t.processEvent.bind(t),s=Object.assign((t,s)=>n(t,s,e),{id:t.name});e.addEventProcessor(s)}r&&P.log(`Integration installed: ${t.name}`)}}function Ae(e){const t=Ee();t?t.addIntegration(e):r&&P.warn(`Cannot add integration "${e.name}" because no SDK Client is available.`)}function Ne(e){const t=[];e.message&&t.push(e.message);try{const n=e.exception.values[e.exception.values.length-1];n?.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`))}catch{}return t}const De=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],Le=(e={})=>{let t;return{name:"EventFilters",setup(n){const s=n.getOptions();t=Fe(e,s)},processEvent(n,s,o){if(!t){const n=o.getOptions();t=Fe(e,n)}return function(e,t){if(e.type){if("transaction"===e.type&&function(e,t){if(!t?.length)return!1;const n=e.transaction;return!!n&&U(n,t)}(e,t.ignoreTransactions))return r&&P.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${Y(e)}`),!0}else{if(function(e,t){return!!t?.length&&Ne(e).some(e=>U(e,t))}(e,t.ignoreErrors))return r&&P.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${Y(e)}`),!0;if(function(e){return!!e.exception?.values?.length&&(!e.message&&!e.exception.values.some(e=>e.stacktrace||e.type&&"Error"!==e.type||e.value))}(e))return r&&P.warn(`Event dropped due to not having an error message, error type or stacktrace.\nEvent: ${Y(e)}`),!0;if(function(e,t){if(!t?.length)return!1;const n=$e(e);return!!n&&U(n,t)}(e,t.denyUrls))return r&&P.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${Y(e)}.\nUrl: ${$e(e)}`),!0;if(!function(e,t){if(!t?.length)return!0;const n=$e(e);return!n||U(n,t)}(e,t.allowUrls))return r&&P.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${Y(e)}.\nUrl: ${$e(e)}`),!0}return!1}(n,t)?null:n}}},Pe=(e={})=>({...Le(e),name:"InboundFilters"});function Fe(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:De],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]]}}function $e(e){try{const t=[...e.exception?.values??[]].reverse().find(e=>void 0===e.mechanism?.parent_id&&e.stacktrace?.frames?.length),n=t?.stacktrace?.frames;return n?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(n):null}catch{return r&&P.error(`Cannot extract url for event ${Y(e)}`),null}}let je;const Be=new WeakMap,Ue=()=>({name:"FunctionToString",setupOnce(){je=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=W(this),n=Be.has(Ee())&&void 0!==t?t:this;return je.apply(n,e)}}catch{}},setup(e){Be.set(e,!0)}}),He=50,ze="?",qe=/\(error: (.*)\)/,We=/captureMessage|captureException/;function Ve(...e){const t=e.sort((e,t)=>e[0]-t[0]).map(e=>e[1]);return(e,n=0,s=0)=>{const r=[],o=e.split("\n");for(let e=n;e<o.length;e++){let n=o[e];n.length>1024&&(n=n.slice(0,1024));const i=qe.test(n)?n.replace(qe,"$1"):n;if(!i.match(/\S*Error: /)){for(const e of t){const t=e(i);if(t){r.push(t);break}}if(r.length>=He+s)break}}return function(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(Je(t).function||"")&&t.pop(),t.reverse(),We.test(Je(t).function||"")&&(t.pop(),We.test(Je(t).function||"")&&t.pop()),t.slice(0,He).map(e=>({...e,filename:e.filename||Je(t).filename,function:e.function||ze}))}(r.slice(s))}}function Je(e){return e[e.length-1]||{}}const Ke="<anonymous>";function Ge(e){try{return e&&"function"==typeof e&&e.name||Ke}catch{return Ke}}function Xe(e){const t=e.exception;if(t){const e=[];try{return t.values.forEach(t=>{t.stacktrace.frames&&e.push(...t.stacktrace.frames)}),e}catch{return}}}const Ye=()=>{let e;return{name:"Dedupe",processEvent(t){if(t.type)return t;try{if(function(e,t){return!!t&&(!!function(e,t){const n=e.message,s=t.message;return!(!n&&!s)&&(!(n&&!s||!n&&s)&&(n===s&&(!!Ze(e,t)&&!!Qe(e,t))))}(e,t)||!!function(e,t){const n=et(t),s=et(e);return!(!n||!s)&&(n.type===s.type&&n.value===s.value&&(!!Ze(e,t)&&!!Qe(e,t)))}(e,t))}(t,e))return r&&P.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}};function Qe(e,t){let n=Xe(e),s=Xe(t);if(!n&&!s)return!0;if(n&&!s||!n&&s)return!1;if(s.length!==n.length)return!1;for(let e=0;e<s.length;e++){const t=s[e],r=n[e];if(t.filename!==r.filename||t.lineno!==r.lineno||t.colno!==r.colno||t.function!==r.function)return!1}return!0}function Ze(e,t){let n=e.fingerprint,s=t.fingerprint;if(!n&&!s)return!0;if(n&&!s||!n&&s)return!1;try{return!(n.join("")!==s.join(""))}catch{return!1}}function et(e){return e.exception?.values?.[0]}function tt(e){Se().setClient(e)}const nt=/^o(\d+)\./,st=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function rt(e,t=!1){const{host:n,path:s,pass:r,port:o,projectId:i,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&r?`:${r}`:""}@${n}${o?`:${o}`:""}/${s?`${s}/`:s}${i}`}function ot(e){const t=st.exec(e);if(!t)return void A(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});const[n,s,r="",o="",i="",a=""]=t.slice(1);let c="",u=a;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const e=u.match(/^\d+/);e&&(u=e[0])}return it({host:o,pass:r,path:c,projectId:u,port:i,protocol:n,publicKey:s})}function it(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function at(e){const t=e.getOptions(),{host:n}=e.getDsn()||{};let s;return t.orgId?s=String(t.orgId):n&&(s=function(e){const t=e.match(nt);return t?.[1]}(n)),s}function ct(e){const t="string"==typeof e?ot(e):it(e);if(t&&function(e){if(!r)return!0;const{port:t,projectId:n,protocol:s}=e;return!(["protocol","publicKey","host","projectId"].find(t=>!e[t]&&(P.error(`Invalid Sentry Dsn: ${t} missing`),!0))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(s)?t&&isNaN(parseInt(t,10))&&(P.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(P.error(`Invalid Sentry Dsn: Invalid protocol ${s}`),1):(P.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}const ut="7";function lt(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function dt(e,t,n){return t||`${function(e){return`${lt(e)}${e.projectId}/envelope/`}(e)}?${function(e,t){const n={sentry_version:ut};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}(e,n)}`}const pt="production",ht="sentry.source",ft="sentry.sample_rate",mt="sentry.previous_trace_sample_rate",gt="sentry.op",yt="sentry.origin",bt="sentry.idle_span_finish_reason",vt="sentry.measurement_unit",_t="sentry.measurement_value",St="sentry.custom_span_name",wt="sentry.profile_id",kt="sentry.exclusive_time",xt="sentry.link.type",Tt="sentry-",Et=/^sentry-/,It=8192;function Ct(e){const t=function(e){if(e&&(m(e)||Array.isArray(e)))return Array.isArray(e)?e.reduce((e,t)=>{const n=Rt(t);return Object.entries(n).forEach(([t,n])=>{e[t]=n}),e},{}):Rt(e)}(e);if(!t)return;const n=Object.entries(t).reduce((e,[t,n])=>(t.match(Et)&&(e[t.slice(Tt.length)]=n),e),{});return Object.keys(n).length>0?n:void 0}function Mt(e){if(e)return function(e){if(0!==Object.keys(e).length)return Object.entries(e).reduce((e,[t,n],s)=>{const o=`${encodeURIComponent(t)}=${encodeURIComponent(n)}`,i=0===s?o:`${e},${o}`;return i.length>It?(r&&P.warn(`Not adding key: ${t} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):i},"")}(Object.entries(e).reduce((e,[t,n])=>(n&&(e[`${Tt}${t}`]=n),e),{}))}function Rt(e){return e.split(",").map(e=>{const t=e.indexOf("=");return-1===t?[]:[e.slice(0,t),e.slice(t+1)].map(e=>{try{return decodeURIComponent(e.trim())}catch{return}})}).reduce((e,[t,n])=>(t&&n&&(e[t]=n),e),{})}function Ot(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=e||Ee()?.getOptions();return!(!t||null==t.tracesSampleRate&&!t.tracesSampler)}const At=0,Nt=1,Dt=2;function Lt(e){if(e<400&&e>=100)return{code:Nt};if(e>=400&&e<500)switch(e){case 401:return{code:Dt,message:"unauthenticated"};case 403:return{code:Dt,message:"permission_denied"};case 404:return{code:Dt,message:"not_found"};case 409:return{code:Dt,message:"already_exists"};case 413:return{code:Dt,message:"failed_precondition"};case 429:return{code:Dt,message:"resource_exhausted"};case 499:return{code:Dt,message:"cancelled"};default:return{code:Dt,message:"invalid_argument"}}if(e>=500&&e<600)switch(e){case 501:return{code:Dt,message:"unimplemented"};case 503:return{code:Dt,message:"unavailable"};case 504:return{code:Dt,message:"deadline_exceeded"};default:return{code:Dt,message:"internal_error"}}return{code:Dt,message:"unknown_error"}}function Pt(e,t){e.setAttribute("http.response.status_code",t);const n=Lt(t);"unknown_error"!==n.message&&e.setStatus(n)}const Ft="_sentryScope",$t="_sentryIsolationScope";function jt(e){if(e){if("object"==typeof e&&"deref"in e&&"function"==typeof e.deref)try{return e.deref()}catch{return}return e}}function Bt(e){const t=e;return{scope:t[Ft],isolationScope:jt(t[$t])}}function Ut(e){if("boolean"==typeof e)return Number(e);const t="string"==typeof e?parseFloat(e):e;return"number"!=typeof t||isNaN(t)||t<0||t>1?void 0:t}const Ht=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function zt(e,t){const n=function(e){if(!e)return;const t=e.match(Ht);if(!t)return;let n;return"1"===t[3]?n=!0:"0"===t[3]&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}(e),s=Ct(t);if(!n?.traceId)return{traceId:ue(),sampleRand:Math.random()};const r=function(e,t){const n=Ut(t?.sample_rand);if(void 0!==n)return n;const s=Ut(t?.sample_rate);return s&&void 0!==e?.parentSampled?e.parentSampled?Math.random()*s:s+Math.random()*(1-s):Math.random()}(n,s);s&&(s.sample_rand=r.toString());const{traceId:o,parentSpanId:i,parentSampled:a}=n;return{traceId:o,parentSpanId:i,sampled:a,dsc:s||{},sampleRand:r}}function qt(e=ue(),t=le(),n){let s="";return void 0!==n&&(s=n?"-1":"-0"),`${e}-${t}${s}`}function Wt(e=ue(),t=le(),n){return`00-${e}-${t}-${n?"01":"00"}`}const Vt=1;let Jt=!1;function Kt(e){const{spanId:t,traceId:n}=e.spanContext(),{data:s,op:r,parent_span_id:o,status:i,origin:a,links:c}=en(e);return{parent_span_id:o,span_id:t,trace_id:n,data:s,op:r,status:i,origin:a,links:c}}function Gt(e){const{spanId:t,traceId:n,isRemote:s}=e.spanContext(),r=s?t:en(e).parent_span_id,o=Bt(e).scope;return{parent_span_id:r,span_id:s?o?.getPropagationContext().propagationSpanId||le():t,trace_id:n}}function Xt(e){const{traceId:t,spanId:n}=e.spanContext();return qt(t,n,tn(e))}function Yt(e){return e&&e.length>0?e.map(({context:{spanId:e,traceId:t,traceFlags:n,...s},attributes:r})=>({span_id:e,trace_id:t,sampled:n===Vt,attributes:r,...s})):void 0}function Qt(e){return"number"==typeof e?Zt(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?Zt(e.getTime()):oe()}function Zt(e){return e>9999999999?e/1e3:e}function en(e){if(function(e){return"function"==typeof e.getSpanJSON}(e))return e.getSpanJSON();const{spanId:t,traceId:n}=e.spanContext();if(function(e){const t=e;return!!(t.attributes&&t.startTime&&t.name&&t.endTime&&t.status)}(e)){const{attributes:s,startTime:r,name:o,endTime:i,status:a,links:c}=e;return{span_id:t,trace_id:n,data:s,description:o,parent_span_id:"parentSpanId"in e?e.parentSpanId:"parentSpanContext"in e?e.parentSpanContext?.spanId:void 0,start_timestamp:Qt(r),timestamp:Qt(i)||void 0,status:nn(a),op:s[gt],origin:s[yt],links:Yt(c)}}return{span_id:t,trace_id:n,start_timestamp:0,data:{}}}function tn(e){const{traceFlags:t}=e.spanContext();return t===Vt}function nn(e){if(e&&e.code!==At)return e.code===Nt?"ok":e.message||"unknown_error"}const sn="_sentryChildSpans",rn="_sentryRootSpan";function on(e,t){const n=e[rn]||e;z(t,rn,n),e[sn]?e[sn].add(t):z(e,sn,new Set([t]))}function an(e){const t=new Set;return function e(n){if(!t.has(n)&&tn(n)){t.add(n);const s=n[sn]?Array.from(n[sn]):[];for(const t of s)e(t)}}(e),Array.from(t)}function cn(e){return e[rn]||e}function un(){const e=_e(a());return e.getActiveSpan?e.getActiveSpan():he(Se())}function ln(){Jt||(A(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly or use `ignoreSpans`.")}),Jt=!0)}function dn(e,t){e.updateName(t),e.setAttributes({[ht]:"custom",[St]:t})}const pn="_frozenDsc";function hn(e,t){z(e,pn,t)}function fn(e,t){const n=t.getOptions(),{publicKey:s}=t.getDsn()||{},r={environment:n.environment||pt,release:n.release,public_key:s,trace_id:e,org_id:at(t)};return t.emit("createDsc",r),r}function mn(e,t){const n=t.getPropagationContext();return n.dsc||fn(n.traceId,e)}function gn(e){const t=Ee();if(!t)return{};const n=cn(e),s=en(n),r=s.data,o=n.spanContext().traceState,i=o?.get("sentry.sample_rate")??r[ft]??r[mt];function a(e){return"number"!=typeof i&&"string"!=typeof i||(e.sample_rate=`${i}`),e}const c=n[pn];if(c)return a(c);const u=o?.get("sentry.dsc"),l=u&&Ct(u);if(l)return a(l);const d=fn(e.spanContext().traceId,t),p=r[ht],h=s.description;return"url"!==p&&h&&(d.transaction=h),Ot()&&(d.sampled=String(tn(n)),d.sample_rand=o?.get("sentry.sample_rand")??Bt(n).scope?.getPropagationContext().sampleRand.toString()),a(d),t.emit("createDsc",d,n),d}function yn(e){return Mt(gn(e))}function bn(e,t=100,n=1/0){try{return _n("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function vn(e,t=3,n=102400){const s=bn(e,t);return r=s,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(r))>n?vn(e,t-1,n):s;var r}function _n(e,t,n=1/0,s=1/0,r=function(){const e=new WeakSet;return[function(t){return!!e.has(t)||(e.add(t),!1)},function(t){e.delete(t)}]}()){const[o,i]=r;if(null==t||["boolean","string"].includes(typeof t)||"number"==typeof t&&Number.isFinite(t))return t;const a=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(w(t))return"[VueViewModel]";if(b(n=t)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof t&&!Number.isFinite(t))return`[${t}]`;if("function"==typeof t)return`[Function: ${Ge(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const s=function(e){const t=Object.getPrototypeOf(e);return t?.constructor?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(s)?`[HTMLElement: ${s}]`:`[object ${s}]`}catch(e){return`**non-serializable** (${e})`}var n}(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return a.replace("object ","");if(o(t))return"[Circular ~]";const u=t;if(u&&"function"==typeof u.toJSON)try{return _n("",u.toJSON(),c-1,s,r)}catch{}const l=Array.isArray(t)?[]:{};let d=0;const p=V(t);for(const e in p){if(!Object.prototype.hasOwnProperty.call(p,e))continue;if(d>=s){l[e]="[MaxProperties ~]";break}const t=p[e];l[e]=_n(e,t,c-1,s,r),d++}return i(t),l}function Sn(e,t=[]){return[e,t]}function wn(e,t){const[n,s]=e;return[n,[...s,t]]}function kn(e,t){const n=e[1];for(const e of n)if(t(e,e[0].type))return!0;return!1}function xn(e,t){return kn(e,(e,n)=>t.includes(n))}function Tn(e){const t=c(i);return t.encodePolyfill?t.encodePolyfill(e):(new TextEncoder).encode(e)}function En(e){const[t,n]=e;let s=JSON.stringify(t);function r(e){"string"==typeof s?s="string"==typeof e?s+e:[Tn(s),e]:s.push("string"==typeof e?Tn(e):e)}for(const e of n){const[t,n]=e;if(r(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)r(n);else{let e;try{e=JSON.stringify(n)}catch{e=JSON.stringify(bn(n))}r(e)}}return"string"==typeof s?s:function(e){const t=e.reduce((e,t)=>e+t.length,0),n=new Uint8Array(t);let s=0;for(const t of e)n.set(t,s),s+=t.length;return n}(s)}function In(e){return[{type:"span"},e]}function Cn(e){const t="string"==typeof e.data?Tn(e.data):e.data;return[{type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType},t]}const Mn={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item",metric:"metric",trace_metric:"metric"};function Rn(e){return Mn[e]}function On(e){if(!e?.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function An(e,t,n,s){const r=e.sdkProcessingMetadata?.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&s&&{dsn:rt(s)},...r&&{trace:r}}}function Nn(e){P.log(`Ignoring span ${e.op} - ${e.description} because it matches \`ignoreSpans\`.`)}function Dn(e,t){if(!t?.length||!e.description)return!1;for(const n of t){if(Pn(n)){if(B(e.description,n))return r&&Nn(e),!0;continue}if(!n.name&&!n.op)continue;const t=!n.name||B(e.description,n.name),s=!n.op||e.op&&B(e.op,n.op);if(t&&s)return r&&Nn(e),!0}return!1}function Ln(e,t){const n=t.parent_span_id,s=t.span_id;if(n)for(const t of e)t.parent_span_id===s&&(t.parent_span_id=n)}function Pn(e){return"string"==typeof e||e instanceof RegExp}function Fn(e,t){const{extra:n,tags:s,user:r,contexts:o,level:i,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:d,propagationContext:p,transactionName:h,span:f}=t;$n(e,"extra",n),$n(e,"tags",s),$n(e,"user",r),$n(e,"contexts",o),e.sdkProcessingMetadata=ce(e.sdkProcessingMetadata,a,2),i&&(e.level=i),h&&(e.transactionName=h),f&&(e.span=f),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),u.length&&(e.fingerprint=[...e.fingerprint,...u]),l.length&&(e.eventProcessors=[...e.eventProcessors,...l]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext={...e.propagationContext,...p}}function $n(e,t,n){e[t]=ce(e[t],n,1)}function jn(e,t){return t?xe(t,()=>{const n=un(),s=n?Gt(n):Ie(t);return[n?gn(n):mn(e,t),s]}):[void 0,void 0]}const Bn={trace:1,debug:5,info:9,warn:13,error:17,fatal:21},Un=100;function Hn(e,t,n,s=!0){!n||e[t]&&!s||(e[t]=n)}function zn(e,t){const n=Jn(),s=Vn(e);void 0===s?n.set(e,[t]):(n.set(e,[...s,t]),s.length>=Un&&Wn(e,s))}function qn(e,t=Se(),n=zn){const s=t?.getClient()??Ee();if(!s)return void(r&&P.warn("No client available to capture log."));const{release:o,environment:i,enableLogs:a=!1,beforeSendLog:c}=s.getOptions();if(!a)return void(r&&P.warn("logging option not enabled, log will not be captured."));const[,u]=jn(s,t),l={...e.attributes},{user:{id:d,email:p,username:h}}=function(e){const t=ke().getScopeData();return Fn(t,we().getScopeData()),Fn(t,e.getScopeData()),t}(t);Hn(l,"user.id",d,!1),Hn(l,"user.email",p,!1),Hn(l,"user.name",h,!1),Hn(l,"sentry.release",o),Hn(l,"sentry.environment",i);const{name:f,version:m}=s.getSdkMetadata()?.sdk??{};Hn(l,"sentry.sdk.name",f),Hn(l,"sentry.sdk.version",m);const y=s.getIntegrationByName("Replay"),b=y?.getReplayId(!0);Hn(l,"sentry.replay_id",b),b&&"buffer"===y?.getRecordingMode()&&Hn(l,"sentry._internal.replay_is_buffering",!0);const v=e.message;if(g(v)){const{__sentry_template_string__:e,__sentry_template_values__:t=[]}=v;t?.length&&(l["sentry.message.template"]=e),t.forEach((e,t)=>{l[`sentry.message.parameter.${t}`]=e})}const _=he(t);Hn(l,"sentry.trace.parent_span_id",_?.spanContext().spanId);const S={...e,attributes:l};s.emit("beforeCaptureLog",S);const w=c?A(()=>c(S)):S;if(!w)return s.recordDroppedEvent("before_send","log_item",1),void(r&&P.warn("beforeSendLog returned null, log will not be captured."));const{level:k,message:x,attributes:T={},severityNumber:E}=w;n(s,{timestamp:oe(),level:k,body:x,trace_id:u?.trace_id,severity_number:E??Bn[k],attributes:Object.keys(T).reduce((e,t)=>(e[t]=function(e){switch(typeof e){case"number":return Number.isInteger(e)?{value:e,type:"integer"}:{value:e,type:"double"};case"boolean":return{value:e,type:"boolean"};case"string":return{value:e,type:"string"};default:{let t="";try{t=JSON.stringify(e)??""}catch{}return{value:t,type:"string"}}}}(T[t]),e),{})}),s.emit("afterCaptureLog",w)}function Wn(e,t){const n=t??Vn(e)??[];if(0===n.length)return;const s=e.getOptions(),r=function(e,t,n,s){const r={};return t?.sdk&&(r.sdk={name:t.sdk.name,version:t.sdk.version}),n&&s&&(r.dsn=rt(s)),Sn(r,[(o=e,[{type:"log",item_count:o.length,content_type:"application/vnd.sentry.items.log+json"},{items:o}])]);var o}(n,s._metadata,s.tunnel,e.getDsn());Jn().set(e,[]),e.emit("flushLogs"),e.sendEnvelope(r)}function Vn(e){return Jn().get(e)}function Jn(){return u("clientToLogBufferMap",()=>new WeakMap)}const Kn=100;function Gn(e){switch(typeof e){case"number":return Number.isInteger(e)?{value:e,type:"integer"}:{value:e,type:"double"};case"boolean":return{value:e,type:"boolean"};case"string":return{value:e,type:"string"};default:{let t="";try{t=JSON.stringify(e)??""}catch{}return{value:t,type:"string"}}}}function Xn(e,t,n,s=!0){!n||!s&&t in e||(e[t]=n)}function Yn(e,t){const n=es(),s=Zn(e);void 0===s?n.set(e,[t]):(n.set(e,[...s,t]),s.length>=Kn&&Qn(e,s))}function Qn(e,t){const n=t??Zn(e)??[];if(0===n.length)return;const s=e.getOptions(),r=function(e,t,n,s){const r={};return t?.sdk&&(r.sdk={name:t.sdk.name,version:t.sdk.version}),n&&s&&(r.dsn=rt(s)),Sn(r,[(o=e,[{type:"trace_metric",item_count:o.length,content_type:"application/vnd.sentry.items.trace-metric+json"},{items:o}])]);var o}(n,s._metadata,s.tunnel,e.getDsn());es().set(e,[]),e.emit("flushMetrics"),e.sendEnvelope(r)}function Zn(e){return es().get(e)}function es(){return u("clientToMetricBufferMap",()=>new WeakMap)}function ts(e){return new ss(t=>{t(e)})}function ns(e){return new ss((t,n)=>{n(e)})}class ss{constructor(e){this._state=0,this._handlers=[],this._runExecutor(e)}then(e,t){return new ss((n,s)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){s(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){s(e)}else s(e)}]),this._executeHandlers()})}catch(e){return this.then(e=>e,e)}finally(e){return new ss((t,n)=>{let s,r;return this.then(t=>{r=!1,s=t,e&&e()},t=>{r=!0,s=t,e&&e()}).then(()=>{r?n(s):t(s)})})}_executeHandlers(){if(0===this._state)return;const e=this._handlers.slice();this._handlers=[],e.forEach(e=>{e[0]||(1===this._state&&e[1](this._value),2===this._state&&e[2](this._value),e[0]=!0)})}_runExecutor(e){const t=(e,t)=>{0===this._state&&(_(t)?t.then(n,s):(this._state=e,this._value=t,this._executeHandlers()))},n=e=>{t(1,e)},s=e=>{t(2,e)};try{e(n,s)}catch(e){s(e)}}}function rs(e,t,n,s=0){try{const r=os(t,n,e,s);return _(r)?r:ts(r)}catch(e){return ns(e)}}function os(e,t,n,s){const o=n[s];if(!e||!o)return e;const i=o({...e},t);return r&&null===i&&P.log(`Event processor "${o.id||"?"}" dropped event`),_(i)?i.then(e=>os(e,t,n,s+1)):os(i,t,n,s+1)}let is,as,cs,us;function ls(e){const t=i._sentryDebugIds,n=i._debugIds;if(!t&&!n)return{};const s=t?Object.keys(t):[],r=n?Object.keys(n):[];if(us&&s.length===as&&r.length===cs)return us;as=s.length,cs=r.length,us={},is||(is={});const o=(t,n)=>{for(const s of t){const t=n[s],r=is?.[s];if(r&&us&&t)us[r[0]]=t,is&&(is[s]=[r[0],t]);else if(t){const n=e(s);for(let e=n.length-1;e>=0;e--){const r=n[e],o=r?.filename;if(o&&us&&is){us[o]=t,is[s]=[o,t];break}}}}};return t&&o(s,t),n&&o(r,n),us}function ds(e,t,n,s,r,o){const{normalizeDepth:i=3,normalizeMaxBreadth:a=1e3}=e,c={...t,event_id:t.event_id||n.event_id||G(),timestamp:t.timestamp||ne()},u=n.integrations||e.integrations.map(e=>e.name);!function(e,t){const{environment:n,release:s,dist:r,maxValueLength:o=250}=t;e.environment=e.environment||n||pt,!e.release&&s&&(e.release=s),!e.dist&&r&&(e.dist=r);const i=e.request;i?.url&&(i.url=F(i.url,o))}(c,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(c,u),r&&r.emit("applyFrameMetadata",t),void 0===t.type&&function(e,t){const n=ls(t);e.exception?.values?.forEach(e=>{e.stacktrace?.frames?.forEach(e=>{e.filename&&(e.debug_id=n[e.filename])})})}(c,e.stackParser);const l=function(e,t){if(!t)return e;const n=e?e.clone():new fe;return n.update(t),n}(s,n.captureContext);n.mechanism&&Z(c,n.mechanism);const d=r?r.getEventProcessors():[],p=ke().getScopeData();o&&Fn(p,o.getScopeData()),l&&Fn(p,l.getScopeData());const h=[...n.attachments||[],...p.attachments];return h.length&&(n.attachments=h),function(e,t){const{fingerprint:n,span:s,breadcrumbs:r,sdkProcessingMetadata:o}=t;!function(e,t){const{extra:n,tags:s,user:r,contexts:o,level:i,transactionName:a}=t;Object.keys(n).length&&(e.extra={...n,...e.extra}),Object.keys(s).length&&(e.tags={...s,...e.tags}),Object.keys(r).length&&(e.user={...r,...e.user}),Object.keys(o).length&&(e.contexts={...o,...e.contexts}),i&&(e.level=i),a&&"transaction"!==e.type&&(e.transaction=a)}(e,t),s&&function(e,t){e.contexts={trace:Gt(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:gn(t),...e.sdkProcessingMetadata};const n=en(cn(t)).description;n&&!e.transaction&&"transaction"===e.type&&(e.transaction=n)}(e,s),function(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint.length||delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,r),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,o)}(c,p),rs([...d,...p.eventProcessors],c,n).then(e=>(e&&function(e){const t={};if(e.exception?.values?.forEach(e=>{e.stacktrace?.frames?.forEach(e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)})}),0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach(([e,t])=>{n.push({type:"sourcemap",code_file:e,debug_id:t})})}(e),"number"==typeof i&&i>0?function(e,t,n){if(!e)return null;const s={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(e=>({...e,...e.data&&{data:bn(e.data,t,n)}}))},...e.user&&{user:bn(e.user,t,n)},...e.contexts&&{contexts:bn(e.contexts,t,n)},...e.extra&&{extra:bn(e.extra,t,n)}};return e.contexts?.trace&&s.contexts&&(s.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(s.contexts.trace.data=bn(e.contexts.trace.data,t,n))),e.spans&&(s.spans=e.spans.map(e=>({...e,...e.data&&{data:bn(e.data,t,n)}}))),e.contexts?.flags&&s.contexts&&(s.contexts.flags=bn(e.contexts.flags,3,n)),s}(e,i,a):e))}const ps=["user","level","extra","contexts","tags","fingerprint","propagationContext"],hs="Not capturing exception because it's already been captured.",fs="Discarded session because of missing or non-string release",ms=Symbol.for("SentryInternalError"),gs=Symbol.for("SentryDoNotSendEventError");function ys(e){return{message:e,[ms]:!0}}function bs(e){return{message:e,[gs]:!0}}function vs(e){return!!e&&"object"==typeof e&&ms in e}function _s(e){return!!e&&"object"==typeof e&&gs in e}function Ss(e,t,n,s,r){let o,i=0;e.on(n,()=>{i=0,clearTimeout(o)}),e.on(t,t=>{i+=s(t),i>=8e5?r(e):(clearTimeout(o),o=setTimeout(()=>{r(e)},5e3))}),e.on("flush",()=>{r(e)})}class ws{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=ct(e.dsn):r&&P.warn("No DSN provided, client will not send events."),this._dsn){const t=dt(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}this._options.enableLogs&&Ss(this,"afterCaptureLog","flushLogs",Es,Wn),this._options._experiments?.enableMetrics&&Ss(this,"afterCaptureMetric","flushMetrics",Ts,Qn)}captureException(e,t,n){const s=G();if(ee(e))return r&&P.log(hs),s;const o={event_id:s,...t};return this._process(this.eventFromException(e,o).then(e=>this._captureEvent(e,o,n))),o.event_id}captureMessage(e,t,n,s){const r={event_id:G(),...n},o=g(e)?e:String(e),i=y(e)?this.eventFromMessage(o,t,r):this.eventFromException(e,r);return this._process(i.then(e=>this._captureEvent(e,r,s))),r.event_id}captureEvent(e,t,n){const s=G();if(t?.originalException&&ee(t.originalException))return r&&P.log(hs),s;const o={event_id:s,...t},i=e.sdkProcessingMetadata||{},a=i.capturedSpanScope,c=i.capturedSpanIsolationScope;return this._process(this._captureEvent(e,o,a||n,c)),o.event_id}captureSession(e){this.sendSession(e),ae(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}async flush(e){const t=this._transport;if(!t)return!0;this.emit("flush");const n=await this._isClientDoneProcessing(e),s=await t.flush(e);return n&&s}async close(e){const t=await this.flush(e);return this.getOptions().enabled=!1,this.emit("close"),t}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];Oe(this,e,this._integrations),t||Re(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=function(e,t,n,s){const r=On(n),o=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){if(!t)return e;const n=e.sdk||{};e.sdk={...n,name:n.name||t.name,version:n.version||t.version,integrations:[...e.sdk?.integrations||[],...t.integrations||[]],packages:[...e.sdk?.packages||[],...t.packages||[]],settings:e.sdk?.settings||t.settings?{...e.sdk?.settings,...t.settings}:void 0}}(e,n?.sdk);const i=An(e,r,s,t);return delete e.sdkProcessingMetadata,Sn(i,[[{type:o},e]])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=wn(n,Cn(e));this.sendEnvelope(n).then(t=>this.emit("afterSendEvent",e,t))}sendSession(e){const{release:t,environment:n=pt}=this._options;if("aggregates"in e){const s=e.attrs||{};if(!s.release&&!t)return void(r&&P.warn(fs));s.release=s.release||t,s.environment=s.environment||n,e.attrs=s}else{if(!e.release&&!t)return void(r&&P.warn(fs));e.release=e.release||t,e.environment=e.environment||n}this.emit("beforeSendSession",e);const s=function(e,t,n,s){const r=On(n);return Sn({sent_at:(new Date).toISOString(),...r&&{sdk:r},...!!s&&t&&{dsn:rt(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(s)}recordDroppedEvent(e,t,n=1){if(this._options.sendClientReports){const s=`${e}:${t}`;r&&P.log(`Recording outcome: "${s}"${n>1?` (${n} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+n}}on(e,t){const n=this._hooks[e]=this._hooks[e]||new Set,s=(...e)=>t(...e);return n.add(s),()=>{n.delete(s)}}emit(e,...t){const n=this._hooks[e];n&&n.forEach(e=>e(...t))}async sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)try{return await this._transport.send(e)}catch(e){return r&&P.error("Error while sending envelope:",e),{}}return r&&P.error("Transport disabled"),{}}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(e,t){const n={};return t.forEach(t=>{t&&Oe(e,t,n)}),n}(this,e),Re(this,e)}_updateSessionFromEvent(e,t){let n="fatal"===t.level,s=!1;const r=t.exception?.values;if(r){s=!0;for(const e of r){const t=e.mechanism;if(!1===t?.handled){n=!0;break}}}const o="ok"===e.status;(o&&0===e.errors||o&&n)&&(ae(e,{...n&&{status:"crashed"},errors:e.errors||Number(s||n)}),this.captureSession(e))}async _isClientDoneProcessing(e){let t=0;for(;!e||t<e;){if(await new Promise(e=>setTimeout(e,1)),!this._numProcessing)return!0;t++}return!1}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,s){const r=this.getOptions(),o=Object.keys(this._integrations);return!t.integrations&&o?.length&&(t.integrations=o),this.emit("preprocessEvent",e,t),e.type||s.setLastEventId(e.event_id||t.event_id),ds(r,e,t,n,this,s).then(e=>{if(null===e)return e;this.emit("postprocessEvent",e,t),e.contexts={trace:Ie(n),...e.contexts};const s=mn(this,n);return e.sdkProcessingMetadata={dynamicSamplingContext:s,...e.sdkProcessingMetadata},e})}_captureEvent(e,t={},n=Se(),s=we()){return r&&ks(e)&&P.log(`Captured error event \`${Ne(e)[0]||"<unknown>"}\``),this._processEvent(e,t,n,s).then(e=>e.event_id,e=>{r&&(_s(e)?P.log(e.message):vs(e)?P.warn(e.message):P.warn(e))})}_processEvent(e,t,n,s){const r=this.getOptions(),{sampleRate:o}=r,i=xs(e),a=ks(e),c=e.type||"error",u=`before send for type \`${c}\``,l=void 0===o?void 0:Ut(o);if(a&&"number"==typeof l&&Math.random()>l)return this.recordDroppedEvent("sample_rate","error"),ns(bs(`Discarding event because it's not included in the random sample (sampling rate = ${o})`));const d="replay_event"===c?"replay":c;return this._prepareEvent(e,t,n,s).then(e=>{if(null===e)throw this.recordDroppedEvent("event_processor",d),bs("An event processor returned `null`, will not send event.");if(t.data&&!0===t.data.__sentry__)return e;const n=function(e,t,n,s){const{beforeSend:r,beforeSendTransaction:o,beforeSendSpan:i,ignoreSpans:a}=t;let c=n;if(ks(c)&&r)return r(c,s);if(xs(c)){if(i||a){const t=function(e){const{trace_id:t,parent_span_id:n,span_id:s,status:r,origin:o,data:i,op:a}=e.contexts?.trace??{};return{data:i??{},description:e.transaction,op:a,parent_span_id:n,span_id:s??"",start_timestamp:e.start_timestamp??0,status:r,timestamp:e.timestamp,trace_id:t??"",origin:o,profile_id:i?.[wt],exclusive_time:i?.[kt],measurements:e.measurements,is_segment:!0}}(c);if(a?.length&&Dn(t,a))return null;if(i){const e=i(t);e?c=ce(n,{type:"transaction",timestamp:(u=e).timestamp,start_timestamp:u.start_timestamp,transaction:u.description,contexts:{trace:{trace_id:u.trace_id,span_id:u.span_id,parent_span_id:u.parent_span_id,op:u.op,status:u.status,origin:u.origin,data:{...u.data,...u.profile_id&&{[wt]:u.profile_id},...u.exclusive_time&&{[kt]:u.exclusive_time}}}},measurements:u.measurements}):ln()}if(c.spans){const t=[],n=c.spans;for(const e of n)if(a?.length&&Dn(e,a))Ln(n,e);else if(i){const n=i(e);n?t.push(n):(ln(),t.push(e))}else t.push(e);const s=c.spans.length-t.length;s&&e.recordDroppedEvent("before_send","span",s),c.spans=t}}if(o){if(c.spans){const e=c.spans.length;c.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:e}}return o(c,s)}}var u;return c}(this,r,e,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(_(e))return e.then(e=>{if(!b(e)&&null!==e)throw ys(n);return e},e=>{throw ys(`${t} rejected with ${e}`)});if(!b(e)&&null!==e)throw ys(n);return e}(n,u)}).then(r=>{if(null===r){if(this.recordDroppedEvent("before_send",d),i){const t=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",t)}throw bs(`${u} returned \`null\`, will not send event.`)}const o=n.getSession()||s.getSession();if(a&&o&&this._updateSessionFromEvent(o,r),i){const e=(r.sdkProcessingMetadata?.spanCountBeforeProcessing||0)-(r.spans?r.spans.length:0);e>0&&this.recordDroppedEvent("before_send","span",e)}const c=r.transaction_info;if(i&&c&&r.transaction!==e.transaction){const e="custom";r.transaction_info={...c,source:e}}return this.sendEvent(r,t),r}).then(null,e=>{if(_s(e)||vs(e))throw e;throw this.captureException(e,{mechanism:{handled:!1,type:"internal"},data:{__sentry__:!0},originalException:e}),ys(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)})}_process(e){this._numProcessing++,e.then(e=>(this._numProcessing--,e),e=>(this._numProcessing--,e))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([e,t])=>{const[n,s]=e.split(":");return{reason:n,category:s,quantity:t}})}_flushOutcomes(){r&&P.log("Flushing outcomes...");const e=this._clearOutcomes();if(0===e.length)return void(r&&P.log("No outcomes to send"));if(!this._dsn)return void(r&&P.log("No dsn provided, will not send outcomes"));r&&P.log("Sending outcomes:",e);const t=(n=e,Sn((s=this._options.tunnel&&rt(this._dsn))?{dsn:s}:{},[[{type:"client_report"},{timestamp:ne(),discarded_events:n}]]));var n,s;this.sendEnvelope(t)}}function ks(e){return void 0===e.type}function xs(e){return"transaction"===e.type}function Ts(e){let t=0;return e.name&&(t+=2*e.name.length),"string"==typeof e.value?t+=2*e.value.length:t+=8,t+Is(e.attributes)}function Es(e){let t=0;return e.message&&(t+=2*e.message.length),t+Is(e.attributes)}function Is(e){if(!e)return 0;let t=0;return Object.values(e).forEach(e=>{Array.isArray(e)?t+=e.length*Cs(e[0]):y(e)?t+=Cs(e):t+=100}),t}function Cs(e){return"string"==typeof e?2*e.length:"number"==typeof e?8:"boolean"==typeof e?4:0}function Ms(e){"aggregates"in e?void 0===e.attrs?.ip_address&&(e.attrs={...e.attrs,ip_address:"{{auto}}"}):void 0===e.ipAddress&&(e.ipAddress="{{auto}}")}function Rs(e,t){const n=As(e,t),s={type:Ls(t),value:Ps(t)};return n.length&&(s.stacktrace={frames:n}),void 0===s.type&&""===s.value&&(s.value="Unrecoverable error caught"),s}function Os(e,t){return{exception:{values:[Rs(e,t)]}}}function As(e,t){const n=t.stacktrace||t.stack||"",s=function(e){return e&&Ns.test(e.message)?1:0}(t),r=function(e){return"number"==typeof e.framesToPop?e.framesToPop:0}(t);try{return e(n,s,r)}catch{}return[]}const Ns=/Minified React error #\d+;/i;function Ds(e){return"undefined"!=typeof WebAssembly&&void 0!==WebAssembly.Exception&&e instanceof WebAssembly.Exception}function Ls(e){const t=e?.name;return!t&&Ds(e)?e.message&&Array.isArray(e.message)&&2==e.message.length?e.message[0]:"WebAssembly.Exception":t}function Ps(e){const t=e?.message;return Ds(e)?Array.isArray(e.message)&&2==e.message.length?e.message[1]:"wasm exception":t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function Fs(e,t,n,s){const r=js(e,t,n?.syntheticException||void 0,s);return Z(r),r.level="error",n?.event_id&&(r.event_id=n.event_id),ts(r)}function $s(e,t,n="info",s,r){const o=Bs(e,t,s?.syntheticException||void 0,r);return o.level=n,s?.event_id&&(o.event_id=s.event_id),ts(o)}function js(e,t,n,s,r){let o;if(h(t)&&t.error)return Os(e,t.error);if(f(t)||p(t,"DOMException")){const r=t;if("stack"in t)o=Os(e,t);else{const t=r.name||(f(r)?"DOMError":"DOMException"),i=r.message?`${t}: ${r.message}`:t;o=Bs(e,i,n,s),Q(o,i)}return"code"in r&&(o.tags={...o.tags,"DOMException.code":`${r.code}`}),o}return d(t)?Os(e,t):b(t)||v(t)?(o=function(e,t,n,s){const r=Ee(),o=r?.getOptions().normalizeDepth,i=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}}(t),a={__serialized__:vn(t,o)};if(i)return{exception:{values:[Rs(e,i)]},extra:a};const c={exception:{values:[{type:v(t)?t.constructor.name:s?"UnhandledRejection":"Error",value:Us(t,{isUnhandledRejection:s})}]},extra:a};if(n){const t=As(e,n);t.length&&(c.exception.values[0].stacktrace={frames:t})}return c}(e,t,n,r),Z(o,{synthetic:!0}),o):(o=Bs(e,t,n,s),Q(o,`${t}`,void 0),Z(o,{synthetic:!0}),o)}function Bs(e,t,n,s){const r={};if(s&&n){const s=As(e,n);s.length&&(r.exception={values:[{value:t,stacktrace:{frames:s}}]}),Z(r,{synthetic:!0})}if(g(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return r.logentry={message:e,params:n},r}return r.message=t,r}function Us(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(V(e));n.sort();const s=n[0];if(!s)return"[object has no keys]";if(s.length>=t)return F(s,t);for(let e=n.length;e>0;e--){const s=n.slice(0,e).join(", ");if(!(s.length>t))return e===n.length?s:F(s,t)}return""}(e),s=t?"promise rejection":"exception";return h(e)?`Event \`ErrorEvent\` captured as ${s} with message \`${e.message}\``:v(e)?`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}(e)}\` (type=${e.type}) captured as ${s}`:`Object captured as ${s} with keys: ${n}`}function Hs(e,t){return Se().captureException(e,function(e){if(e)return function(e){return e instanceof fe||"function"==typeof e}(e)||function(e){return Object.keys(e).some(e=>ps.includes(e))}(e)?{captureContext:e}:e}(t))}function zs(e,t){const n="string"==typeof t?t:void 0,s="string"!=typeof t?{captureContext:t}:void 0;return Se().captureMessage(e,n,s)}function qs(e,t){return Se().captureEvent(e,t)}function Ws(e,t){we().setContext(e,t)}function Vs(e){we().setExtras(e)}function Js(e,t){we().setExtra(e,t)}function Ks(e){we().setTags(e)}function Gs(e,t){we().setTag(e,t)}function Xs(e){we().setUser(e)}function Ys(){return we().lastEventId()}async function Qs(e){const t=Ee();return t?t.flush(e):(r&&P.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function Zs(e){const t=Ee();return t?t.close(e):(r&&P.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function er(){return!!Ee()}function tr(){const e=Ee();return!1!==e?.getOptions().enabled&&!!e?.getTransport()}function nr(e){we().addEventProcessor(e)}function sr(e){const t=we(),n=Se(),{userAgent:s}=i.navigator||{},r=function(e){const t=oe(),n={sid:G(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return{sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}}}(n)};return e&&ae(n,e),n}({user:n.getUser()||t.getUser(),...s&&{userAgent:s},...e}),o=t.getSession();return"ok"===o?.status&&ae(o,{status:"exited"}),rr(),t.setSession(r),r}function rr(){const e=we(),t=Se().getSession()||e.getSession();t&&function(e){let t={};"ok"===e.status&&(t={status:"exited"}),ae(e,t)}(t),or(),e.setSession()}function or(){const e=we(),t=Ee(),n=e.getSession();n&&t&&t.captureSession(n)}function ir(e=!1){e?rr():or()}const ar=i;let cr=0;function ur(){return cr>0}function lr(e,t={}){if(!function(e){return"function"==typeof e}(e))return e;try{const t=e.__sentry_wrapped__;if(t)return"function"==typeof t?t:e;if(W(e))return e}catch{return e}const n=function(...n){try{const s=n.map(e=>lr(e,t));return e.apply(this,s)}catch(e){throw cr++,setTimeout(()=>{cr--}),xe(s=>{s.addEventProcessor(e=>(t.mechanism&&(Q(e,void 0,void 0),Z(e,t.mechanism)),e.extra={...e.extra,arguments:n},e)),Hs(e)}),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}catch{}q(n,e),z(e,"__sentry_wrapped__",n);try{Object.getOwnPropertyDescriptor(n,"name").configurable&&Object.defineProperty(n,"name",{get:()=>e.name})}catch{}return n}function dr(){const e=C(),{referrer:t}=ar.document||{},{userAgent:n}=ar.navigator||{};return{url:e,headers:{...t&&{Referer:t},...n&&{"User-Agent":n}}}}class pr extends ws{constructor(e){const t=(n=e,{release:"string"==typeof __SENTRY_RELEASE__?__SENTRY_RELEASE__:ar.SENTRY_RELEASE?.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...n});var n;!function(e,t,n=[t],s="npm"){const r=e._metadata||{};r.sdk||(r.sdk={name:`sentry.javascript.${t}`,packages:n.map(e=>({name:`${s}:@sentry/${e}`,version:o})),version:o}),e._metadata=r}(t,"browser",["browser"],ar.SENTRY_SDK_SOURCE||"npm"),t._metadata?.sdk&&(t._metadata.sdk.settings={infer_ip:t.sendDefaultPii?"auto":"never",...t._metadata.sdk.settings}),super(t);const{sendDefaultPii:s,sendClientReports:r,enableLogs:i,_experiments:a}=this._options;ar.document&&(r||i||a?.enableMetrics)&&ar.document.addEventListener("visibilitychange",()=>{"hidden"===ar.document.visibilityState&&(r&&this._flushOutcomes(),i&&Wn(this),a?.enableMetrics&&Qn(this))}),s&&this.on("beforeSendSession",Ms)}eventFromException(e,t){return Fs(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return $s(this._options.stackParser,e,t,n,this._options.attachStacktrace)}_prepareEvent(e,t,n,s){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n,s)}}const hr={},fr={};function mr(e,t){hr[e]=hr[e]||[],hr[e].push(t)}function gr(e,t){if(!fr[e]){fr[e]=!0;try{t()}catch(t){r&&P.error(`Error while instrumenting ${e}`,t)}}}function yr(e,t){const n=e&&hr[e];if(n)for(const s of n)try{s(t)}catch(t){r&&P.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${Ge(s)}\nError:`,t)}}function br(e){const t="console";mr(t,e),gr(t,vr)}function vr(){"console"in i&&R.forEach(function(e){e in i.console&&H(i.console,e,function(t){return O[e]=t,function(...t){yr("console",{args:t,level:e});const n=O[e];n?.apply(i.console,t)}})})}const _r=i;function Sr(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function wr(){if("string"==typeof EdgeRuntime)return!0;if(!function(){if(!("fetch"in _r))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}())return!1;if(Sr(_r.fetch))return!0;let e=!1;const t=_r.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow?.fetch&&(e=Sr(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){r&&P.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e}function kr(e,t){const n="fetch";mr(n,e),gr(n,()=>xr(void 0,t))}function xr(e,t=!1){t&&!wr()||H(i,"fetch",function(t){return function(...n){const s=new Error,{method:r,url:o}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:Ir(t),method:Er(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:Ir(t),method:Er(t,"method")?String(t.method).toUpperCase():"GET"}}(n),a={args:n,fetchData:{method:r,url:o},startTimestamp:1e3*oe(),virtualError:s,headers:Cr(n)};return e||yr("fetch",{...a}),t.apply(i,n).then(async t=>(e?e(t):yr("fetch",{...a,endTimestamp:1e3*oe(),response:t}),t),e=>{if(yr("fetch",{...a,endTimestamp:1e3*oe(),error:e}),d(e)&&void 0===e.stack&&(e.stack=s.stack,z(e,"framesToPop",1)),e instanceof TypeError&&("Failed to fetch"===e.message||"Load failed"===e.message||"NetworkError when attempting to fetch resource."===e.message))try{const t=new URL(a.fetchData.url);e.message=`${e.message} (${t.host})`}catch{}throw e})}})}function Tr(e){let t;try{t=e.clone()}catch{return}!async function(e,t){if(e?.body){const n=e.body,s=n.getReader(),r=setTimeout(()=>{n.cancel().then(null,()=>{})},9e4);let o=!0;for(;o;){let e;try{e=setTimeout(()=>{n.cancel().then(null,()=>{})},5e3);const{done:r}=await s.read();clearTimeout(e),r&&(t(),o=!1)}catch{o=!1}finally{clearTimeout(e)}}clearTimeout(r),s.releaseLock(),n.cancel().then(null,()=>{})}}(t,()=>{yr("fetch-body-resolved",{endTimestamp:1e3*oe(),response:e})})}function Er(e,t){return!!e&&"object"==typeof e&&!!e[t]}function Ir(e){return"string"==typeof e?e:e?Er(e,"url")?e.url:e.toString?e.toString():"":""}function Cr(e){const[t,n]=e;try{if("object"==typeof n&&null!==n&&"headers"in n&&n.headers)return new Headers(n.headers);if(k(t))return new Headers(t.headers)}catch{}}const Mr=100;function Rr(e,t){const n=Ee(),s=we();if(!n)return;const{beforeBreadcrumb:r=null,maxBreadcrumbs:o=Mr}=n.getOptions();if(o<=0)return;const i={timestamp:ne(),...e},a=r?A(()=>r(i,t)):i;null!==a&&(n.emit&&n.emit("beforeAddBreadcrumb",a,t),s.addBreadcrumb(a,o))}function Or(e){return"warn"===e?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}function Ar(e){return void 0===e?void 0:e>=400&&e<500?"warning":e>=500?"error":void 0}const Nr="thismessage:/";function Dr(e){return"isRelative"in e}function Lr(e,t){const n=e.indexOf("://")<=0&&0!==e.indexOf("//"),s=t??(n?Nr:void 0);try{if("canParse"in URL&&!URL.canParse(e,s))return;const t=new URL(e,s);return n?{isRelative:n,pathname:t.pathname,search:t.search,hash:t.hash}:t}catch{}}function Pr(e){if(Dr(e))return e.pathname;const t=new URL(e);return t.search="",t.hash="",["80","443"].includes(t.port)&&(t.port=""),t.password&&(t.password="%filtered%"),t.username&&(t.username="%filtered%"),t.toString()}function Fr(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",s=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:s,relative:t[5]+n+s}}function $r(e){return e.split(/[?#]/,1)[0]}const jr=i;let Br,Ur,Hr;function zr(e){mr("dom",e),gr("dom",qr)}function qr(){if(!jr.document)return;const e=yr.bind(null,"dom"),t=Wr(e,!0);jr.document.addEventListener("click",t,!1),jr.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(t=>{const n=jr,s=n[t]?.prototype;s?.hasOwnProperty?.("addEventListener")&&(H(s,"addEventListener",function(t){return function(n,s,r){if("click"===n||"keypress"==n)try{const s=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},o=s[n]=s[n]||{refCount:0};if(!o.handler){const s=Wr(e);o.handler=s,t.call(this,n,s,r)}o.refCount++}catch{}return t.call(this,n,s,r)}}),H(s,"removeEventListener",function(e){return function(t,n,s){if("click"===t||"keypress"==t)try{const n=this.__sentry_instrumentation_handlers__||{},r=n[t];r&&(r.refCount--,r.refCount<=0&&(e.call(this,t,r.handler,s),r.handler=void 0,delete n[t]),0===Object.keys(n).length&&delete this.__sentry_instrumentation_handlers__)}catch{}return e.call(this,t,n,s)}}))})}function Wr(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const s=function(e){try{return e.target}catch{return null}}(n);if(function(e,t){return"keypress"===e&&(!t?.tagName||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)}(n.type,s))return;z(n,"_sentryCaptured",!0),s&&!s._sentryId&&z(s,"_sentryId",G());const r="keypress"===n.type?"input":n.type;(function(e){if(e.type!==Ur)return!1;try{if(!e.target||e.target._sentryId!==Hr)return!1}catch{}return!0})(n)||(e({event:n,name:r,global:t}),Ur=n.type,Hr=s?s._sentryId:void 0),clearTimeout(Br),Br=jr.setTimeout(()=>{Hr=void 0,Ur=void 0},1e3)}}const Vr="__sentry_xhr_v3__";function Jr(e){mr("xhr",e),gr("xhr",Kr)}function Kr(){if(!jr.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(e,t,n){const s=new Error,r=1e3*oe(),o=m(n[0])?n[0].toUpperCase():void 0,i=function(e){if(m(e))return e;try{return e.toString()}catch{}}(n[1]);if(!o||!i)return e.apply(t,n);t[Vr]={method:o,url:i,request_headers:{}},"POST"===o&&i.match(/sentry_key/)&&(t.__sentry_own_request__=!0);const a=()=>{const e=t[Vr];if(e&&4===t.readyState){try{e.status_code=t.status}catch{}yr("xhr",{endTimestamp:1e3*oe(),startTimestamp:r,xhr:t,virtualError:s})}};return"onreadystatechange"in t&&"function"==typeof t.onreadystatechange?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply:(e,t,n)=>(a(),e.apply(t,n))}):t.addEventListener("readystatechange",a),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(e,t,n){const[s,r]=n,o=t[Vr];return o&&m(s)&&m(r)&&(o.request_headers[s.toLowerCase()]=r),e.apply(t,n)}}),e.apply(t,n)}}),e.send=new Proxy(e.send,{apply(e,t,n){const s=t[Vr];return s?(void 0!==n[0]&&(s.body=n[0]),yr("xhr",{startTimestamp:1e3*oe(),xhr:t}),e.apply(t,n)):e.apply(t,n)}})}let Gr;function Xr(e){const t="history";mr(t,e),gr(t,Yr)}function Yr(){function e(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const s=Gr,r=function(e){try{return new URL(e,jr.location.origin).toString()}catch{return e}}(String(n));if(Gr=r,s===r)return e.apply(this,t);yr("history",{from:s,to:r})}return e.apply(this,t)}}jr.addEventListener("popstate",()=>{const e=jr.location.href,t=Gr;Gr=e,t!==e&&yr("history",{from:t,to:e})}),"history"in _r&&_r.history&&(H(jr.history,"pushState",e),H(jr.history,"replaceState",e))}const Qr="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Zr=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:"Breadcrumbs",setup(e){t.console&&br(function(e){return function(t){if(Ee()!==e)return;const n={category:"console",data:{arguments:t.args,logger:"console"},level:Or(t.level),message:j(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;n.message=`Assertion failed: ${j(t.args.slice(1)," ")||"console.assert"}`,n.data.arguments=t.args.slice(1)}Rr(n,{input:t.args,level:t.level})}}(e)),t.dom&&zr(function(e,t){return function(n){if(Ee()!==e)return;let s,r,o="object"==typeof t?t.serializeAttribute:void 0,i="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;i&&i>1024&&(Qr&&P.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${i} was configured. Sentry will use 1024 instead.`),i=1024),"string"==typeof o&&(o=[o]);try{const e=n.event,t=function(e){return!!e&&!!e.target}(e)?e.target:e;s=E(t,{keyAttrs:o,maxStringLength:i}),r=M(t)}catch{s="<unknown>"}if(0===s.length)return;const a={category:`ui.${n.name}`,message:s};r&&(a.data={"ui.component_name":r}),Rr(a,{event:n.event,name:n.name,global:n.global})}}(e,t.dom)),t.xhr&&Jr(function(e){return function(t){if(Ee()!==e)return;const{startTimestamp:n,endTimestamp:s}=t,r=t.xhr[Vr];if(!n||!s||!r)return;const{method:o,url:i,status_code:a,body:c}=r,u={method:o,url:i,status_code:a},l={xhr:t.xhr,input:c,startTimestamp:n,endTimestamp:s},d={category:"xhr",data:u,type:"http",level:Ar(a)};e.emit("beforeOutgoingRequestBreadcrumb",d,l),Rr(d,l)}}(e)),t.fetch&&kr(function(e){return function(t){if(Ee()!==e)return;const{startTimestamp:n,endTimestamp:s}=t;if(s&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.fetchData.method,t.fetchData.url,t.error){const r=t.fetchData,o={data:t.error,input:t.args,startTimestamp:n,endTimestamp:s},i={category:"fetch",data:r,level:"error",type:"http"};e.emit("beforeOutgoingRequestBreadcrumb",i,o),Rr(i,o)}else{const r=t.response,o={...t.fetchData,status_code:r?.status};t.fetchData.request_body_size,t.fetchData.response_body_size;const i={input:t.args,response:r,startTimestamp:n,endTimestamp:s},a={category:"fetch",data:o,type:"http",level:Ar(o.status_code)};e.emit("beforeOutgoingRequestBreadcrumb",a,i),Rr(a,i)}}}(e)),t.history&&Xr(function(e){return function(t){if(Ee()!==e)return;let n=t.from,s=t.to;const r=Fr(ar.location.href);let o=n?Fr(n):void 0;const i=Fr(s);o?.path||(o=r),r.protocol===i.protocol&&r.host===i.host&&(s=i.relative),r.protocol===o.protocol&&r.host===o.host&&(n=o.relative),Rr({category:"navigation",data:{from:n,to:s}})}}(e)),t.sentry&&e.on("beforeSendEvent",function(e){return function(t){Ee()===e&&Rr({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:Y(t)},{event:t})}}(e))}}},eo=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],to=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1,...e};return{name:"BrowserApiErrors",setupOnce(){t.setTimeout&&H(ar,"setTimeout",no),t.setInterval&&H(ar,"setInterval",no),t.requestAnimationFrame&&H(ar,"requestAnimationFrame",so),t.XMLHttpRequest&&"XMLHttpRequest"in ar&&H(XMLHttpRequest.prototype,"send",ro);const e=t.eventTarget;e&&(Array.isArray(e)?e:eo).forEach(e=>function(e,t){const n=ar,s=n[e]?.prototype;s?.hasOwnProperty?.("addEventListener")&&(H(s,"addEventListener",function(n){return function(s,r,o){try{"function"==typeof r.handleEvent&&(r.handleEvent=lr(r.handleEvent,{mechanism:{data:{handler:Ge(r),target:e},handled:!1,type:"auto.browser.browserapierrors.handleEvent"}}))}catch{}return t.unregisterOriginalCallbacks&&function(e,t,n){e&&"object"==typeof e&&"removeEventListener"in e&&"function"==typeof e.removeEventListener&&e.removeEventListener(t,n)}(this,s,r),n.apply(this,[s,lr(r,{mechanism:{data:{handler:Ge(r),target:e},handled:!1,type:"auto.browser.browserapierrors.addEventListener"}}),o])}}),H(s,"removeEventListener",function(e){return function(t,n,s){try{const r=n.__sentry_wrapped__;r&&e.call(this,t,r,s)}catch{}return e.call(this,t,n,s)}}))}(e,t))}}};function no(e){return function(...t){const n=t[0];return t[0]=lr(n,{mechanism:{handled:!1,type:`auto.browser.browserapierrors.${Ge(e)}`}}),e.apply(this,t)}}function so(e){return function(t){return e.apply(this,[lr(t,{mechanism:{data:{handler:Ge(e)},handled:!1,type:"auto.browser.browserapierrors.requestAnimationFrame"}})])}}function ro(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(e=>{e in n&&"function"==typeof n[e]&&H(n,e,function(t){const n={mechanism:{data:{handler:Ge(t)},handled:!1,type:`auto.browser.browserapierrors.xhr.${e}`}},s=W(t);return s&&(n.mechanism.data.handler=Ge(s)),lr(t,n)})}),e.apply(this,t)}}const oo=()=>({name:"BrowserSession",setupOnce(){void 0!==ar.document?(sr({ignoreDuration:!0}),ir(),Xr(({from:e,to:t})=>{void 0!==e&&e!==t&&(sr({ignoreDuration:!0}),ir())})):Qr&&P.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}});let io=null;function ao(e){const t="error";mr(t,e),gr(t,co)}function co(){io=i.onerror,i.onerror=function(e,t,n,s,r){return yr("error",{column:s,error:r,line:n,msg:e,url:t}),!!io&&io.apply(this,arguments)},i.onerror.__SENTRY_INSTRUMENTED__=!0}let uo=null;function lo(e){const t="unhandledrejection";mr(t,e),gr(t,po)}function po(){uo=i.onunhandledrejection,i.onunhandledrejection=function(e){return yr("unhandledrejection",e),!uo||uo.apply(this,arguments)},i.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const ho=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(e){t.onerror&&(function(e){ao(t=>{const{stackParser:n,attachStacktrace:s}=mo();if(Ee()!==e||ur())return;const{msg:r,url:o,line:i,column:a,error:c}=t,u=function(e,t,n,s){const r=e.exception=e.exception||{},o=r.values=r.values||[],i=o[0]=o[0]||{},a=i.stacktrace=i.stacktrace||{},c=a.frames=a.frames||[],u=s,l=n,d=function(e){if(m(e)&&0!==e.length){if(e.startsWith("data:")){const t=e.match(/^data:([^;]+)/);return`<data:${t?t[1]:"text/javascript"}${e.includes("base64,")?",base64":""}>`}return e.slice(0,1024)}}(t)??C();return 0===c.length&&c.push({colno:u,filename:d,function:ze,in_app:!0,lineno:l}),e}(js(n,c||r,void 0,s,!1),o,i,a);u.level="error",qs(u,{originalException:c,mechanism:{handled:!1,type:"auto.browser.global_handlers.onerror"}})})}(e),fo("onerror")),t.onunhandledrejection&&(function(e){lo(t=>{const{stackParser:n,attachStacktrace:s}=mo();if(Ee()!==e||ur())return;const r=function(e){if(y(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}(t),o=y(r)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(r)}`}]}}:js(n,r,void 0,s,!0);o.level="error",qs(o,{originalException:r,mechanism:{handled:!1,type:"auto.browser.global_handlers.onunhandledrejection"}})})}(e),fo("onunhandledrejection"))}}};function fo(e){Qr&&P.log(`Global Handler attached: ${e}`)}function mo(){const e=Ee();return e?.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const go=()=>({name:"HttpContext",preprocessEvent(e){if(!ar.navigator&&!ar.location&&!ar.document)return;const t=dr(),n={...t.headers,...e.request?.headers};e.request={...t,...e.request,headers:n}}});function yo(e,t,n,s,r,o){if(!r.exception?.values||!o||!S(o.originalException,Error))return;const i=r.exception.values.length>0?r.exception.values[r.exception.values.length-1]:void 0;i&&(r.exception.values=bo(e,t,s,o.originalException,n,r.exception.values,i,0))}function bo(e,t,n,s,r,o,i,a){if(o.length>=n+1)return o;let c=[...o];if(S(s[r],Error)){vo(i,a);const o=e(t,s[r]),u=c.length;_o(o,r,u,a),c=bo(e,t,n,s[r],r,[o,...c],o,u)}return Array.isArray(s.errors)&&s.errors.forEach((s,o)=>{if(S(s,Error)){vo(i,a);const u=e(t,s),l=c.length;_o(u,`errors[${o}]`,l,a),c=bo(e,t,n,s,r,[u,...c],u,l)}}),c}function vo(e,t){e.mechanism={handled:!0,type:"auto.core.linked_errors",...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function _o(e,t,n,s){e.mechanism={handled:!0,...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:s}}const So=(e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:"LinkedErrors",preprocessEvent(e,s,r){yo(Rs,r.getOptions().stackParser,n,t,e,s)}}};function wo(e,t,n,s){const r={filename:e,function:"<anonymous>"===t?ze:t,in_app:!0};return void 0!==n&&(r.lineno=n),void 0!==s&&(r.colno=s),r}const ko=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,xo=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,To=/\((\S*)(?::(\d+))(?::(\d+))\)/,Eo=/at (.+?) ?\(data:(.+?),/,Io=[30,e=>{const t=e.match(Eo);if(t)return{filename:`<data:${t[2]}>`,function:t[1]};const n=ko.exec(e);if(n){const[,e,t,s]=n;return wo(e,ze,+t,+s)}const s=xo.exec(e);if(s){if(s[2]&&0===s[2].indexOf("eval")){const e=To.exec(s[2]);e&&(s[2]=e[1],s[3]=e[2],s[4]=e[3])}const[e,t]=jo(s[1]||ze,s[2]);return wo(t,e,s[3]?+s[3]:void 0,s[4]?+s[4]:void 0)}}],Co=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Mo=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Ro=[50,e=>{const t=Co.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=Mo.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||ze;return[n,e]=jo(n,e),wo(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}],Oo=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Ao=[40,e=>{const t=Oo.exec(e);return t?wo(t[2],t[1]||ze,+t[3],t[4]?+t[4]:void 0):void 0}],No=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,Do=[10,e=>{const t=No.exec(e);return t?wo(t[2],t[3]||ze,+t[1]):void 0}],Lo=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i,Po=[20,e=>{const t=Lo.exec(e);return t?wo(t[5],t[3]||t[4]||ze,+t[1],+t[2]):void 0}],Fo=[Io,Ro],$o=Ve(...Fo),jo=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),s=-1!==e.indexOf("safari-web-extension");return n||s?[-1!==e.indexOf("@")?e.split("@")[0]:ze,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},Bo=Symbol.for("SentryBufferFullError");const Uo=6e4;function Ho(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const s=Date.parse(`${e}`);return isNaN(s)?Uo:s-t}function zo(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}function qo(e,{statusCode:t,headers:n},s=Date.now()){const r={...e},o=n?.["x-sentry-rate-limits"],i=n?.["retry-after"];if(o)for(const e of o.trim().split(",")){const[t,n,,,o]=e.split(":",5),i=parseInt(t,10),a=1e3*(isNaN(i)?60:i);if(n)for(const e of n.split(";"))"metric_bucket"===e&&o&&!o.split(";").includes("custom")||(r[e]=s+a);else r.all=s+a}else i?r.all=s+Ho(i,s):429===t&&(r.all=s+6e4);return r}const Wo=64;function Vo(e,t,n=function(e=100){const t=new Set;function n(e){t.delete(e)}return{get $(){return Array.from(t)},add:function(s){if(!(t.size<e))return ns(Bo);const r=s();return t.add(r),r.then(()=>n(r),()=>n(r)),r},drain:function(e){if(!t.size)return ts(!0);const n=Promise.allSettled(Array.from(t)).then(()=>!0);if(!e)return n;const s=[n,new Promise(t=>setTimeout(()=>t(!1),e))];return Promise.race(s)}}}(e.bufferSize||Wo)){let s={};return{send:function(o){const i=[];if(kn(o,(t,n)=>{const r=Rn(n);zo(s,r)?e.recordDroppedEvent("ratelimit_backoff",r):i.push(t)}),0===i.length)return Promise.resolve({});const a=Sn(o[0],i),c=t=>{kn(a,(n,s)=>{e.recordDroppedEvent(t,Rn(s))})};return n.add(()=>t({body:En(a)}).then(e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&r&&P.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),s=qo(s,e),e),e=>{throw c("network_error"),r&&P.error("Encountered error running transport request:",e),e})).then(e=>e,e=>{if(e===Bo)return r&&P.error("Skipped sending event because buffer is full."),c("queue_overflow"),Promise.resolve({});throw e})},flush:e=>n.drain(e)}}const Jo="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Ko={};function Go(e){const t=Ko[e];if(t)return t;let n=jr[e];if(Sr(n))return Ko[e]=n.bind(jr);const s=jr.document;if(s&&"function"==typeof s.createElement)try{const t=s.createElement("iframe");t.hidden=!0,s.head.appendChild(t);const r=t.contentWindow;r?.[e]&&(n=r[e]),s.head.removeChild(t)}catch(t){Jo&&P.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,t)}return n?Ko[e]=n.bind(jr):n}function Xo(...e){return Go("setTimeout")(...e)}function Yo(e,t=Go("fetch")){let n=0,s=0;return Vo(e,async function(r){const o=r.body.length;n+=o,s++;const i={body:r.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:n<=6e4&&s<15,...e.fetchOptions};try{const n=await t(e.url,i);return{statusCode:n.status,headers:{"x-sentry-rate-limits":n.headers.get("X-Sentry-Rate-Limits"),"retry-after":n.headers.get("Retry-After")}}}catch(e){throw Ko.fetch=void 0,e}finally{n-=o,s--}})}function Qo(e){return[Pe(),Ue(),to(),Zr(),ho(),So(),Ye(),go(),oo()]}function Zo(e={}){const t=!e.skipBrowserExtensionCheck&&!!function(){if(void 0===ar.window)return!1;const e=ar;if(e.nw)return!1;const t=e.chrome||e.browser;if(!t?.runtime?.id)return!1;const n=C();return!(ar===ar.top&&["chrome-extension","moz-extension","ms-browser-extension","safari-web-extension"].some(e=>n.startsWith(`${e}://`)))}()&&(Qr&&A(()=>{console.error("[Sentry] You cannot use Sentry.init() in a browser extension, see: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")}),!0),n={...e,enabled:!t&&e.enabled,stackParser:(s=e.stackParser||$o,Array.isArray(s)?Ve(...s):s),integrations:Me({integrations:e.integrations,defaultIntegrations:null==e.defaultIntegrations?Qo():e.defaultIntegrations}),transport:e.transport||Yo};var s;return function(e,t){!0===t.debug&&(r?P.enable():A(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),Se().update(t.initialScope);const n=new e(t);return tt(n),n.init(),n}(pr,n)}function ei(){}function ti(e){e()}class ni{constructor(e={}){this._traceId=e.traceId||ue(),this._spanId=e.spanId||le()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:0}}end(e){}setAttribute(e,t){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,t,n){return this}addLink(e){return this}addLinks(e){return this}recordException(e,t){}}function si(e,t,n,s=un()){const o=s&&cn(s);o&&(r&&P.log(`[Measurement] Setting measurement on root span: ${e} = ${t} ${n}`),o.addEvent(e,{[_t]:t,[vt]:n}))}function ri(e){if(!e||0===e.length)return;const t={};return e.forEach(e=>{const n=e.attributes||{},s=n[vt],r=n[_t];"string"==typeof s&&"number"==typeof r&&(t[e.name]={value:r,unit:s})}),t}class oi{constructor(e={}){this._traceId=e.traceId||ue(),this._spanId=e.spanId||le(),this._startTime=e.startTimestamp||oe(),this._links=e.links,this._attributes={},this.setAttributes({[yt]:"manual",[gt]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,t){}spanContext(){const{_spanId:e,_traceId:t,_sampled:n}=this;return{spanId:e,traceId:t,traceFlags:n?Vt:0}}setAttribute(e,t){return void 0===t?delete this._attributes[e]:this._attributes[e]=t,this}setAttributes(e){return Object.keys(e).forEach(t=>this.setAttribute(t,e[t])),this}updateStartTime(e){this._startTime=Qt(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(ht,"custom"),this}end(e){this._endTime||(this._endTime=Qt(e),function(e){if(!r)return;const{description:t="< unknown name >",op:n="< unknown op >"}=en(e),{spanId:s}=e.spanContext(),o=`[Tracing] Finishing "${n}" ${cn(e)===e?"root ":""}span "${t}" with ID ${s}`;P.log(o)}(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[gt],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:nn(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[yt],profile_id:this._attributes[wt],exclusive_time:this._attributes[kt],measurements:ri(this._events),is_segment:this._isStandaloneSpan&&cn(this)===this||void 0,segment_id:this._isStandaloneSpan?cn(this).spanContext().spanId:void 0,links:Yt(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,t,n){r&&P.log("[Tracing] Adding an event to span:",e);const s=ii(t)?t:n||oe(),o=ii(t)?{}:t||{},i={name:e,time:Qt(s),attributes:o};return this._events.push(i),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=Ee();if(e&&e.emit("spanEnd",this),!this._isStandaloneSpan&&this!==cn(this))return;if(this._isStandaloneSpan)return void(this._sampled?function(e){const t=Ee();if(!t)return;const n=e[1];n&&0!==n.length?t.sendEnvelope(e):t.recordDroppedEvent("before_send","span")}(function(e,t){const n=gn(e[0]),s=t?.getDsn(),r=t?.getOptions().tunnel,o={sent_at:(new Date).toISOString(),...function(e){return!!e.trace_id&&!!e.public_key}(n)&&{trace:n},...!!r&&s&&{dsn:rt(s)}},{beforeSendSpan:i,ignoreSpans:a}=t?.getOptions()||{},c=a?.length?e.filter(e=>!Dn(en(e),a)):e,u=e.length-c.length;u&&t?.recordDroppedEvent("before_send","span",u);const l=i?e=>{const t=en(e);return i(t)||(ln(),t)}:en,d=[];for(const e of c){const t=l(e);t&&d.push(In(t))}return Sn(o,d)}([this],e)):(r&&P.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span")));const t=this._convertSpanToTransaction();t&&(Bt(this).scope||Se()).captureEvent(t)}_convertSpanToTransaction(){if(!ai(en(this)))return;this._name||(r&&P.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:t}=Bt(this),n=e?.getScopeData().sdkProcessingMetadata?.normalizedRequest;if(!0!==this._sampled)return;const s=an(this).filter(e=>e!==this&&!function(e){return e instanceof oi&&e.isStandaloneSpan()}(e)).map(e=>en(e)).filter(ai),o=this._attributes[ht];delete this._attributes[St],s.forEach(e=>{delete e.data[St]});const i={contexts:{trace:Kt(this)},spans:s.length>1e3?s.sort((e,t)=>e.start_timestamp-t.start_timestamp).slice(0,1e3):s,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:t,dynamicSamplingContext:gn(this)},request:n,...o&&{transaction_info:{source:o}}},a=ri(this._events);return a&&Object.keys(a).length&&(r&&P.log("[Measurements] Adding measurements to transaction event",JSON.stringify(a,void 0,2)),i.measurements=a),i}}function ii(e){return e&&"number"==typeof e||e instanceof Date||Array.isArray(e)}function ai(e){return!!(e.start_timestamp&&e.timestamp&&e.span_id&&e.trace_id)}function ci(e,t,n=()=>{},s=()=>{}){let r;try{r=e()}catch(e){throw t(e),n(),e}return function(e,t,n,s){return _(e)?e.then(e=>(n(),s(e),e),e=>{throw t(e),n(),e}):(n(),s(e),e)}(r,t,n,s)}const ui="__SENTRY_SUPPRESS_TRACING__";function li(e,t){const n=vi();if(n.startSpan)return n.startSpan(e,t);const s=bi(e),{forceTransaction:r,parentSpan:o,scope:i}=e,a=i?.clone();return xe(a,()=>wi(o)(()=>{const n=Se(),i=Si(n,o),a=e.onlyIfParent&&!i?new ni:yi({parentSpan:i,spanArguments:s,forceTransaction:r,scope:n});return pe(n,a),ci(()=>t(a),()=>{const{status:e}=en(a);!a.isRecording()||e&&"ok"!==e||a.setStatus({code:Dt,message:"internal_error"})},()=>{a.end()})}))}function di(e,t){const n=vi();if(n.startSpanManual)return n.startSpanManual(e,t);const s=bi(e),{forceTransaction:r,parentSpan:o,scope:i}=e,a=i?.clone();return xe(a,()=>wi(o)(()=>{const n=Se(),i=Si(n,o),a=e.onlyIfParent&&!i?new ni:yi({parentSpan:i,spanArguments:s,forceTransaction:r,scope:n});return pe(n,a),ci(()=>t(a,()=>a.end()),()=>{const{status:e}=en(a);!a.isRecording()||e&&"ok"!==e||a.setStatus({code:Dt,message:"internal_error"})})}))}function pi(e){const t=vi();if(t.startInactiveSpan)return t.startInactiveSpan(e);const n=bi(e),{forceTransaction:s,parentSpan:r}=e;return(e.scope?t=>xe(e.scope,t):void 0!==r?e=>fi(r,e):e=>e())(()=>{const t=Se(),o=Si(t,r);return e.onlyIfParent&&!o?new ni:yi({parentSpan:o,spanArguments:n,forceTransaction:s,scope:t})})}const hi=(e,t)=>{const n=_e(a());if(n.continueTrace)return n.continueTrace(e,t);const{sentryTrace:s,baggage:r}=e,o=Ee(),i=Ct(r);return o&&!function(e,t){const n=at(e);return t&&n&&t!==n?(P.log(`Won't continue trace because org IDs don't match (incoming baggage: ${t}, SDK options: ${n})`),!1):!e.getOptions().strictTraceContinuation||!(t&&!n||!t&&n)||(P.log(`Starting a new trace because strict trace continuation is enabled but one org ID is missing (incoming baggage: ${t}, Sentry client: ${n})`),!1)}(o,i?.org_id)?gi(t):xe(e=>{const n=zt(s,r);return e.setPropagationContext(n),t()})};function fi(e,t){const n=vi();return n.withActiveSpan?n.withActiveSpan(e,t):xe(n=>(pe(n,e||void 0),t(n)))}function mi(e){const t=vi();return t.suppressTracing?t.suppressTracing(e):xe(t=>{t.setSDKProcessingMetadata({[ui]:!0});const n=e();return t.setSDKProcessingMetadata({[ui]:void 0}),n})}function gi(e){return xe(t=>(t.setPropagationContext({traceId:ue(),sampleRand:Math.random()}),r&&P.log(`Starting a new trace with id ${t.getPropagationContext().traceId}`),fi(null,e)))}function yi({parentSpan:e,spanArguments:t,forceTransaction:n,scope:s}){if(!Ot()){const s=new ni;return!n&&e||hn(s,{sampled:"false",sample_rate:"0",transaction:t.name,...gn(s)}),s}const o=we();let a;if(e&&!n)a=function(e,t,n){const{spanId:s,traceId:r}=e.spanContext(),o=!t.getScopeData().sdkProcessingMetadata[ui]&&tn(e),i=o?new oi({...n,parentSpanId:s,traceId:r,sampled:o}):new ni({traceId:r});on(e,i);const a=Ee();return a&&(a.emit("spanStart",i),n.endTimestamp&&a.emit("spanEnd",i)),i}(e,s,t),on(e,a);else if(e){const n=gn(e),{traceId:r,spanId:o}=e.spanContext(),i=tn(e);a=_i({traceId:r,parentSpanId:o,...t},s,i),hn(a,n)}else{const{traceId:e,dsc:n,parentSpanId:r,sampled:i}={...o.getPropagationContext(),...s.getPropagationContext()};a=_i({traceId:e,parentSpanId:r,...t},s,i),n&&hn(a,n)}return function(e){if(!r)return;const{description:t="< unknown name >",op:n="< unknown op >",parent_span_id:s}=en(e),{spanId:o}=e.spanContext(),i=tn(e),a=cn(e),c=a===e,u=`[Tracing] Starting ${i?"sampled":"unsampled"} ${c?"root ":""}span`,l=[`op: ${n}`,`name: ${t}`,`ID: ${o}`];if(s&&l.push(`parent ID: ${s}`),!c){const{op:e,description:t}=en(a);l.push(`root ID: ${a.spanContext().spanId}`),e&&l.push(`root op: ${e}`),t&&l.push(`root description: ${t}`)}P.log(`${u}\n  ${l.join("\n  ")}`)}(a),function(e,t,n){e&&(z(e,$t,function(e){try{const t=i.WeakRef;if("function"==typeof t)return new t(e)}catch{}return e}(n)),z(e,Ft,t))}(a,s,o),a}function bi(e){const t={isStandalone:(e.experimental||{}).standalone,...e};if(e.startTime){const n={...t};return n.startTimestamp=Qt(e.startTime),delete n.startTime,n}return t}function vi(){return _e(a())}function _i(e,t,n){const s=Ee(),o=s?.getOptions()||{},{name:i=""}=e,a={spanAttributes:{...e.attributes},spanName:i,parentSampled:n};s?.emit("beforeSampling",a,{decision:!1});const c=a.parentSampled??n,u=a.spanAttributes,l=t.getPropagationContext(),[d,p,h]=t.getScopeData().sdkProcessingMetadata[ui]?[!1]:function(e,t,n){if(!Ot(e))return[!1];let s,o;"function"==typeof e.tracesSampler?(o=e.tracesSampler({...t,inheritOrSampleWith:e=>"number"==typeof t.parentSampleRate?t.parentSampleRate:"boolean"==typeof t.parentSampled?Number(t.parentSampled):e}),s=!0):void 0!==t.parentSampled?o=t.parentSampled:void 0!==e.tracesSampleRate&&(o=e.tracesSampleRate,s=!0);const i=Ut(o);if(void 0===i)return r&&P.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(o)} of type ${JSON.stringify(typeof o)}.`),[!1];if(!i)return r&&P.log("[Tracing] Discarding transaction because "+("function"==typeof e.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),[!1,i,s];const a=n<i;return a||r&&P.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(o)})`),[a,i,s]}(o,{name:i,parentSampled:c,attributes:u,parentSampleRate:Ut(l.dsc?.sample_rate)},l.sampleRand),f=new oi({...e,attributes:{[ht]:"custom",[ft]:void 0!==p&&h?p:void 0,...u},sampled:d});return!d&&s&&(r&&P.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),s.recordDroppedEvent("sample_rate","transaction")),s&&s.emit("spanStart",f),f}function Si(e,t){if(t)return t;if(null===t)return;const n=he(e);if(!n)return;const s=Ee();return(s?s.getOptions():{}).parentSpanIsAlwaysRootSpan?cn(n):n}function wi(e){return void 0!==e?t=>fi(e,t):e=>e()}const ki={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3};function xi(e,t={}){const n=new Map;let s,o=!1,i="externalFinish",a=!t.disableAutoFinish;const c=[],{idleTimeout:u=ki.idleTimeout,finalTimeout:l=ki.finalTimeout,childSpanTimeout:d=ki.childSpanTimeout,beforeSpanEnd:p,trimIdleSpanEndTimestamp:h=!0}=t,f=Ee();if(!f||!Ot()){const e=new ni;return hn(e,{sample_rate:"0",sampled:"false",...gn(e)}),e}const m=Se(),g=un(),y=function(e){const t=pi(e);return pe(Se(),t),r&&P.log("[Tracing] Started span is an idle span"),t}(e);function b(){s&&(clearTimeout(s),s=void 0)}function v(e){b(),s=setTimeout(()=>{!o&&0===n.size&&a&&(i="idleTimeout",y.end(e))},u)}function _(e){s=setTimeout(()=>{!o&&a&&(i="heartbeatFailed",y.end(e))},d)}function S(e){o=!0,n.clear(),c.forEach(e=>e()),pe(m,g);const t=en(y),{start_timestamp:s}=t;if(!s)return;t.data[bt]||y.setAttribute(bt,i),P.log(`[Tracing] Idle span "${t.op}" finished`);const a=an(y).filter(e=>e!==y);let d=0;a.forEach(t=>{t.isRecording()&&(t.setStatus({code:Dt,message:"cancelled"}),t.end(e),r&&P.log("[Tracing] Cancelling span since span ended early",JSON.stringify(t,void 0,2)));const n=en(t),{timestamp:s=0,start_timestamp:o=0}=n,i=o<=e,a=s-o<=(l+u)/1e3;if(r){const e=JSON.stringify(t,void 0,2);i?a||P.log("[Tracing] Discarding span since it finished after idle span final timeout",e):P.log("[Tracing] Discarding span since it happened after idle span was finished",e)}a&&i||(function(e,t){e[sn]&&e[sn].delete(t)}(y,t),d++)}),d>0&&y.setAttribute("sentry.idle_span_discarded_spans",d)}return y.end=new Proxy(y.end,{apply(e,t,n){if(p&&p(y),t instanceof ni)return;const[s,...r]=n,o=Qt(s||oe()),i=an(y).filter(e=>e!==y),a=en(y);if(!i.length||!h)return S(o),Reflect.apply(e,t,[o,...r]);const c=f.getOptions().ignoreSpans,u=i?.reduce((e,t)=>{const n=en(t);return n.timestamp?c&&Dn(n,c)?e:e?Math.max(e,n.timestamp):n.timestamp:e},void 0),d=a.start_timestamp,m=Math.min(d?d+l/1e3:1/0,Math.max(d||-1/0,Math.min(o,u||1/0)));return S(m),Reflect.apply(e,t,[m,...r])}}),c.push(f.on("spanStart",e=>{var t;o||e===y||en(e).timestamp||e instanceof oi&&e.isStandaloneSpan()||an(y).includes(e)&&(t=e.spanContext().spanId,b(),n.set(t,!0),_(oe()+d/1e3))})),c.push(f.on("spanEnd",e=>{var t;o||(t=e.spanContext().spanId,n.has(t)&&n.delete(t),0===n.size&&v(oe()+u/1e3))})),c.push(f.on("idleSpanEnableAutoFinish",e=>{e===y&&(a=!0,v(),n.size&&_())})),t.disableAutoFinish||v(),setTimeout(()=>{o||(y.setStatus({code:Dt,message:"deadline_exceeded"}),i="finalTimeout",y.end())},l),y}let Ti=!1;function Ei(){function e(){const e=un(),t=e&&cn(e);if(t){const e="internal_error";r&&P.log(`[Tracing] Root span: ${e} -> Global error occurred`),t.setStatus({code:Dt,message:e})}}Ti||(e.tag="sentry_tracingErrorCallback",Ti=!0,ao(e),lo(e))}const Ii=(e,t,n,s)=>{let r,o;return i=>{t.value>=0&&(i||s)&&(o=t.value-(r??0),(o||void 0===r)&&(r=t.value,t.delta=o,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,n),e(t)))}},Ci=(e=!0)=>{const t=jr.performance?.getEntriesByType?.("navigation")[0];if(!e||t&&t.responseStart>0&&t.responseStart<performance.now())return t},Mi=()=>{const e=Ci();return e?.activationStart??0},Ri=(e,t=-1)=>{const n=Ci();let s="navigate";return n&&(jr.document?.prerendering||Mi()>0?s="prerender":jr.document?.wasDiscarded?s="restore":n.type&&(s=n.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:s}},Oi=new WeakMap;function Ai(e,t){return Oi.get(e)||Oi.set(e,new t),Oi.get(e)}class Ni{constructor(){Ni.prototype.__init.call(this),Ni.prototype.__init2.call(this)}__init(){this._sessionValue=0}__init2(){this._sessionEntries=[]}_processEntry(e){if(e.hadRecentInput)return;const t=this._sessionEntries[0],n=this._sessionEntries[this._sessionEntries.length-1];this._sessionValue&&t&&n&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(this._sessionValue+=e.value,this._sessionEntries.push(e)):(this._sessionValue=e.value,this._sessionEntries=[e]),this._onAfterProcessingUnexpectedShift?.(e)}}const Di=(e,t,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const s=new PerformanceObserver(e=>{Promise.resolve().then(()=>{t(e.getEntries())})});return s.observe({type:e,buffered:!0,...n}),s}}catch{}},Li=e=>{let t=!1;return()=>{t||(e(),t=!0)}};let Pi=-1;const Fi=e=>{"hidden"===jr.document.visibilityState&&Pi>-1&&(Pi="visibilitychange"===e.type?e.timeStamp:0,$i())},$i=()=>{removeEventListener("visibilitychange",Fi,!0),removeEventListener("prerenderingchange",Fi,!0)},ji=()=>{if(jr.document&&Pi<0){const e=Mi(),t=jr.document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(t=>"hidden"===t.name&&t.startTime>e)[0]?.startTime;Pi=t??("hidden"!==jr.document?.visibilityState||jr.document?.prerendering?1/0:0),addEventListener("visibilitychange",Fi,!0),addEventListener("prerenderingchange",Fi,!0)}return{get firstHiddenTime(){return Pi}}},Bi=e=>{jr.document?.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},Ui=[1800,3e3],Hi=[.1,.25];let zi=0,qi=1/0,Wi=0;const Vi=e=>{e.forEach(e=>{e.interactionId&&(qi=Math.min(qi,e.interactionId),Wi=Math.max(Wi,e.interactionId),zi=Wi?(Wi-qi)/7+1:0)})};let Ji;const Ki=()=>Ji?zi:performance.interactionCount||0,Gi=()=>{"interactionCount"in performance||Ji||(Ji=Di("event",Vi,{type:"event",buffered:!0,durationThreshold:0}))};let Xi=0;class Yi{constructor(){Yi.prototype.__init.call(this),Yi.prototype.__init2.call(this)}__init(){this._longestInteractionList=[]}__init2(){this._longestInteractionMap=new Map}_resetInteractions(){Xi=Ki(),this._longestInteractionList.length=0,this._longestInteractionMap.clear()}_estimateP98LongestInteraction(){const e=Math.min(this._longestInteractionList.length-1,Math.floor((Ki()-Xi)/50));return this._longestInteractionList[e]}_processEntry(e){if(this._onBeforeProcessingEntry?.(e),!e.interactionId&&"first-input"!==e.entryType)return;const t=this._longestInteractionList.at(-1);let n=this._longestInteractionMap.get(e.interactionId);if(n||this._longestInteractionList.length<10||e.duration>t._latency){if(n?e.duration>n._latency?(n.entries=[e],n._latency=e.duration):e.duration===n._latency&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],_latency:e.duration},this._longestInteractionMap.set(n.id,n),this._longestInteractionList.push(n)),this._longestInteractionList.sort((e,t)=>t._latency-e._latency),this._longestInteractionList.length>10){const e=this._longestInteractionList.splice(10);for(const t of e)this._longestInteractionMap.delete(t.id)}this._onAfterProcessingINPCandidate?.(n)}}}const Qi=e=>{const t=t=>{"pagehide"!==t.type&&"hidden"!==jr.document?.visibilityState||e(t)};jr.document&&(addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0))},Zi=e=>{const t=jr.requestIdleCallback||jr.setTimeout;"hidden"===jr.document?.visibilityState?e():(t(e=Li(e)),Qi(e))},ea=[200,500];class ta{_processEntry(e){this._onBeforeProcessingEntry?.(e)}}const na=[2500,4e3],sa=[800,1800],ra=e=>{jr.document?.prerendering?Bi(()=>ra(e)):"complete"!==jr.document?.readyState?addEventListener("load",()=>ra(e),!0):setTimeout(e)},oa={},ia={};let aa,ca,ua,la;function da(e,t=!1){return _a("cls",e,ga,aa,t)}function pa(e,t=!1){return _a("lcp",e,ya,ca,t)}function ha(e){return _a("inp",e,va,la)}function fa(e,t){return Sa(e,t),ia[e]||(function(e){const t={};"event"===e&&(t.durationThreshold=0),Di(e,t=>{ma(e,{entries:t})},t)}(e),ia[e]=!0),wa(e,t)}function ma(e,t){const n=oa[e];if(n?.length)for(const s of n)try{s(t)}catch(t){Jo&&P.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${Ge(s)}\nError:`,t)}}function ga(){return((e,t={})=>{((e,t={})=>{Bi(()=>{const n=ji(),s=Ri("FCP");let r;const o=Di("paint",e=>{for(const t of e)"first-contentful-paint"===t.name&&(o.disconnect(),t.startTime<n.firstHiddenTime&&(s.value=Math.max(t.startTime-Mi(),0),s.entries.push(t),r(!0)))});o&&(r=Ii(e,s,Ui,t.reportAllChanges))})})(Li(()=>{const n=Ri("CLS",0);let s;const r=Ai(t,Ni),o=e=>{for(const t of e)r._processEntry(t);r._sessionValue>n.value&&(n.value=r._sessionValue,n.entries=r._sessionEntries,s())},i=Di("layout-shift",o);i&&(s=Ii(e,n,Hi,t.reportAllChanges),jr.document?.addEventListener("visibilitychange",()=>{"hidden"===jr.document?.visibilityState&&(o(i.takeRecords()),s(!0))}),jr?.setTimeout?.(s))}))})(e=>{ma("cls",{metric:e}),aa=e},{reportAllChanges:!0})}function ya(){return((e,t={})=>{Bi(()=>{const n=ji(),s=Ri("LCP");let r;const o=Ai(t,ta),i=e=>{t.reportAllChanges||(e=e.slice(-1));for(const t of e)o._processEntry(t),t.startTime<n.firstHiddenTime&&(s.value=Math.max(t.startTime-Mi(),0),s.entries=[t],r())},a=Di("largest-contentful-paint",i);if(a){r=Ii(e,s,na,t.reportAllChanges);const n=Li(()=>{i(a.takeRecords()),a.disconnect(),r(!0)});for(const e of["keydown","click","visibilitychange"])jr.document&&addEventListener(e,()=>Zi(n),{capture:!0,once:!0})}})})(e=>{ma("lcp",{metric:e}),ca=e},{reportAllChanges:!0})}function ba(){return((e,t={})=>{const n=Ri("TTFB"),s=Ii(e,n,sa,t.reportAllChanges);ra(()=>{const e=Ci();e&&(n.value=Math.max(e.responseStart-Mi(),0),n.entries=[e],s(!0))})})(e=>{ma("ttfb",{metric:e}),ua=e})}function va(){return((e,t={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&Bi(()=>{Gi();const n=Ri("INP");let s;const r=Ai(t,Yi),o=e=>{Zi(()=>{for(const t of e)r._processEntry(t);const t=r._estimateP98LongestInteraction();t&&t._latency!==n.value&&(n.value=t._latency,n.entries=t.entries,s())})},i=Di("event",o,{durationThreshold:t.durationThreshold??40});s=Ii(e,n,ea,t.reportAllChanges),i&&(i.observe({type:"first-input",buffered:!0}),Qi(()=>{o(i.takeRecords()),s(!0)}))})})(e=>{ma("inp",{metric:e}),la=e})}function _a(e,t,n,s,r=!1){let o;return Sa(e,t),ia[e]||(o=n(),ia[e]=!0),s&&t({metric:s}),wa(e,t,r?o:void 0)}function Sa(e,t){oa[e]=oa[e]||[],oa[e].push(t)}function wa(e,t,n){return()=>{n&&n();const s=oa[e];if(!s)return;const r=s.indexOf(t);-1!==r&&s.splice(r,1)}}function ka(e){return"number"==typeof e&&isFinite(e)}function xa(e,t,n,{...s}){const r=en(e).start_timestamp;return r&&r>t&&"function"==typeof e.updateStartTime&&e.updateStartTime(t),fi(e,()=>{const e=pi({startTime:t,...s});return e&&e.end(n),e})}function Ta(e){const t=Ee();if(!t)return;const{name:n,transaction:s,attributes:r,startTime:o}=e,{release:i,environment:a,sendDefaultPii:c}=t.getOptions(),u=t.getIntegrationByName("Replay"),l=u?.getReplayId(),d=Se(),p=d.getUser(),h=void 0!==p?p.email||p.id||p.ip_address:void 0;let f;try{f=d.getScopeData().contexts.profile.profile_id}catch{}return pi({name:n,attributes:{release:i,environment:a,user:h||void 0,profile_id:f||void 0,replay_id:l||void 0,transaction:s,"user_agent.original":jr.navigator?.userAgent,"client.address":c?"{{auto}}":void 0,...r},startTime:o,experimental:{standalone:!0}})}function Ea(){return jr.addEventListener&&jr.performance}function Ia(e){return e/1e3}function Ca(e){try{return PerformanceObserver.supportedEntryTypes.includes(e)}catch{return!1}}function Ma(e,t){let n,s=!1;function r(e){!s&&n&&t(e,n),s=!0}Qi(()=>{r("pagehide")});const o=e.on("beforeStartNavigationSpan",(e,t)=>{t?.isRedirect||(r("navigation"),o(),i())}),i=e.on("afterStartPageLoadSpan",e=>{n=e.spanContext().spanId,i()})}function Ra(e){return e?((ie()||performance.timeOrigin)+e)/1e3:e}function Oa(e){const t={};if(null!=e.nextHopProtocol){const{name:n,version:s}=function(e){let t="unknown",n="unknown",s="";for(const r of e){if("/"===r){[t,n]=e.split("/");break}if(!isNaN(Number(r))){t="h"===s?"http":s,n=e.split(s)[1];break}s+=r}return s===e&&(t=s),{name:t,version:n}}(e.nextHopProtocol);t["network.protocol.version"]=s,t["network.protocol.name"]=n}return ie()||Ea()?.timeOrigin?(n={...t,"http.request.redirect_start":Ra(e.redirectStart),"http.request.redirect_end":Ra(e.redirectEnd),"http.request.worker_start":Ra(e.workerStart),"http.request.fetch_start":Ra(e.fetchStart),"http.request.domain_lookup_start":Ra(e.domainLookupStart),"http.request.domain_lookup_end":Ra(e.domainLookupEnd),"http.request.connect_start":Ra(e.connectStart),"http.request.secure_connection_start":Ra(e.secureConnectionStart),"http.request.connection_end":Ra(e.connectEnd),"http.request.request_start":Ra(e.requestStart),"http.request.response_start":Ra(e.responseStart),"http.request.response_end":Ra(e.responseEnd),"http.request.time_to_first_byte":null!=e.responseStart?e.responseStart/1e3:void 0},Object.fromEntries(Object.entries(n).filter(([,e])=>null!=e))):t;var n}let Aa,Na,Da=0,La={};function Pa({recordClsStandaloneSpans:e,recordLcpStandaloneSpans:t,client:n}){const s=Ea();if(s&&ie()){s.mark&&jr.performance.mark("sentry-tracing-init");const r=t?function(e){let t,n=0;if(!Ca("largest-contentful-paint"))return;const s=pa(({metric:e})=>{const s=e.entries[e.entries.length-1];s&&(n=e.value,t=s)},!0);Ma(e,(e,r)=>{!function(e,t,n,s){Jo&&P.log(`Sending LCP span (${e})`);const r=Ia((ie()||0)+(t?.startTime||0)),o=Se().getScopeData().transactionName,i=t?E(t.element):"Largest contentful paint",a={[yt]:"auto.http.browser.lcp",[gt]:"ui.webvital.lcp",[kt]:0,"sentry.pageload.span_id":n,"sentry.report_event":s};t&&(t.element&&(a["lcp.element"]=E(t.element)),t.id&&(a["lcp.id"]=t.id),t.url&&(a["lcp.url"]=t.url.trim().slice(0,200)),null!=t.loadTime&&(a["lcp.loadTime"]=t.loadTime),null!=t.renderTime&&(a["lcp.renderTime"]=t.renderTime),null!=t.size&&(a["lcp.size"]=t.size));const c=Ta({name:i,transaction:o,attributes:a,startTime:r});c&&(c.addEvent("lcp",{[vt]:"millisecond",[_t]:e}),c.end(r))}(n,t,r,e),s()})}(n):pa(({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(La.lcp={value:e.value,unit:"millisecond"},Aa=t)},!0),o=_a("ttfb",({metric:e})=>{e.entries[e.entries.length-1]&&(La.ttfb={value:e.value,unit:"millisecond"})},ba,ua),i=e?function(e){let t,n=0;if(!Ca("layout-shift"))return;const s=da(({metric:e})=>{const s=e.entries[e.entries.length-1];s&&(n=e.value,t=s)},!0);Ma(e,(e,r)=>{!function(e,t,n,s){Jo&&P.log(`Sending CLS span (${e})`);const r=t?Ia((ie()||0)+t.startTime):oe(),o=Se().getScopeData().transactionName,i=t?E(t.sources[0]?.node):"Layout shift",a={[yt]:"auto.http.browser.cls",[gt]:"ui.webvital.cls",[kt]:0,"sentry.pageload.span_id":n,"sentry.report_event":s};t?.sources&&t.sources.forEach((e,t)=>{a[`cls.source.${t+1}`]=E(e.node)});const c=Ta({name:i,transaction:o,attributes:a,startTime:r});c&&(c.addEvent("cls",{[vt]:"",[_t]:e}),c.end(r))}(n,t,r,e),s()})}(n):da(({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(La.cls={value:e.value,unit:""},Na=t)},!0);return()=>{r?.(),o(),i?.()}}return()=>{}}function Fa(e,t,n,s,r=n){const o=function(e){return"secureConnection"===e?"connectEnd":"fetch"===e?"domainLookupStart":`${e}End`}(n),i=t[o],a=t[`${n}Start`];a&&i&&xa(e,s+Ia(a),s+Ia(i),{op:`browser.${r}`,name:t.name,attributes:{[yt]:"auto.ui.browser.metrics",..."redirect"===n&&null!=t.redirectCount?{"http.redirect_count":t.redirectCount}:{}}})}const $a=[],ja=new Map;const Ba={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"},Ua=({metric:e})=>{if(null==e.value)return;const t=Ia(e.value);if(t>60)return;const n=e.entries.find(t=>t.duration===e.value&&Ba[t.name]);if(!n)return;const{interactionId:s}=n,r=Ba[n.name],o=Ia(ie()+n.startTime),i=un(),a=i?cn(i):void 0,c=(null!=s?ja.get(s):void 0)||a,u=c?en(c).description:Se().getScopeData().transactionName,l=Ta({name:E(n.target),transaction:u,attributes:{[yt]:"auto.http.browser.inp",[gt]:`ui.interaction.${r}`,[kt]:n.duration},startTime:o});l&&(l.addEvent("inp",{[vt]:"millisecond",[_t]:e.value}),l.end(o+t))},Ha=({entries:e})=>{const t=un(),n=t?cn(t):void 0,s=n?en(n).description:Se().getScopeData().transactionName;e.forEach(e=>{const t=e;if(!t.identifier)return;const n=t.name,r=t.renderTime,o=t.loadTime,[i,a]=o?[Ia(o),"load-time"]:r?[Ia(r),"render-time"]:[oe(),"entry-emission"],c="image-paint"===n?Ia(Math.max(0,(r??0)-(o??0))):0,u={[yt]:"auto.ui.browser.elementtiming",[gt]:"ui.elementtiming",[ht]:"component","sentry.span_start_time_source":a,"sentry.transaction_name":s,"element.id":t.id,"element.type":t.element?.tagName?.toLowerCase()||"unknown","element.size":t.naturalWidth&&t.naturalHeight?`${t.naturalWidth}x${t.naturalHeight}`:void 0,"element.render_time":r,"element.load_time":o,"element.url":t.url||void 0,"element.identifier":t.identifier,"element.paint_type":n};li({name:`element[${t.identifier}]`,attributes:u,startTime:i,onlyIfParent:!0},e=>{e.end(i+c)})})},za="sentry_previous_trace";function qa(e){return 1===e.traceFlags}function Wa(e={}){const t=e.client||Ee();if(!tr()||!t)return{};const n=_e(a());if(n.getTraceData)return n.getTraceData(e);const s=e.scope||Se(),r=e.span||un(),o=r?Xt(r):function(e){const{traceId:t,sampled:n,propagationSpanId:s}=e.getPropagationContext();return qt(t,s,n)}(s),i=Mt(r?gn(r):mn(t,s));if(!Ht.test(o))return P.warn("Invalid sentry-trace data. Cannot generate trace data"),{};const c={"sentry-trace":o,baggage:i};if(e.propagateTraceparent){const e=r?function(e){const{traceId:t,spanId:n}=e.spanContext();return Wt(t,n,tn(e))}(r):function(e){const{traceId:t,sampled:n,propagationSpanId:s}=e.getPropagationContext();return Wt(t,s,n)}(s);e&&(c.traceparent=e)}return c}function Va(e){return e.split(",").some(e=>e.trim().startsWith(Tt))}function Ja(e,t,n,s){const r={url:e,type:"fetch","http.method":n,[yt]:s,[gt]:"http.client"};return t&&(Dr(t)||(r["http.url"]=t.href,r["server.address"]=t.host),t.search&&(r["http.query"]=t.search),t.hash&&(r["http.fragment"]=t.hash)),r}const Ka=new WeakMap,Ga=new Map,Xa={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,trackFetchStreamPerformance:!1};function Ya(e,t){const{traceFetch:n,traceXHR:s,trackFetchStreamPerformance:r,shouldCreateSpanForRequest:o,enableHTTPTimings:i,tracePropagationTargets:a,onRequestSpanStart:c}={...Xa,...t},u="function"==typeof o?o:e=>!0,l=e=>function(e,t){const n=C();if(n){let s,r;try{s=new URL(e,n),r=new URL(n).origin}catch{return!1}const o=s.origin===r;return t?U(s.toString(),t)||o&&U(s.pathname,t):o}{const n=!!e.match(/^\/(?!\/)/);return t?U(e,t):n}}(e,a),d={},p=e.getOptions().propagateTraceparent;n&&(e.addEventProcessor(e=>("transaction"===e.type&&e.spans&&e.spans.forEach(e=>{if("http.client"===e.op){const t=Ga.get(e.span_id);t&&(e.timestamp=t/1e3,Ga.delete(e.span_id))}}),e)),r&&function(){const e="fetch-body-resolved";mr(e,e=>{if(e.response){const t=Ka.get(e.response);t&&e.endTimestamp&&Ga.set(t,e.endTimestamp)}}),gr(e,()=>xr(Tr))}(),kr(e=>{const t=function(e,t,n,s,r){if(!e.fetchData)return;const{method:o,url:i}=e.fetchData,a=Ot()&&t(i);if(e.endTimestamp&&a){const t=e.fetchData.__span;if(!t)return;const n=s[t];return void(n&&(function(e,t){if(t.response){Pt(e,t.response.status);const n=t.response?.headers?.get("content-length");if(n){const t=parseInt(n);t>0&&e.setAttribute("http.response_content_length",t)}}else t.error&&e.setStatus({code:Dt,message:"internal_error"});e.end()}(n,e),delete s[t]))}const{spanOrigin:c="auto.http.browser",propagateTraceparent:u=!1}="object"==typeof r?r:{spanOrigin:r},l=!!un(),d=a&&l?pi(function(e,t,n){const s=Lr(e);return{name:s?`${t} ${Pr(s)}`:t,attributes:Ja(e,s,t,n)}}(i,o,c)):new ni;if(e.fetchData.__span=d.spanContext().spanId,s[d.spanContext().spanId]=d,n(e.fetchData.url)){const t=e.args[0],n=e.args[1]||{},s=function(e,t,n,s){const r=Wa({span:n,propagateTraceparent:s}),o=r["sentry-trace"],i=r.baggage,a=r.traceparent;if(!o)return;const c=t.headers||(k(e)?e.headers:void 0);if(c){if(function(e){return"undefined"!=typeof Headers&&S(e,Headers)}(c)){const e=new Headers(c);if(e.get("sentry-trace")||e.set("sentry-trace",o),s&&a&&!e.get("traceparent")&&e.set("traceparent",a),i){const t=e.get("baggage");t?Va(t)||e.set("baggage",`${t},${i}`):e.set("baggage",i)}return e}if(Array.isArray(c)){const e=[...c];c.find(e=>"sentry-trace"===e[0])||e.push(["sentry-trace",o]),s&&a&&!c.find(e=>"traceparent"===e[0])&&e.push(["traceparent",a]);const t=c.find(e=>"baggage"===e[0]&&Va(e[1]));return i&&!t&&e.push(["baggage",i]),e}{const e="sentry-trace"in c?c["sentry-trace"]:void 0,t="traceparent"in c?c.traceparent:void 0,n="baggage"in c?c.baggage:void 0,r=n?Array.isArray(n)?[...n]:[n]:[],u=n&&(Array.isArray(n)?n.find(e=>Va(e)):Va(n));i&&!u&&r.push(i);const l={...c,"sentry-trace":e??o,baggage:r.length>0?r.join(","):void 0};return s&&a&&!t&&(l.traceparent=a),l}}return{...r}}(t,n,Ot()&&l?d:void 0,u);s&&(e.args[1]=n,n.headers=s)}const p=Ee();if(p){const t={input:e.args,response:e.response,startTimestamp:e.startTimestamp,endTimestamp:e.endTimestamp};p.emit("beforeOutgoingRequestSpan",d,t)}return d}(e,u,l,d,{propagateTraceparent:p});if(e.response&&e.fetchData.__span&&Ka.set(e.response,e.fetchData.__span),t){const n=Za(e.fetchData.url),s=n?Fr(n).host:void 0;t.setAttributes({"http.url":n,"server.address":s}),i&&Qa(t),c?.(t,{headers:e.headers})}})),s&&Jr(e=>{const t=function(e,t,n,s,r){const o=e.xhr,i=o?.[Vr];if(!o||o.__sentry_own_request__||!i)return;const{url:a,method:c}=i,u=Ot()&&t(a);if(e.endTimestamp&&u){const e=o.__sentry_xhr_span_id__;if(!e)return;const t=s[e];return void(t&&void 0!==i.status_code&&(Pt(t,i.status_code),t.end(),delete s[e]))}const l=Za(a),d=Fr(l||a),p=$r(a),h=!!un(),f=u&&h?pi({name:`${c} ${p}`,attributes:{url:a,type:"xhr","http.method":c,"http.url":l,"server.address":d?.host,[yt]:"auto.http.browser",[gt]:"http.client",...d?.search&&{"http.query":d?.search},...d?.hash&&{"http.fragment":d?.hash}}}):new ni;o.__sentry_xhr_span_id__=f.spanContext().spanId,s[o.__sentry_xhr_span_id__]=f,n(a)&&function(e,t,n){const{"sentry-trace":s,baggage:r,traceparent:o}=Wa({span:t,propagateTraceparent:n});s&&function(e,t,n,s){const r=e.__sentry_xhr_v3__?.request_headers;if(!r?.["sentry-trace"]&&e.setRequestHeader)try{if(e.setRequestHeader("sentry-trace",t),s&&!r?.traceparent&&e.setRequestHeader("traceparent",s),n){const t=r?.baggage;t&&t.split(",").some(e=>e.trim().startsWith("sentry-"))||e.setRequestHeader("baggage",n)}}catch{}}(e,s,r,o)}(o,Ot()&&h?f:void 0,r);const m=Ee();return m&&m.emit("beforeOutgoingRequestSpan",f,e),f}(e,u,l,d,p);if(t){let n;i&&Qa(t);try{n=new Headers(e.xhr.__sentry_xhr_v3__?.request_headers)}catch{}c?.(t,{headers:n})}})}function Qa(e){const{url:t}=en(e).data;if(!t||"string"!=typeof t)return;const n=fa("resource",({entries:s})=>{s.forEach(s=>{(function(e){return"resource"===e.entryType&&"initiatorType"in e&&"string"==typeof e.nextHopProtocol&&("fetch"===e.initiatorType||"xmlhttprequest"===e.initiatorType)})(s)&&s.name.endsWith(t)&&(e.setAttributes(Oa(s)),setTimeout(n))})})}function Za(e){try{return new URL(e,ar.location.origin).href}catch{return}}const ec={...ki,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableLongAnimationFrame:!0,enableInp:!0,enableElementTiming:!0,ignoreResourceSpans:[],ignorePerformanceApiSpans:[],detectRedirects:!0,linkPreviousTrace:"in-memory",consistentTraceSampling:!1,enableReportPageLoaded:!1,_experiments:{},...Xa},tc=(e={})=>{const t={name:void 0,source:void 0},n=ar.document,{enableInp:s,enableElementTiming:r,enableLongTask:o,enableLongAnimationFrame:a,_experiments:{enableInteractions:c,enableStandaloneClsSpans:u,enableStandaloneLcpSpans:l},beforeStartSpan:d,idleTimeout:p,finalTimeout:h,childSpanTimeout:f,markBackgroundSpan:m,traceFetch:g,traceXHR:b,trackFetchStreamPerformance:v,shouldCreateSpanForRequest:_,enableHTTPTimings:S,ignoreResourceSpans:w,ignorePerformanceApiSpans:k,instrumentPageLoad:x,instrumentNavigation:T,detectRedirects:I,linkPreviousTrace:R,consistentTraceSampling:O,enableReportPageLoaded:A,onRequestSpanStart:N}={...ec,...e};let D,L,F;function $(e,s,r=!0){const o="pageload"===s.op,i=s.name,a=d?d(s):s,c=a.attributes||{};if(i!==a.name&&(c[ht]="custom",a.attributes=c),!r){const e=ne();return void pi({...a,startTime:e}).end(e)}t.name=a.name,t.source=c[ht];const m=xi(a,{idleTimeout:p,finalTimeout:h,childSpanTimeout:f,disableAutoFinish:o,beforeSpanEnd:t=>{D?.(),function(e,t){const n=Ea(),s=ie();if(!n?.getEntries||!s)return;const r=Ia(s),o=n.getEntries(),{op:i,start_timestamp:a}=en(e);o.slice(Da).forEach(n=>{const s=Ia(n.startTime),o=Ia(Math.max(0,n.duration));if(!("navigation"===i&&a&&r+s<a))switch(n.entryType){case"navigation":!function(e,t,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(s=>{Fa(e,t,s,n)}),Fa(e,t,"secureConnection",n,"TLS/SSL"),Fa(e,t,"fetch",n,"cache"),Fa(e,t,"domainLookup",n,"DNS"),function(e,t,n){const s=n+Ia(t.requestStart),r=n+Ia(t.responseEnd),o=n+Ia(t.responseStart);t.responseEnd&&(xa(e,s,r,{op:"browser.request",name:t.name,attributes:{[yt]:"auto.ui.browser.metrics"}}),xa(e,o,r,{op:"browser.response",name:t.name,attributes:{[yt]:"auto.ui.browser.metrics"}}))}(e,t,n)}(e,n,r);break;case"mark":case"paint":case"measure":{!function(e,t,n,s,r,o){if(function(e){if("measure"===e?.entryType)try{return"Components "===e.detail.devtools.track}catch{return}}(t))return;if(["mark","measure"].includes(t.entryType)&&U(t.name,o))return;const i=Ci(!1),a=Ia(i?i.requestStart:0),c=r+Math.max(n,a),u=r+n,l=u+s,d={[yt]:"auto.resource.browser.metrics"};c!==u&&(d["sentry.browser.measure_happened_before_request"]=!0,d["sentry.browser.measure_start_time"]=c),function(e,t){try{const n=t.detail;if(!n)return;if("object"==typeof n){for(const[t,s]of Object.entries(n))if(s&&y(s))e[`sentry.browser.measure.detail.${t}`]=s;else if(void 0!==s)try{e[`sentry.browser.measure.detail.${t}`]=JSON.stringify(s)}catch{}return}if(y(n))return void(e["sentry.browser.measure.detail"]=n);try{e["sentry.browser.measure.detail"]=JSON.stringify(n)}catch{}}catch{}}(d,t),c<=l&&xa(e,c,l,{name:t.name,op:t.entryType,attributes:d})}(e,n,s,o,r,t.ignorePerformanceApiSpans);const i=ji(),a=n.startTime<i.firstHiddenTime;"first-paint"===n.name&&a&&(La.fp={value:n.startTime,unit:"millisecond"}),"first-contentful-paint"===n.name&&a&&(La.fcp={value:n.startTime,unit:"millisecond"});break}case"resource":!function(e,t,n,s,r,o,i){if("xmlhttprequest"===t.initiatorType||"fetch"===t.initiatorType)return;const a=t.initiatorType?`resource.${t.initiatorType}`:"resource.other";if(i?.includes(a))return;const c={[yt]:"auto.resource.browser.metrics"},u=Fr(n);u.protocol&&(c["url.scheme"]=u.protocol.split(":").pop()),u.host&&(c["server.address"]=u.host),c["url.same_origin"]=n.includes(jr.location.origin),function(e,t){[["responseStatus","http.response.status_code"],["transferSize","http.response_transfer_size"],["encodedBodySize","http.response_content_length"],["decodedBodySize","http.decoded_response_content_length"],["renderBlockingStatus","resource.render_blocking_status"],["deliveryType","http.response_delivery_type"]].forEach(([n,s])=>{const r=e[n];null!=r&&("number"==typeof r&&r<2147483647||"string"==typeof r)&&(t[s]=r)})}(t,c);const l={...c,...Oa(t)},d=o+s;xa(e,d,d+r,{name:n.replace(jr.location.origin,""),op:a,attributes:l})}(e,n,n.name,s,o,r,t.ignoreResourceSpans)}}),Da=Math.max(o.length-1,0),function(e){const t=jr.navigator;if(!t)return;const n=t.connection;n&&(n.effectiveType&&e.setAttribute("effectiveConnectionType",n.effectiveType),n.type&&e.setAttribute("connectionType",n.type),ka(n.rtt)&&(La["connection.rtt"]={value:n.rtt,unit:"millisecond"})),ka(t.deviceMemory)&&e.setAttribute("deviceMemory",`${t.deviceMemory} GB`),ka(t.hardwareConcurrency)&&e.setAttribute("hardwareConcurrency",String(t.hardwareConcurrency))}(e),"pageload"===i&&(function(e){const t=Ci(!1);if(!t)return;const{responseStart:n,requestStart:s}=t;s<=n&&(e["ttfb.requestTime"]={value:n-s,unit:"millisecond"})}(La),t.recordClsOnPageloadSpan||delete La.cls,t.recordLcpOnPageloadSpan||delete La.lcp,Object.entries(La).forEach(([e,t])=>{si(e,t.value,t.unit)}),e.setAttribute("performance.timeOrigin",r),e.setAttribute("performance.activationStart",Mi()),function(e,t){Aa&&t.recordLcpOnPageloadSpan&&(Aa.element&&e.setAttribute("lcp.element",E(Aa.element)),Aa.id&&e.setAttribute("lcp.id",Aa.id),Aa.url&&e.setAttribute("lcp.url",Aa.url.trim().slice(0,200)),null!=Aa.loadTime&&e.setAttribute("lcp.loadTime",Aa.loadTime),null!=Aa.renderTime&&e.setAttribute("lcp.renderTime",Aa.renderTime),e.setAttribute("lcp.size",Aa.size)),Na?.sources&&t.recordClsOnPageloadSpan&&Na.sources.forEach((t,n)=>e.setAttribute(`cls.source.${n+1}`,E(t.node)))}(e,t)),Aa=void 0,Na=void 0,La={}}(t,{recordClsOnPageloadSpan:!u,recordLcpOnPageloadSpan:!l,ignoreResourceSpans:w,ignorePerformanceApiSpans:k}),ac(e,void 0);const n=Se(),s=n.getPropagationContext();n.setPropagationContext({...s,traceId:m.spanContext().traceId,sampled:tn(m),dsc:gn(t)}),o&&(F=void 0)},trimIdleSpanEndTimestamp:!A});function g(){n&&["interactive","complete"].includes(n.readyState)&&e.emit("idleSpanEnableAutoFinish",m)}o&&A&&(F=m),ac(e,m),o&&!A&&n&&(n.addEventListener("readystatechange",()=>{g()}),g())}return{name:"BrowserTracing",setup(e){if(Ei(),D=Pa({recordClsStandaloneSpans:u||!1,recordLcpStandaloneSpans:l||!1,client:e}),s&&function(){if(Ea()&&ie()){const e=ha(Ua);return()=>{e()}}}(),r&&Ea()&&ie()&&fa("element",Ha),a&&i.PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")?new PerformanceObserver(e=>{const t=un();if(t)for(const n of e.getEntries()){if(!n.scripts[0])continue;const e=Ia(ie()+n.startTime),{start_timestamp:s,op:r}=en(t);if("navigation"===r&&s&&e<s)continue;const o=Ia(n.duration),i={[yt]:"auto.ui.browser.metrics"},a=n.scripts[0],{invoker:c,invokerType:u,sourceURL:l,sourceFunctionName:d,sourceCharPosition:p}=a;i["browser.script.invoker"]=c,i["browser.script.invoker_type"]=u,l&&(i["code.filepath"]=l),d&&(i["code.function"]=d),-1!==p&&(i["browser.script.source_char_position"]=p),xa(t,e,e+o,{name:"Main UI thread blocked",op:"ui.long-animation-frame",attributes:i})}}).observe({type:"long-animation-frame",buffered:!0}):o&&fa("longtask",({entries:e})=>{const t=un();if(!t)return;const{op:n,start_timestamp:s}=en(t);for(const r of e){const e=Ia(ie()+r.startTime),o=Ia(r.duration);"navigation"===n&&s&&e<s||xa(t,e,e+o,{name:"Main UI thread blocked",op:"ui.long-task",attributes:{[yt]:"auto.ui.browser.metrics"}})}}),c&&fa("event",({entries:e})=>{const t=un();if(t)for(const n of e)if("click"===n.name){const e=Ia(ie()+n.startTime),s=Ia(n.duration),r={name:E(n.target),op:`ui.interaction.${n.name}`,startTime:e,attributes:{[yt]:"auto.ui.browser.metrics"}},o=M(n.target);o&&(r.attributes["ui.component_name"]=o),xa(t,e,e+s,r)}}),I&&n){const e=()=>{L=oe()};addEventListener("click",e,{capture:!0}),addEventListener("keydown",e,{capture:!0,passive:!0})}function t(){const t=ic(e);t&&!en(t).timestamp&&(Qr&&P.log(`[Tracing] Finishing current active span with op: ${en(t).op}`),t.setAttribute(bt,"cancelled"),t.end())}e.on("startNavigationSpan",(n,s)=>{if(Ee()!==e)return;if(s?.isRedirect)return Qr&&P.warn("[Tracing] Detected redirect, navigation span will not be the root span, but a child span."),void $(e,{op:"navigation.redirect",...n},!1);L=void 0,t(),we().setPropagationContext({traceId:ue(),sampleRand:Math.random(),propagationSpanId:Ot()?void 0:le()});const r=Se();r.setPropagationContext({traceId:ue(),sampleRand:Math.random(),propagationSpanId:Ot()?void 0:le()}),r.setSDKProcessingMetadata({normalizedRequest:void 0}),$(e,{op:"navigation",...n,parentSpan:null,forceTransaction:!0})}),e.on("startPageLoadSpan",(n,s={})=>{if(Ee()!==e)return;t();const r=zt(s.sentryTrace||rc("sentry-trace"),s.baggage||rc("baggage")),o=Se();o.setPropagationContext(r),Ot()||(o.getPropagationContext().propagationSpanId=le()),o.setSDKProcessingMetadata({normalizedRequest:dr()}),$(e,{op:"pageload",...n})}),e.on("endPageloadSpan",()=>{A&&F&&(F.setAttribute(bt,"reportPageLoaded"),F.end())})},afterAllSetup(e){let n=C();if("off"!==R&&function(e,{linkPreviousTrace:t,consistentTraceSampling:n}){const s="session-storage"===t;let r=s?function(){try{const e=ar.sessionStorage?.getItem(za);return JSON.parse(e)}catch{return}}():void 0;e.on("spanStart",e=>{if(cn(e)!==e)return;const t=Se().getPropagationContext();r=function(e,t,n){const s=en(t),r={spanContext:t.spanContext(),startTimestamp:s.start_timestamp,sampleRate:function(){try{return Number(n.dsc?.sample_rate)??Number(s.data?.[ft])}catch{return 0}}(),sampleRand:n.sampleRand};if(!e)return r;const o=e.spanContext;return o.traceId===s.trace_id?e:(Date.now()/1e3-e.startTimestamp<=3600&&(Qr&&P.log(`Adding previous_trace ${o} link to span ${{op:s.op,...t.spanContext()}}`),t.addLink({context:o,attributes:{[xt]:"previous_trace"}}),t.setAttribute("sentry.previous_trace",`${o.traceId}-${o.spanId}-${qa(o)?1:0}`)),r)}(r,e,t),s&&function(e){try{ar.sessionStorage.setItem(za,JSON.stringify(e))}catch(e){Qr&&P.warn("Could not store previous trace in sessionStorage",e)}}(r)});let o=!0;n&&e.on("beforeSampling",e=>{if(!r)return;const t=Se(),n=t.getPropagationContext();o&&n.parentSpanId?o=!1:(t.setPropagationContext({...n,dsc:{...n.dsc,sample_rate:String(r.sampleRate),sampled:String(qa(r.spanContext))},sampleRand:r.sampleRand}),e.parentSampled=qa(r.spanContext),e.parentSampleRate=r.sampleRate,e.spanAttributes={...e.spanAttributes,[mt]:r.sampleRate})})}(e,{linkPreviousTrace:R,consistentTraceSampling:O}),ar.location){if(x){const t=ie();nc(e,{name:ar.location.pathname,startTime:t?t/1e3:void 0,attributes:{[ht]:"url",[yt]:"auto.pageload.browser"}})}T&&Xr(({to:t,from:s})=>{if(void 0===s&&-1!==n?.indexOf(t))return void(n=void 0);n=void 0;const r=Lr(t),o=ic(e),i=o&&I&&function(e,t){const n=en(e),s=ne();return!(s-n.start_timestamp>cc)&&!(t&&s-t<=cc)}(o,L);sc(e,{name:r?.pathname||ar.location.pathname,attributes:{[ht]:"url",[yt]:"auto.navigation.browser"}},{url:t,isRedirect:i})})}m&&(ar.document?ar.document.addEventListener("visibilitychange",()=>{const e=un();if(!e)return;const t=cn(e);if(ar.document.hidden&&t){const e="cancelled",{op:n,status:s}=en(t);Qr&&P.log(`[Tracing] Transaction: ${e} -> since tab moved to the background, op: ${n}`),s||t.setStatus({code:Dt,message:e}),t.setAttribute("sentry.cancellation_reason","document.hidden"),t.end()}}):Qr&&P.warn("[Tracing] Could not set up background tab detection due to lack of global document")),c&&function(e,t,n,s,r){let o;ar.document&&addEventListener("click",()=>{const i="ui.action.click",a=ic(e);if(a){const e=en(a).op;if(["navigation","pageload"].includes(e))return void(Qr&&P.warn(`[Tracing] Did not create ${i} span because a pageload or navigation span is in progress.`))}o&&(o.setAttribute(bt,"interactionInterrupted"),o.end(),o=void 0),r.name?o=xi({name:r.name,op:i,attributes:{[ht]:r.source||"url"}},{idleTimeout:t,finalTimeout:n,childSpanTimeout:s}):Qr&&P.warn(`[Tracing] Did not create ${i} transaction because _latestRouteName is missing.`)},{capture:!0})}(e,p,h,f,t),s&&function(){const e=({entries:e})=>{const t=un(),n=t&&cn(t);e.forEach(e=>{if(!function(e){return"duration"in e}(e)||!n)return;const t=e.interactionId;if(null!=t&&!ja.has(t)){if($a.length>10){const e=$a.shift();ja.delete(e)}$a.push(t),ja.set(t,n)}})};fa("event",e),fa("first-input",e)}(),Ya(e,{traceFetch:g,traceXHR:b,trackFetchStreamPerformance:v,tracePropagationTargets:e.getOptions().tracePropagationTargets,shouldCreateSpanForRequest:_,enableHTTPTimings:S,onRequestSpanStart:N})}}};function nc(e,t,n){e.emit("startPageLoadSpan",t,n),Se().setTransactionName(t.name);const s=ic(e);return s&&e.emit("afterStartPageLoadSpan",s),s}function sc(e,t,n){const{url:s,isRedirect:r}=n||{};e.emit("beforeStartNavigationSpan",t,{isRedirect:r}),e.emit("startNavigationSpan",t,{isRedirect:r});const o=Se();return o.setTransactionName(t.name),s&&!r&&o.setSDKProcessingMetadata({normalizedRequest:{...dr(),url:s}}),ic(e)}function rc(e){const t=ar.document,n=t?.querySelector(`meta[name=${e}]`);return n?.getAttribute("content")||void 0}const oc="_sentry_idleSpan";function ic(e){return e[oc]}function ac(e,t){z(e,oc,t)}const cc=1.5,uc=1e6,lc=String(0),dc=ar.navigator;let pc="",hc="",fc="",mc=dc?.userAgent||"",gc="";const yc=dc?.language||dc?.languages?.[0]||"",bc=dc?.userAgentData;var vc;function _c(e,t,n,s){if("transaction"!==s.type)throw new TypeError("Profiling events may only be attached to transactions, this should never occur.");if(null==n)throw new TypeError(`Cannot construct profiling event envelope without a valid profile. Got ${n} instead.`);const r=function(e){const t=e.contexts?.trace?.trace_id;return"string"==typeof t&&32!==t.length&&Qr&&P.log(`[Profiling] Invalid traceId: ${t} on profiled event`),"string"!=typeof t?"":t}(s),o=function(e){return!("thread_metadata"in e)}(c=n)?function(e){let t,n=0;const s={samples:[],stacks:[],frames:[],thread_metadata:{[lc]:{name:"main"}}},r=e.samples[0];if(!r)return s;const o=r.timestamp,i=ie(),a="number"==typeof performance.timeOrigin?performance.timeOrigin:i||0,c=a-(i||a);return e.samples.forEach((r,i)=>{if(void 0===r.stackId)return void 0===t&&(t=n,s.stacks[t]=[],n++),void(s.samples[i]={elapsed_since_start_ns:((r.timestamp+c-o)*uc).toFixed(0),stack_id:t,thread_id:lc});let a=e.stacks[r.stackId];const u=[];for(;a;){u.push(a.frameId);const t=e.frames[a.frameId];t&&void 0===s.frames[a.frameId]&&(s.frames[a.frameId]={function:t.name,abs_path:"number"==typeof t.resourceId?e.resources[t.resourceId]:void 0,lineno:t.line,colno:t.column}),a=void 0===a.parentId?void 0:e.stacks[a.parentId]}const l={elapsed_since_start_ns:((r.timestamp+c-o)*uc).toFixed(0),stack_id:n,thread_id:lc};s.stacks[n]=u,s.samples[i]=l,n++}),s}(c):c,i=t||("number"==typeof s.start_timestamp?1e3*s.start_timestamp:1e3*oe()),a="number"==typeof s.timestamp?1e3*s.timestamp:1e3*oe();var c;return{event_id:e,timestamp:new Date(i).toISOString(),platform:"javascript",version:"1",release:s.release||"",environment:s.environment||pt,runtime:{name:"javascript",version:ar.navigator.userAgent},os:{name:pc,version:hc,build_number:mc},device:{locale:yc,model:gc,manufacturer:mc,architecture:fc,is_emulator:!1},debug_meta:{images:wc(n.resources)},profile:o,transactions:[{name:s.transaction||"",id:s.event_id||G(),trace_id:r,active_thread_id:lc,relative_start_ns:"0",relative_end_ns:(1e6*(a-i)).toFixed(0)}]}}function Sc(e){return"pageload"===en(e).op}function wc(e){const t=Ee(),n=t?.getOptions(),s=n?.stackParser;return s?function(e,t){const n=ls(e);if(!n)return[];const s=[];for(const e of t)e&&n[e]&&s.push({type:"sourcemap",code_file:e,debug_id:n[e]});return s}(s,e):[]}"object"==typeof(vc=bc)&&null!==vc&&"getHighEntropyValues"in vc&&bc.getHighEntropyValues(["architecture","model","platform","platformVersion","fullVersionList"]).then(e=>{if(pc=e.platform||"",fc=e.architecture||"",gc=e.model||"",hc=e.platformVersion||"",e.fullVersionList?.length){const t=e.fullVersionList[e.fullVersionList.length-1];mc=`${t.brand} ${t.version}`}}).catch(e=>{});let kc=!1;function xc(e){if(kc)return Qr&&P.log("[Profiling] Profiling has been disabled for the duration of the current user session."),!1;if(!e.isRecording())return Qr&&P.log("[Profiling] Discarding profile because transaction was not sampled."),!1;const t=Ee(),n=t?.getOptions();if(!n)return Qr&&P.log("[Profiling] Profiling disabled, no options found."),!1;const s=n.profilesSampleRate;return("number"!=typeof(r=s)&&"boolean"!=typeof r||"number"==typeof r&&isNaN(r)?(Qr&&P.warn(`[Profiling] Invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(r)} of type ${JSON.stringify(typeof r)}.`),0):!0===r||!1===r||!(r<0||r>1)||(Qr&&P.warn(`[Profiling] Invalid sample rate. Sample rate must be between 0 and 1. Got ${r}.`),0))?s?!!(!0===s||Math.random()<s)||(Qr&&P.log(`[Profiling] Discarding profile because it's not included in the random sample (sampling rate = ${Number(s)})`),!1):(Qr&&P.log("[Profiling] Discarding profile because a negative sampling decision was inherited or profileSampleRate is set to 0"),!1):(Qr&&P.warn("[Profiling] Discarding profile because of invalid sample rate."),!1);var r}function Tc(e,t,n,s){return function(e){return e.samples.length<2?(Qr&&P.log("[Profiling] Discarding profile because it contains less than 2 samples"),!1):!!e.frames.length||(Qr&&P.log("[Profiling] Discarding profile because it contains no frames"),!1)}(n)?_c(e,t,n,s):null}const Ec=new Map;function Ic(e){const t=Ec.get(e);return t&&Ec.delete(e),t}function Cc(e){let t;Sc(e)&&(t=1e3*oe());const n=function(){const e=ar.Profiler;if("function"!=typeof e)return void(Qr&&P.log("[Profiling] Profiling is not supported by this browser, Profiler interface missing on window object."));const t=Math.floor(3e3);try{return new e({sampleInterval:10,maxBufferSize:t})}catch(e){Qr&&(P.log("[Profiling] Failed to initialize the Profiling constructor, this is likely due to a missing 'Document-Policy': 'js-profiling' header."),P.log("[Profiling] Disabling profiling for current user session.")),kc=!0}}();if(!n)return;Qr&&P.log(`[Profiling] started profiling span: ${en(e).description}`);const s=G();async function r(){if(e&&n)return n.stop().then(t=>{o&&(ar.clearTimeout(o),o=void 0),Qr&&P.log(`[Profiling] stopped profiling of span: ${en(e).description}`),t?function(e,t){if(Ec.set(e,t),Ec.size>30){const e=Ec.keys().next().value;Ec.delete(e)}}(s,t):Qr&&P.log(`[Profiling] profiler returned null profile for: ${en(e).description}`,"this may indicate an overlapping span or a call to stopProfiling with a profile title that was never started")}).catch(e=>{Qr&&P.log("[Profiling] error while stopping profiler:",e)})}Se().setContext("profile",{profile_id:s,start_timestamp:t});let o=ar.setTimeout(()=>{Qr&&P.log("[Profiling] max profile duration elapsed, stopping profiling for:",en(e).description),r()},3e4);const i=e.end.bind(e);e.end=function(){return e?(r().then(()=>{i()},()=>{i()}),e):i()}}const Mc=()=>({name:"BrowserProfiling",setup(e){const t=un(),n=t&&cn(t);n&&Sc(n)&&xc(n)&&Cc(n),e.on("spanStart",e=>{e===cn(e)&&xc(e)&&Cc(e)}),e.on("beforeEnvelope",e=>{if(!Ec.size)return;const t=function(e){const t=[];return kn(e,(e,n)=>{if("transaction"===n)for(let n=1;n<e.length;n++){const s=e[n];s?.contexts?.profile?.profile_id&&t.push(e[n])}}),t}(e);if(!t.length)return;const n=[];for(const e of t){const t=e?.contexts,s=t?.profile?.profile_id,r=t?.profile?.start_timestamp;if("string"!=typeof s){Qr&&P.log("[Profiling] cannot find profile for a span without a profile context");continue}if(!s){Qr&&P.log("[Profiling] cannot find profile for a span without a profile context");continue}t?.profile&&delete t.profile;const o=Ic(s);if(!o){Qr&&P.log(`[Profiling] Could not retrieve profile for span: ${s}`);continue}const i=Tc(s,r,o,e);i&&n.push(i)}!function(e,t){if(!t.length)return e;for(const n of t)e[1].push([{type:"profile"},n])}(e,n)})}});function Rc(e,t){const n=t?.getDsn(),s=t?.getOptions().tunnel;return function(e,t){const n=Lr(e);return!(!n||Dr(n))&&(!!t&&n.host.includes(t.host)&&/(^|&|\?)sentry_key=/.test(n.search))}(e,n)||function(e,t){return!!t&&Oc(e)===Oc(t)}(e,s)}function Oc(e){return"/"===e[e.length-1]?e.slice(0,-1):e}function Ac(){return"undefined"!=typeof window&&(!(("undefined"==typeof __SENTRY_BROWSER_BUNDLE__||!__SENTRY_BROWSER_BUNDLE__)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))||function(){const e=i.process;return"renderer"===e?.type}())}function Nc(e){return new URLSearchParams(e).toString()}function Dc(e,t=P){try{if("string"==typeof e)return[e];if(e instanceof URLSearchParams)return[e.toString()];if(e instanceof FormData)return[Nc(e)];if(!e)return[void 0]}catch(n){return Jo&&t.error(n,"Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return Jo&&t.log("Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}function Lc(e=[]){if(2===e.length&&"object"==typeof e[1])return e[1].body}const Pc=i,Fc="sentryReplaySession",$c="Unable to send Replay",jc=15e4,Bc=5e3,Uc=2e7;var Hc=Object.defineProperty,zc=(e,t,n)=>((e,t,n)=>t in e?Hc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n),qc=(e=>(e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment",e))(qc||{});function Wc(e){const t=e?.host;return Boolean(t?.shadowRoot===e)}function Vc(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function Jc(e){try{const n=e.rules||e.cssRules;return n?((t=Array.from(n,Kc).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),t):null}catch(e){return null}var t}function Kc(e){let t;if(function(e){return"styleSheet"in e}(e))try{t=Jc(e.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(e){}else if(function(e){return"selectorText"in e}(e)){let t=e.cssText;const n=e.selectorText.includes(":"),s="string"==typeof e.style.all&&e.style.all;if(s&&(t=function(e){let t="";for(let n=0;n<e.style.length;n++){const s=e.style,r=s[n],o=s.getPropertyPriority(r);t+=`${r}:${s.getPropertyValue(r)}${o?" !important":""};`}return`${e.selectorText} { ${t} }`}(e)),n&&(t=t.replace(/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,"$1\\$2")),n||s)return t}return t||e.cssText}class Gc{constructor(){zc(this,"idNodeMap",new Map),zc(this,"nodeMetaMap",new WeakMap)}getId(e){if(!e)return-1;const t=this.getMeta(e)?.id;return t??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(e=>this.removeNodeFromMap(e))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Xc({maskInputOptions:e,tagName:t,type:n}){return"OPTION"===t&&(t="SELECT"),Boolean(e[t.toLowerCase()]||n&&e[n]||"password"===n||"INPUT"===t&&!n&&e.text)}function Yc({isMasked:e,element:t,value:n,maskInputFn:s}){let r=n||"";return e?(s&&(r=s(r,t)),"*".repeat(r.length)):r}function Qc(e){return e.toLowerCase()}function Zc(e){return e.toUpperCase()}const eu="__rrweb_original__";function tu(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?Qc(t):null}function nu(e,t,n){return"INPUT"!==t||"radio"!==n&&"checkbox"!==n?e.value:e.getAttribute("value")||""}function su(e,t){let n;try{n=new URL(e,t??window.location.href)}catch(e){return null}const s=n.pathname.match(/\.([0-9a-z]+)(?:$)/i);return s?.[1]??null}const ru={};function ou(e){const t=ru[e];if(t)return t;const n=window.document;let s=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const r=t.contentWindow;r&&r[e]&&(s=r[e]),n.head.removeChild(t)}catch(e){}return ru[e]=s.bind(window)}function iu(...e){return ou("setTimeout")(...e)}function au(...e){return ou("clearTimeout")(...e)}function cu(e){try{return e.contentDocument}catch(e){}}let uu=1;const lu=new RegExp("[^a-z0-9-_:]");function du(){return uu++}let pu,hu;const fu=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,mu=/^(?:[a-z+]+:)?\/\//i,gu=/^www\..*/i,yu=/^(data:)([^,]*),(.*)/i;function bu(e,t){return(e||"").replace(fu,(e,n,s,r,o,i)=>{const a=s||o||i,c=n||r||"";if(!a)return e;if(mu.test(a)||gu.test(a))return`url(${c}${a}${c})`;if(yu.test(a))return`url(${c}${a}${c})`;if("/"===a[0])return`url(${c}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+a}${c})`;const u=t.split("/"),l=a.split("/");u.pop();for(const e of l)"."!==e&&(".."===e?u.pop():u.push(e));return`url(${c}${u.join("/")}${c})`})}const vu=/^[^ \t\n\r\u000c]+/,_u=/^[, \t\n\r\u000c]+/,Su=new WeakMap;function wu(e,t){return t&&""!==t.trim()?ku(e,t):t}function ku(e,t){let n=Su.get(e);if(n||(n=e.createElement("a"),Su.set(e,n)),t){if(t.startsWith("blob:")||t.startsWith("data:"))return t}else t="";return n.setAttribute("href",t),n.href}function xu(e,t,n,s,r,o){return s?"src"===n||"href"===n&&("use"!==t||"#"!==s[0])||"xlink:href"===n&&"#"!==s[0]?wu(e,s):"background"!==n||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n?function(e,t){if(""===t.trim())return t;let n=0;function s(e){let s;const r=e.exec(t.substring(n));return r?(s=r[0],n+=s.length,s):""}const r=[];for(;s(_u),!(n>=t.length);){let o=s(vu);if(","===o.slice(-1))o=wu(e,o.substring(0,o.length-1)),r.push(o);else{let s="";o=wu(e,o);let i=!1;for(;;){const e=t.charAt(n);if(""===e){r.push((o+s).trim());break}if(i)")"===e&&(i=!1);else{if(","===e){n+=1,r.push((o+s).trim());break}"("===e&&(i=!0)}s+=e,n+=1}}}return r.join(", ")}(e,s):"style"===n?bu(s,ku(e)):"object"===t&&"data"===n?wu(e,s):"function"==typeof o?o(n,s,r):s:wu(e,s):s}function Tu(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function Eu(e,t,n=1/0,s=0){return e?e.nodeType!==e.ELEMENT_NODE||s>n?-1:t(e)?s:Eu(e.parentNode,t,n,s+1):-1}function Iu(e,t){return n=>{const s=n;if(null===s)return!1;try{if(e)if("string"==typeof e){if(s.matches(`.${e}`))return!0}else if(function(e,t){for(let n=e.classList.length;n--;){const s=e.classList[n];if(t.test(s))return!0}return!1}(s,e))return!0;return!(!t||!s.matches(t))}catch{return!1}}}function Cu(e,t,n,s,r,o){try{const i=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===i)return!1;if("INPUT"===i.tagName){const e=i.getAttribute("autocomplete");if(["current-password","new-password","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc"].includes(e))return!0}let a=-1,c=-1;if(o){if(c=Eu(i,Iu(s,r)),c<0)return!0;a=Eu(i,Iu(t,n),c>=0?c:1/0)}else{if(a=Eu(i,Iu(t,n)),a<0)return!1;c=Eu(i,Iu(s,r),a>=0?a:1/0)}return a>=0?!(c>=0)||a<=c:!(c>=0||!o)}catch(e){}return!!o}function Mu(e){return null==e?"":e.toLowerCase()}function Ru(e,t){const{doc:n,mirror:s,blockClass:r,blockSelector:o,unblockSelector:i,maskAllText:a,maskTextClass:c,unmaskTextClass:u,maskTextSelector:l,unmaskTextSelector:d,skipChild:p=!1,inlineStylesheet:h=!0,maskInputOptions:f={},maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:b,dataURLOptions:v={},inlineImages:_=!1,recordCanvas:S=!1,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:x=5e3,onBlockedImageLoad:T,onStylesheetLoad:E,stylesheetLoadTimeout:I=5e3,keepIframeSrcFn:C=()=>!1,newlyAddedElement:M=!1}=t;let{preserveWhiteSpace:R=!0}=t;const O=function(e,t){const{doc:n,mirror:s,blockClass:r,blockSelector:o,unblockSelector:i,maskAllText:a,maskAttributeFn:c,maskTextClass:u,unmaskTextClass:l,maskTextSelector:d,unmaskTextSelector:p,inlineStylesheet:h,maskInputOptions:f={},maskTextFn:m,maskInputFn:g,dataURLOptions:y={},inlineImages:b,recordCanvas:v,keepIframeSrcFn:_,newlyAddedElement:S=!1}=t,w=function(e,t){if(!t.hasNode(e))return;const n=t.getId(e);return 1===n?void 0:n}(n,s);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:qc.Document,childNodes:[],compatMode:e.compatMode}:{type:qc.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:qc.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:w};case e.ELEMENT_NODE:return function(e,t){const{doc:n,blockClass:s,blockSelector:r,unblockSelector:o,inlineStylesheet:i,maskInputOptions:a={},maskAttributeFn:c,maskInputFn:u,dataURLOptions:l={},inlineImages:d,recordCanvas:p,keepIframeSrcFn:h,newlyAddedElement:f=!1,rootId:m,maskTextClass:g,unmaskTextClass:y,maskTextSelector:b,unmaskTextSelector:v}=t,_=function(e,t,n,s){try{if(s&&e.matches(s))return!1;if("string"==typeof t){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){const s=e.classList[n];if(t.test(s))return!0}if(n)return e.matches(n)}catch(e){}return!1}(e,s,r,o),S=function(e){if(e instanceof HTMLFormElement)return"form";const t=Qc(e.tagName);return lu.test(t)?"div":t}(e);let w={};const k=e.attributes.length;for(let t=0;t<k;t++){const s=e.attributes[t];s.name&&!Tu(S,s.name,s.value)&&(w[s.name]=xu(n,S,Qc(s.name),s.value,e,c))}if("link"===S&&i){const t=Array.from(n.styleSheets).find(t=>t.href===e.href);let s=null;t&&(s=Jc(t)),s&&(w.rel=null,w.href=null,w.crossorigin=null,w._cssText=bu(s,t.href))}if("style"===S&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const t=Jc(e.sheet);t&&(w._cssText=bu(t,ku(n)))}if("input"===S||"textarea"===S||"select"===S||"option"===S){const t=e,n=tu(t),s=nu(t,Zc(S),n),r=t.checked;if("submit"!==n&&"button"!==n&&s){const e=Cu(t,g,b,y,v,Xc({type:n,tagName:Zc(S),maskInputOptions:a}));w.value=Yc({isMasked:e,element:t,value:s,maskInputFn:u})}r&&(w.checked=r)}if("option"===S&&(e.selected&&!a.select?w.selected=!0:delete w.selected),"canvas"===S&&p)if("2d"===e.__context)(function(e){const t=e.getContext("2d");if(!t)return!0;for(let n=0;n<e.width;n+=50)for(let s=0;s<e.height;s+=50){const r=t.getImageData,o=eu in r?r[eu]:r;if(new Uint32Array(o.call(t,n,s,Math.min(50,e.width-n),Math.min(50,e.height-s)).data.buffer).some(e=>0!==e))return!1}return!0})(e)||(w.rr_dataURL=e.toDataURL(l.type,l.quality));else if(!("__context"in e)){const t=e.toDataURL(l.type,l.quality),s=n.createElement("canvas");s.width=e.width,s.height=e.height,t!==s.toDataURL(l.type,l.quality)&&(w.rr_dataURL=t)}if("img"===S&&d){pu||(pu=n.createElement("canvas"),hu=pu.getContext("2d"));const t=e,s=t.currentSrc||t.getAttribute("src")||"<unknown-src>",r=t.crossOrigin,o=()=>{t.removeEventListener("load",o);try{pu.width=t.naturalWidth,pu.height=t.naturalHeight,hu.drawImage(t,0,0),w.rr_dataURL=pu.toDataURL(l.type,l.quality)}catch(e){if("anonymous"!==t.crossOrigin)return t.crossOrigin="anonymous",void(t.complete&&0!==t.naturalWidth?o():t.addEventListener("load",o));console.warn(`Cannot inline img src=${s}! Error: ${e}`)}"anonymous"===t.crossOrigin&&(r?w.crossOrigin=r:t.removeAttribute("crossorigin"))};t.complete&&0!==t.naturalWidth?o():t.addEventListener("load",o)}if("audio"!==S&&"video"!==S||(w.rr_mediaState=e.paused?"paused":"played",w.rr_mediaCurrentTime=e.currentTime),f||(e.scrollLeft&&(w.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(w.rr_scrollTop=e.scrollTop)),_){const{width:t,height:n}=e.getBoundingClientRect();w={class:w.class,rr_width:`${t}px`,rr_height:`${n}px`}}let x;"iframe"!==S||h(w.src)||(_||cu(e)||(w.rr_src=w.src),delete w.src);try{customElements.get(S)&&(x=!0)}catch(e){}return{type:qc.Element,tagName:S,attributes:w,childNodes:[],isSVG:(T=e,Boolean("svg"===T.tagName||T.ownerSVGElement)||void 0),needBlock:_,rootId:m,isCustom:x};var T}(e,{doc:n,blockClass:r,blockSelector:o,unblockSelector:i,inlineStylesheet:h,maskAttributeFn:c,maskInputOptions:f,maskInputFn:g,dataURLOptions:y,inlineImages:b,recordCanvas:v,keepIframeSrcFn:_,newlyAddedElement:S,rootId:w,maskTextClass:u,unmaskTextClass:l,maskTextSelector:d,unmaskTextSelector:p});case e.TEXT_NODE:return function(e,t){const{maskAllText:n,maskTextClass:s,unmaskTextClass:r,maskTextSelector:o,unmaskTextSelector:i,maskTextFn:a,maskInputOptions:c,maskInputFn:u,rootId:l}=t,d=e.parentNode&&e.parentNode.tagName;let p=e.textContent;const h="STYLE"===d||void 0,f="SCRIPT"===d||void 0,m="TEXTAREA"===d||void 0;if(h&&p){try{e.nextSibling||e.previousSibling||e.parentNode.sheet?.cssRules&&(p=Jc(e.parentNode.sheet))}catch(t){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${t}`,e)}p=bu(p,ku(t.doc))}f&&(p="SCRIPT_PLACEHOLDER");const g=Cu(e,s,o,r,i,n);return h||f||m||!p||!g||(p=a?a(p,e.parentElement):p.replace(/[\S]/g,"*")),m&&p&&(c.textarea||g)&&(p=u?u(p,e.parentNode):p.replace(/[\S]/g,"*")),"OPTION"===d&&p&&(p=Yc({isMasked:Cu(e,s,o,r,i,Xc({type:null,tagName:d,maskInputOptions:c})),element:e,value:p,maskInputFn:u})),{type:qc.Text,textContent:p||"",isStyle:h,rootId:l}}(e,{doc:n,maskAllText:a,maskTextClass:u,unmaskTextClass:l,maskTextSelector:d,unmaskTextSelector:p,maskTextFn:m,maskInputOptions:f,maskInputFn:g,rootId:w});case e.CDATA_SECTION_NODE:return{type:qc.CDATA,textContent:"",rootId:w};case e.COMMENT_NODE:return{type:qc.Comment,textContent:e.textContent||"",rootId:w};default:return!1}}(e,{doc:n,mirror:s,blockClass:r,blockSelector:o,maskAllText:a,unblockSelector:i,maskTextClass:c,unmaskTextClass:u,maskTextSelector:l,unmaskTextSelector:d,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,dataURLOptions:v,inlineImages:_,recordCanvas:S,keepIframeSrcFn:C,newlyAddedElement:M});if(!O)return console.warn(e,"not serialized"),null;let A;A=s.hasNode(e)?s.getId(e):!function(e,t){if(t.comment&&e.type===qc.Comment)return!0;if(e.type===qc.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&"js"===su(e.attributes.href)))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(Mu(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===Mu(e.attributes.name)||"icon"===Mu(e.attributes.rel)||"apple-touch-icon"===Mu(e.attributes.rel)||"shortcut icon"===Mu(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&Mu(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(Mu(e.attributes.property).match(/^(og|twitter|fb):/)||Mu(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===Mu(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===Mu(e.attributes.name)||"googlebot"===Mu(e.attributes.name)||"bingbot"===Mu(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===Mu(e.attributes.name)||"generator"===Mu(e.attributes.name)||"framework"===Mu(e.attributes.name)||"publisher"===Mu(e.attributes.name)||"progid"===Mu(e.attributes.name)||Mu(e.attributes.property).match(/^article:/)||Mu(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===Mu(e.attributes.name)||"yandex-verification"===Mu(e.attributes.name)||"csrf-token"===Mu(e.attributes.name)||"p:domain_verify"===Mu(e.attributes.name)||"verify-v1"===Mu(e.attributes.name)||"verification"===Mu(e.attributes.name)||"shopify-checkout-api-token"===Mu(e.attributes.name)))return!0}}return!1}(O,b)&&(R||O.type!==qc.Text||O.isStyle||O.textContent.replace(/^\s+|\s+$/gm,"").length)?du():-2;const N=Object.assign(O,{id:A});if(s.add(e,N),-2===A)return null;w&&w(e);let D=!p;if(N.type===qc.Element){D=D&&!N.needBlock;const t=e.shadowRoot;t&&Vc(t)&&(N.isShadowHost=!0)}if((N.type===qc.Document||N.type===qc.Element)&&D){b.headWhitespace&&N.type===qc.Element&&"head"===N.tagName&&(R=!1);const t={doc:n,mirror:s,blockClass:r,blockSelector:o,maskAllText:a,unblockSelector:i,maskTextClass:c,unmaskTextClass:u,maskTextSelector:l,unmaskTextSelector:d,skipChild:p,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:b,dataURLOptions:v,inlineImages:_,recordCanvas:S,preserveWhiteSpace:R,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:x,onBlockedImageLoad:T,onStylesheetLoad:E,stylesheetLoadTimeout:I,keepIframeSrcFn:C},M=e.childNodes?Array.from(e.childNodes):[];for(const e of M){const n=Ru(e,t);n&&N.childNodes.push(n)}if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(const n of Array.from(e.shadowRoot.childNodes)){const s=Ru(n,t);s&&(Vc(e.shadowRoot)&&(s.isShadow=!0),N.childNodes.push(s))}}if(e.parentNode&&Wc(e.parentNode)&&Vc(e.parentNode)&&(N.isShadow=!0),N.type!==qc.Element||"iframe"!==N.tagName||N.needBlock||function(e,t,n){const s=e.contentWindow;if(!s)return;let r,o=!1;try{r=s.document.readyState}catch(e){return}if("complete"!==r){const s=iu(()=>{o||(t(),o=!0)},n);return void e.addEventListener("load",()=>{au(s),o=!0,t()})}const i="about:blank";if(s.location.href!==i||e.src===i||""===e.src)return iu(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,()=>{const t=cu(e);if(t&&k){const n=Ru(t,{doc:t,mirror:s,blockClass:r,blockSelector:o,unblockSelector:i,maskAllText:a,maskTextClass:c,unmaskTextClass:u,maskTextSelector:l,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:b,dataURLOptions:v,inlineImages:_,recordCanvas:S,preserveWhiteSpace:R,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:x,onStylesheetLoad:E,stylesheetLoadTimeout:I,keepIframeSrcFn:C});n&&k(e,n)}},x),N.type===qc.Element&&"img"===N.tagName&&!e.complete&&N.needBlock){const t=e,n=()=>{if(t.isConnected&&!t.complete&&T)try{const e=t.getBoundingClientRect();e.width>0&&e.height>0&&T(t,N,e)}catch(e){}t.removeEventListener("load",n)};t.isConnected&&t.addEventListener("load",n)}return N.type===qc.Element&&"link"===N.tagName&&"string"==typeof N.attributes.rel&&("stylesheet"===N.attributes.rel||"preload"===N.attributes.rel&&"string"==typeof N.attributes.href&&"css"===su(N.attributes.href))&&function(e,t,n){let s,r=!1;try{s=e.sheet}catch(e){return}if(s)return;const o=iu(()=>{r||(t(),r=!0)},n);e.addEventListener("load",()=>{au(o),r=!0,t()})}(e,()=>{if(E){const t=Ru(e,{doc:n,mirror:s,blockClass:r,blockSelector:o,unblockSelector:i,maskAllText:a,maskTextClass:c,unmaskTextClass:u,maskTextSelector:l,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:b,dataURLOptions:v,inlineImages:_,recordCanvas:S,preserveWhiteSpace:R,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:x,onStylesheetLoad:E,stylesheetLoadTimeout:I,keepIframeSrcFn:C});t&&E(e,t)}},I),N.type===qc.Element&&delete N.needBlock,N}function Ou(e,t,n=document){const s={capture:!0,passive:!0};return n.addEventListener(e,t,s),()=>n.removeEventListener(e,t,s)}const Au="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Nu={map:{},getId:()=>(console.error(Au),-1),getNode:()=>(console.error(Au),null),removeNodeFromMap(){console.error(Au)},has:()=>(console.error(Au),!1),reset(){console.error(Au)}};function Du(e,t,n={}){let s=null,r=0;return function(...o){const i=Date.now();r||!1!==n.leading||(r=i);const a=t-(i-r),c=this;a<=0||a>t?(s&&(function(...e){Zu("clearTimeout")(...e)}(s),s=null),r=i,e.apply(c,o)):s||!1===n.trailing||(s=el(()=>{r=!1===n.leading?0:Date.now(),s=null,e.apply(c,o)},a))}}function Lu(e,t,n,s,r=window){const o=r.Object.getOwnPropertyDescriptor(e,t);return r.Object.defineProperty(e,t,s?n:{set(e){el(()=>{n.set.call(this,e)},0),o&&o.set&&o.set.call(this,e)}}),()=>Lu(e,t,o||{},!0)}function Pu(e,t,n){try{if(!(t in e))return()=>{};const s=e[t],r=n(s);return"function"==typeof r&&(r.prototype=r.prototype||{},Object.defineProperties(r,{__rrweb_original__:{enumerable:!1,value:s}})),e[t]=r,()=>{e[t]=s}}catch{return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Nu=new Proxy(Nu,{get:(e,t,n)=>("map"===t&&console.error(Au),Reflect.get(e,t,n))}));let Fu=Date.now;function $u(e){const t=e.document;return{left:t.scrollingElement?t.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:t?.documentElement.scrollLeft||t?.body?.parentElement?.scrollLeft||t?.body?.scrollLeft||0,top:t.scrollingElement?t.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:t?.documentElement.scrollTop||t?.body?.parentElement?.scrollTop||t?.body?.scrollTop||0}}function ju(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Bu(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Uu(e){if(!e)return null;try{return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}catch(e){return null}}function Hu(e,t,n,s,r){if(!e)return!1;const o=Uu(e);if(!o)return!1;const i=Iu(t,n);if(!r){const e=s&&o.matches(s);return i(o)&&!e}const a=Eu(o,i);let c=-1;return!(a<0)&&(s&&(c=Eu(o,Iu(null,s))),a>-1&&c<0||a<c)}function zu(e,t){return-2===t.getId(e)}function qu(e,t){if(Wc(e))return!1;const n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||qu(e.parentNode,t))}function Wu(e){return Boolean(e.changedTouches)}function Vu(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function Ju(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function Ku(e){return Boolean(e?.shadowRoot)}/[1-9][0-9]{12}/.test(Date.now().toString())||(Fu=()=>(new Date).getTime());class Gu{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){return this.styleIDMap.get(e)??-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function Xu(e){let t=null;return e.getRootNode?.()?.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(t=e.getRootNode().host),t}function Yu(e){const t=e.ownerDocument;return!!t&&(t.contains(e)||function(e){const t=e.ownerDocument;if(!t)return!1;const n=function(e){let t,n=e;for(;t=Xu(n);)n=t;return n}(e);return t.contains(n)}(e))}const Qu={};function Zu(e){const t=Qu[e];if(t)return t;const n=window.document;let s=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const r=t.contentWindow;r&&r[e]&&(s=r[e]),n.head.removeChild(t)}catch(e){}return Qu[e]=s.bind(window)}function el(...e){return Zu("setTimeout")(...e)}var tl=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(tl||{}),nl=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(nl||{}),sl=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(sl||{}),rl=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(rl||{}),ol=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e[e.RateChange=4]="RateChange",e))(ol||{});function il(e){try{return e.contentDocument}catch(e){}}function al(e){return"__ln"in e}class cl{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let n=0;n<e;n++)t=t?.next||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&al(e.previousSibling)){const n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&al(e.nextSibling)&&e.nextSibling.__ln.previous){const n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const ul=(e,t)=>`${e}@${t}`;class ll{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],t=new Set,n=new cl,s=e=>{let t=e,n=-2;for(;-2===n;)t=t&&t.nextSibling,n=t&&this.mirror.getId(t);return n},r=r=>{if(!r.parentNode||!Yu(r))return;const o=Wc(r.parentNode)?this.mirror.getId(Xu(r)):this.mirror.getId(r.parentNode),i=s(r);if(-1===o||-1===i)return n.addNode(r);const a=Ru(r,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{Vu(e,this.mirror)&&!Hu(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)&&this.iframeManager.addIframe(e),Ju(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),Ku(r)&&this.shadowDomManager.addShadowRoot(r.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{Hu(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(this.iframeManager.attachIframe(e,t),e.contentWindow&&this.canvasManager.addWindow(e.contentWindow),this.shadowDomManager.observeAttachShadow(e))},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)},onBlockedImageLoad:(e,t,{width:n,height:s})=>{this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:{style:{width:`${n}px`,height:`${s}px`}}}]})}});a&&(e.push({parentId:o,nextId:i,node:a}),t.add(a.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const e of this.movedSet)pl(this.removes,e,this.mirror)&&!this.movedSet.has(e.parentNode)||r(e);for(const e of this.addedSet)hl(this.droppedSet,e)||pl(this.removes,e,this.mirror)?hl(this.movedSet,e)?r(e):this.droppedSet.add(e):r(e);let o=null;for(;n.length;){let e=null;if(o){const t=this.mirror.getId(o.value.parentNode),n=s(o.value);-1!==t&&-1!==n&&(e=o)}if(!e){let t=n.tail;for(;t;){const n=t;if(t=t.previous,n){const t=this.mirror.getId(n.value.parentNode);if(-1===s(n.value))continue;if(-1!==t){e=n;break}{const t=n.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const s=t.parentNode.host;if(-1!==this.mirror.getId(s)){e=n;break}}}}}}if(!e){for(;n.head;)n.removeNode(n.head.value);break}o=e.previous,n.removeNode(e.value),r(e.value)}const i={texts:this.texts.map(e=>({id:this.mirror.getId(e.node),value:e.value})).filter(e=>!t.has(e.id)).filter(e=>this.mirror.has(e.id)),attributes:this.attributes.map(e=>{const{attributes:t}=e;if("string"==typeof t.style){const n=JSON.stringify(e.styleDiff),s=JSON.stringify(e._unchangedStyles);n.length<t.style.length&&(n+s).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}}).filter(e=>!t.has(e.id)).filter(e=>this.mirror.has(e.id)),removes:this.removes,adds:e};(i.texts.length||i.attributes.length||i.removes.length||i.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(i))},this.processMutation=e=>{if(!zu(e.target,this.mirror))switch(e.type){case"characterData":{const t=e.target.textContent;Hu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||t===e.oldValue||this.texts.push({value:Cu(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&t?this.maskTextFn?this.maskTextFn(t,Uu(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const t=e.target;let n=e.attributeName,s=e.target.getAttribute(n);if("value"===n){const n=tu(t),r=t.tagName;s=nu(t,r,n);const o=Xc({maskInputOptions:this.maskInputOptions,tagName:r,type:n});s=Yc({isMasked:Cu(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,o),element:t,value:s,maskInputFn:this.maskInputFn})}if(Hu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||s===e.oldValue)return;let r=this.attributeMap.get(e.target);if("IFRAME"===t.tagName&&"src"===n&&!this.keepIframeSrcFn(s)){if(il(t))return;n="rr_src"}if(r||(r={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(r),this.attributeMap.set(e.target,r)),"type"===n&&"INPUT"===t.tagName&&"password"===(e.oldValue||"").toLowerCase()&&t.setAttribute("data-rr-is-password","true"),!Tu(t.tagName,n)&&(r.attributes[n]=xu(this.doc,Qc(t.tagName),Qc(n),s,t,this.maskAttributeFn),"style"===n)){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(e){this.unattachedDoc=this.doc}const n=this.unattachedDoc.createElement("span");e.oldValue&&n.setAttribute("style",e.oldValue);for(const e of Array.from(t.style)){const s=t.style.getPropertyValue(e),o=t.style.getPropertyPriority(e);s!==n.style.getPropertyValue(e)||o!==n.style.getPropertyPriority(e)?r.styleDiff[e]=""===o?s:[s,o]:r._unchangedStyles[e]=[s,o]}for(const e of Array.from(n.style))""===t.style.getPropertyValue(e)&&(r.styleDiff[e]=!1)}break}case"childList":if(Hu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;e.addedNodes.forEach(t=>this.genAdds(t,e.target)),e.removedNodes.forEach(t=>{const n=this.mirror.getId(t),s=Wc(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);Hu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||zu(t,this.mirror)||!function(e,t){return-1!==t.getId(e)}(t,this.mirror)||(this.addedSet.has(t)?(dl(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===n||qu(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[ul(n,s)]?dl(this.movedSet,t):this.removes.push({parentId:s,id:n,isShadow:!(!Wc(e.target)||!Vc(e.target))||void 0})),this.mapRemoves.push(t))})}},this.genAdds=(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!this.addedSet.has(e)&&!this.movedSet.has(e)){if(this.mirror.hasNode(e)){if(zu(e,this.mirror))return;this.movedSet.add(e);let n=null;t&&this.mirror.hasNode(t)&&(n=this.mirror.getId(t)),n&&-1!==n&&(this.movedMap[ul(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);Hu(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(e.childNodes&&e.childNodes.forEach(e=>this.genAdds(e)),Ku(e)&&e.shadowRoot.childNodes.forEach(t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(t=>{this[t]=e[t]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function dl(e,t){e.delete(t),t.childNodes?.forEach(t=>dl(e,t))}function pl(e,t,n){return 0!==e.length&&function(e,t,n){let s=t.parentNode;for(;s;){const t=n.getId(s);if(e.some(e=>e.id===t))return!0;s=s.parentNode}return!1}(e,t,n)}function hl(e,t){return 0!==e.size&&fl(e,t)}function fl(e,t){const{parentNode:n}=t;return!!n&&(!!e.has(n)||fl(e,n))}let ml;const gl=e=>ml?(...t)=>{try{return e(...t)}catch(e){if(ml&&!0===ml(e))return()=>{};throw e}}:e,yl=[];function bl(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function vl(e,t){const n=new ll;yl.push(n),n.init(e);let s=window.MutationObserver||window.__rrMutationObserver;const r=window?.Zone?.__symbol__?.("MutationObserver");r&&window[r]&&(s=window[r]);const o=new s(gl(t=>{e.onMutation&&!1===e.onMutation(t)||n.processMutations.bind(n)(t)}));return o.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),o}function _l({scrollCb:e,doc:t,mirror:n,blockClass:s,blockSelector:r,unblockSelector:o,sampling:i}){return Ou("scroll",gl(Du(gl(i=>{const a=bl(i);if(!a||Hu(a,s,r,o,!0))return;const c=n.getId(a);if(a===t&&t.defaultView){const n=$u(t.defaultView);e({id:c,x:n.left,y:n.top})}else e({id:c,x:a.scrollLeft,y:a.scrollTop})}),i.scroll||100)),t)}const Sl=["INPUT","TEXTAREA","SELECT"],wl=new WeakMap;function kl({inputCb:e,doc:t,mirror:n,blockClass:s,blockSelector:r,unblockSelector:o,ignoreClass:i,ignoreSelector:a,maskInputOptions:c,maskInputFn:u,sampling:l,userTriggeredOnInput:d,maskTextClass:p,unmaskTextClass:h,maskTextSelector:f,unmaskTextSelector:m}){function g(e){let n=bl(e);const l=e.isTrusted,g=n&&Zc(n.tagName);if("OPTION"===g&&(n=n.parentElement),!n||!g||Sl.indexOf(g)<0||Hu(n,s,r,o,!0))return;const b=n;if(b.classList.contains(i)||a&&b.matches(a))return;const v=tu(n);let _=nu(b,g,v),S=!1;const w=Xc({maskInputOptions:c,tagName:g,type:v}),k=Cu(n,p,f,h,m,w);"radio"!==v&&"checkbox"!==v||(S=n.checked),_=Yc({isMasked:k,element:n,value:_,maskInputFn:u}),y(n,d?{text:_,isChecked:S,userTriggered:l}:{text:_,isChecked:S});const x=n.name;"radio"===v&&x&&S&&t.querySelectorAll(`input[type="radio"][name="${x}"]`).forEach(e=>{if(e!==n){const t=Yc({isMasked:k,element:e,value:nu(e,g,v),maskInputFn:u});y(e,d?{text:t,isChecked:!S,userTriggered:!1}:{text:t,isChecked:!S})}})}function y(t,s){const r=wl.get(t);if(!r||r.text!==s.text||r.isChecked!==s.isChecked){wl.set(t,s);const r=n.getId(t);gl(e)({...s,id:r})}}const b=("last"===l.input?["change"]:["input","change"]).map(e=>Ou(e,gl(g),t)),v=t.defaultView;if(!v)return()=>{b.forEach(e=>e())};const _=v.Object.getOwnPropertyDescriptor(v.HTMLInputElement.prototype,"value"),S=[[v.HTMLInputElement.prototype,"value"],[v.HTMLInputElement.prototype,"checked"],[v.HTMLSelectElement.prototype,"value"],[v.HTMLTextAreaElement.prototype,"value"],[v.HTMLSelectElement.prototype,"selectedIndex"],[v.HTMLOptionElement.prototype,"selected"]];return _&&_.set&&b.push(...S.map(e=>Lu(e[0],e[1],{set(){gl(g)({target:this,isTrusted:!1})}},!1,v))),gl(()=>{b.forEach(e=>e())})}function xl(e){return function(e,t){if(Cl("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||Cl("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||Cl("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||Cl("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){const n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else if(e.parentStyleSheet){const n=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(n)}return t}(e,[])}function Tl(e,t,n){let s,r;return e?(e.ownerNode?s=t.getId(e.ownerNode):r=n.getId(e),{styleId:r,id:s}):{}}function El({mirror:e,stylesheetManager:t},n){let s=null;s="#document"===n.nodeName?e.getId(n):e.getId(n.host);const r="#document"===n.nodeName?n.defaultView?.Document:n.ownerDocument?.defaultView?.ShadowRoot,o=r?.prototype?Object.getOwnPropertyDescriptor(r?.prototype,"adoptedStyleSheets"):void 0;return null!==s&&-1!==s&&r&&o?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:o.configurable,enumerable:o.enumerable,get(){return o.get?.call(this)},set(e){const n=o.set?.call(this,e);if(null!==s&&-1!==s)try{t.adoptStyleSheets(e,s)}catch(e){}return n}}),gl(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:o.configurable,enumerable:o.enumerable,get:o.get,set:o.set})})):()=>{}}function Il(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};let s;e.recordDOM&&(s=vl(e,e.doc));const r=function({mousemoveCb:e,sampling:t,doc:n,mirror:s}){if(!1===t.mousemove)return()=>{};const r="number"==typeof t.mousemove?t.mousemove:50,o="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500;let i,a=[];const c=Du(gl(t=>{const n=Date.now()-i;e(a.map(e=>(e.timeOffset-=n,e)),t),a=[],i=null}),o),u=gl(Du(gl(e=>{const t=bl(e),{clientX:n,clientY:r}=Wu(e)?e.changedTouches[0]:e;i||(i=Fu()),a.push({x:n,y:r,id:s.getId(t),timeOffset:Fu()-i}),c("undefined"!=typeof DragEvent&&e instanceof DragEvent?nl.Drag:e instanceof MouseEvent?nl.MouseMove:nl.TouchMove)}),r,{trailing:!1})),l=[Ou("mousemove",u,n),Ou("touchmove",u,n),Ou("drag",u,n)];return gl(()=>{l.forEach(e=>e())})}(e),o=function({mouseInteractionCb:e,doc:t,mirror:n,blockClass:s,blockSelector:r,unblockSelector:o,sampling:i}){if(!1===i.mouseInteraction)return()=>{};const a=!0===i.mouseInteraction||void 0===i.mouseInteraction?{}:i.mouseInteraction,c=[];let u=null;return Object.keys(sl).filter(e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==a[e]).forEach(i=>{let a=Qc(i);const l=(t=>i=>{const a=bl(i);if(Hu(a,s,r,o,!0))return;let c=null,l=t;if("pointerType"in i){switch(i.pointerType){case"mouse":c=rl.Mouse;break;case"touch":c=rl.Touch;break;case"pen":c=rl.Pen}c===rl.Touch?sl[t]===sl.MouseDown?l="TouchStart":sl[t]===sl.MouseUp&&(l="TouchEnd"):rl.Pen}else Wu(i)&&(c=rl.Touch);null!==c?(u=c,(l.startsWith("Touch")&&c===rl.Touch||l.startsWith("Mouse")&&c===rl.Mouse)&&(c=null)):sl[t]===sl.Click&&(c=u,u=null);const d=Wu(i)?i.changedTouches[0]:i;if(!d)return;const p=n.getId(a),{clientX:h,clientY:f}=d;gl(e)({type:sl[l],id:p,x:h,y:f,...null!==c&&{pointerType:c}})})(i);if(window.PointerEvent)switch(sl[i]){case sl.MouseDown:case sl.MouseUp:a=a.replace("mouse","pointer");break;case sl.TouchStart:case sl.TouchEnd:return}c.push(Ou(a,l,t))}),gl(()=>{c.forEach(e=>e())})}(e),i=_l(e),a=function({viewportResizeCb:e},{win:t}){let n=-1,s=-1;return Ou("resize",gl(Du(gl(()=>{const t=ju(),r=Bu();n===t&&s===r||(e({width:Number(r),height:Number(t)}),n=t,s=r)}),200)),t)}(e,{win:n}),c=kl(e),u=function({mediaInteractionCb:e,blockClass:t,blockSelector:n,unblockSelector:s,mirror:r,sampling:o,doc:i}){const a=gl(i=>Du(gl(o=>{const a=bl(o);if(!a||Hu(a,t,n,s,!0))return;const{currentTime:c,volume:u,muted:l,playbackRate:d}=a;e({type:i,id:r.getId(a),currentTime:c,volume:u,muted:l,playbackRate:d})}),o.media||500)),c=[Ou("play",a(ol.Play),i),Ou("pause",a(ol.Pause),i),Ou("seeked",a(ol.Seeked),i),Ou("volumechange",a(ol.VolumeChange),i),Ou("ratechange",a(ol.RateChange),i)];return gl(()=>{c.forEach(e=>e())})}(e);let l=()=>{},d=()=>{},p=()=>{},h=()=>{};e.recordDOM&&(l=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:s}){if(!s.CSSStyleSheet||!s.CSSStyleSheet.prototype)return()=>{};const r=s.CSSStyleSheet.prototype.insertRule;s.CSSStyleSheet.prototype.insertRule=new Proxy(r,{apply:gl((s,r,o)=>{const[i,a]=o,{id:c,styleId:u}=Tl(r,t,n.styleMirror);return(c&&-1!==c||u&&-1!==u)&&e({id:c,styleId:u,adds:[{rule:i,index:a}]}),s.apply(r,o)})});const o=s.CSSStyleSheet.prototype.deleteRule;let i,a;s.CSSStyleSheet.prototype.deleteRule=new Proxy(o,{apply:gl((s,r,o)=>{const[i]=o,{id:a,styleId:c}=Tl(r,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:i}]}),s.apply(r,o)})}),s.CSSStyleSheet.prototype.replace&&(i=s.CSSStyleSheet.prototype.replace,s.CSSStyleSheet.prototype.replace=new Proxy(i,{apply:gl((s,r,o)=>{const[i]=o,{id:a,styleId:c}=Tl(r,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replace:i}),s.apply(r,o)})})),s.CSSStyleSheet.prototype.replaceSync&&(a=s.CSSStyleSheet.prototype.replaceSync,s.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:gl((s,r,o)=>{const[i]=o,{id:a,styleId:c}=Tl(r,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replaceSync:i}),s.apply(r,o)})}));const c={};Ml("CSSGroupingRule")?c.CSSGroupingRule=s.CSSGroupingRule:(Ml("CSSMediaRule")&&(c.CSSMediaRule=s.CSSMediaRule),Ml("CSSConditionRule")&&(c.CSSConditionRule=s.CSSConditionRule),Ml("CSSSupportsRule")&&(c.CSSSupportsRule=s.CSSSupportsRule));const u={};return Object.entries(c).forEach(([s,r])=>{u[s]={insertRule:r.prototype.insertRule,deleteRule:r.prototype.deleteRule},r.prototype.insertRule=new Proxy(u[s].insertRule,{apply:gl((s,r,o)=>{const[i,a]=o,{id:c,styleId:u}=Tl(r.parentStyleSheet,t,n.styleMirror);return(c&&-1!==c||u&&-1!==u)&&e({id:c,styleId:u,adds:[{rule:i,index:[...xl(r),a||0]}]}),s.apply(r,o)})}),r.prototype.deleteRule=new Proxy(u[s].deleteRule,{apply:gl((s,r,o)=>{const[i]=o,{id:a,styleId:c}=Tl(r.parentStyleSheet,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:[...xl(r),i]}]}),s.apply(r,o)})})}),gl(()=>{s.CSSStyleSheet.prototype.insertRule=r,s.CSSStyleSheet.prototype.deleteRule=o,i&&(s.CSSStyleSheet.prototype.replace=i),a&&(s.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach(([e,t])=>{t.prototype.insertRule=u[e].insertRule,t.prototype.deleteRule=u[e].deleteRule})})}(e,{win:n}),d=El(e,e.doc),p=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:s},{win:r}){const o=r.CSSStyleDeclaration.prototype.setProperty;r.CSSStyleDeclaration.prototype.setProperty=new Proxy(o,{apply:gl((r,i,a)=>{const[c,u,l]=a;if(n.has(c))return o.apply(i,[c,u,l]);const{id:d,styleId:p}=Tl(i.parentRule?.parentStyleSheet,t,s.styleMirror);return(d&&-1!==d||p&&-1!==p)&&e({id:d,styleId:p,set:{property:c,value:u,priority:l},index:xl(i.parentRule)}),r.apply(i,a)})});const i=r.CSSStyleDeclaration.prototype.removeProperty;return r.CSSStyleDeclaration.prototype.removeProperty=new Proxy(i,{apply:gl((r,o,a)=>{const[c]=a;if(n.has(c))return i.apply(o,[c]);const{id:u,styleId:l}=Tl(o.parentRule?.parentStyleSheet,t,s.styleMirror);return(u&&-1!==u||l&&-1!==l)&&e({id:u,styleId:l,remove:{property:c},index:xl(o.parentRule)}),r.apply(o,a)})}),gl(()=>{r.CSSStyleDeclaration.prototype.setProperty=o,r.CSSStyleDeclaration.prototype.removeProperty=i})}(e,{win:n}),e.collectFonts&&(h=function({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const s=[],r=new WeakMap,o=n.FontFace;n.FontFace=function(e,t,n){const s=new o(e,t,n);return r.set(s,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),s};const i=Pu(t.fonts,"add",function(t){return function(n){return el(gl(()=>{const t=r.get(n);t&&(e(t),r.delete(n))}),0),t.apply(this,[n])}});return s.push(()=>{n.FontFace=o}),s.push(i),gl(()=>{s.forEach(e=>e())})}(e)));const f=function(e){const{doc:t,mirror:n,blockClass:s,blockSelector:r,unblockSelector:o,selectionCb:i}=e;let a=!0;const c=gl(()=>{const e=t.getSelection();if(!e||a&&e?.isCollapsed)return;a=e.isCollapsed||!1;const c=[],u=e.rangeCount||0;for(let t=0;t<u;t++){const i=e.getRangeAt(t),{startContainer:a,startOffset:u,endContainer:l,endOffset:d}=i;Hu(a,s,r,o,!0)||Hu(l,s,r,o,!0)||c.push({start:n.getId(a),startOffset:u,end:n.getId(l),endOffset:d})}i({ranges:c})});return c(),Ou("selectionchange",c)}(e),m=function({doc:e,customElementCb:t}){const n=e.defaultView;return n&&n.customElements?Pu(n.customElements,"define",function(e){return function(n,s,r){try{t({define:{name:n}})}catch(e){}return e.apply(this,[n,s,r])}}):()=>{}}(e),g=[];for(const t of e.plugins)g.push(t.observer(t.callback,n,t.options));return gl(()=>{yl.forEach(e=>e.reset()),s?.disconnect(),r(),o(),i(),a(),c(),u(),l(),d(),p(),h(),f(),m(),g.forEach(e=>e())})}function Cl(e){return void 0!==window[e]}function Ml(e){return Boolean(void 0!==window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class Rl{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,n,s){const r=n||this.getIdToRemoteIdMap(e),o=s||this.getRemoteIdToIdMap(e);let i=r.get(t);return i||(i=this.generateIdFn(),r.set(t,i),o.set(i,t)),i}getIds(e,t){const n=this.getIdToRemoteIdMap(e),s=this.getRemoteIdToIdMap(e);return t.map(t=>this.getId(e,t,n,s))}getRemoteId(e,t,n){const s=n||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;return s.get(t)||-1}getRemoteIds(e,t){const n=this.getRemoteIdToIdMap(e);return t.map(t=>this.getRemoteId(e,t,n))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class Ol{constructor(){this.crossOriginIframeMirror=new Rl(du),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class Al{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Rl(du),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Rl(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&e.contentWindow?.addEventListener("message",this.handleMessage.bind(this)),this.loadListener?.(e);const n=il(e);n&&n.adoptedStyleSheets&&n.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(n.adoptedStyleSheets,this.mirror.getId(n))}handleMessage(e){const t=e;if("rrweb"!==t.data.type||t.origin!==t.data.origin)return;if(!e.source)return;const n=this.crossOriginIframeMap.get(e.source);if(!n)return;const s=this.transformCrossOriginEvent(n,t.data.event);s&&this.wrappedEmit(s,t.data.isCheckout)}transformCrossOriginEvent(e,t){switch(t.type){case tl.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);const n=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,n),this.patchRootIdOnNode(t.data.node,n),{timestamp:t.timestamp,type:tl.IncrementalSnapshot,data:{source:nl.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case tl.Meta:case tl.Load:case tl.DomContentLoaded:return!1;case tl.Plugin:return t;case tl.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case tl.IncrementalSnapshot:switch(t.data.source){case nl.Mutation:return t.data.adds.forEach(t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);const n=this.crossOriginIframeRootIdMap.get(e);n&&this.patchRootIdOnNode(t.node,n)}),t.data.removes.forEach(t=>{this.replaceIds(t,e,["parentId","id"])}),t.data.attributes.forEach(t=>{this.replaceIds(t,e,["id"])}),t.data.texts.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case nl.Drag:case nl.TouchMove:case nl.MouseMove:return t.data.positions.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case nl.ViewportResize:return!1;case nl.MediaInteraction:case nl.MouseInteraction:case nl.Scroll:case nl.CanvasMutation:case nl.Input:return this.replaceIds(t.data,e,["id"]),t;case nl.StyleSheetRule:case nl.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case nl.Font:return t;case nl.Selection:return t.data.ranges.forEach(t=>{this.replaceIds(t,e,["start","end"])}),t;case nl.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),t.data.styles?.forEach(t=>{this.replaceStyleIds(t,e,["styleId"])}),t}}return!1}replace(e,t,n,s){for(const r of s)(Array.isArray(t[r])||"number"==typeof t[r])&&(Array.isArray(t[r])?t[r]=e.getIds(n,t[r]):t[r]=e.getId(n,t[r]));return t}replaceIds(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}replaceStyleIds(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(e=>{this.replaceIdOnNode(e,t)})}patchRootIdOnNode(e,t){e.type===qc.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach(e=>{this.patchRootIdOnNode(e,t)})}}class Nl{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class Dl{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!Vc(e))return;if(this.shadowDoms.has(e))return;this.shadowDoms.add(e),this.bypassOptions.canvasManager.addShadowRoot(e);const n=vl({...this.bypassOptions,doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},e);this.restoreHandlers.push(()=>n.disconnect()),this.restoreHandlers.push(_l({...this.bypassOptions,scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),el(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(El({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){const t=il(e),n=function(e){try{return e.contentWindow}catch(e){}}(e);t&&n&&this.patchAttachShadow(n.Element,t)}patchAttachShadow(e,t){const n=this;this.restoreHandlers.push(Pu(e.prototype,"attachShadow",function(e){return function(s){const r=e.call(this,s);return this.shadowRoot&&Yu(this)&&n.addShadowRoot(this.shadowRoot,t),r}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch(e){}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet,this.bypassOptions.canvasManager.resetShadowRoots()}}for(var Ll="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Pl=0;Pl<64;Pl++)Ll["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(Pl)]=Pl;class Fl{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}snapshot(){}addWindow(){}addShadowRoot(){}resetShadowRoots(){}}class $l{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new Gu,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const n={id:t,styleIds:[]},s=[];for(const t of e){let e;this.styleMirror.has(t)?e=this.styleMirror.getId(t):(e=this.styleMirror.add(t),s.push({styleId:e,rules:Array.from(t.rules||CSSRule,(e,t)=>({rule:Kc(e),index:t}))})),n.styleIds.push(e)}s.length>0&&(n.styles=s),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class jl{constructor(){this.nodeMap=new WeakMap,this.active=!1}inOtherBuffer(e,t){const n=this.nodeMap.get(e);return n&&Array.from(n).some(e=>e!==t)}add(e,t){this.active||(this.active=!0,function(...e){Zu("requestAnimationFrame")(...e)}(()=>{this.nodeMap=new WeakMap,this.active=!1})),this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}destroy(){}}let Bl,Ul;try{if(2!==Array.from([1],e=>2*e)[0]){const e=document.createElement("iframe");document.body.appendChild(e),Array.from=e.contentWindow?.Array.from||Array.from,document.body.removeChild(e)}}catch(yb){console.debug("Unable to override Array.from",yb)}const Hl=new Gc;function zl(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:s,blockClass:r="rr-block",blockSelector:o=null,unblockSelector:i=null,ignoreClass:a="rr-ignore",ignoreSelector:c=null,maskAllText:u=!1,maskTextClass:l="rr-mask",unmaskTextClass:d=null,maskTextSelector:p=null,unmaskTextSelector:h=null,inlineStylesheet:f=!0,maskAllInputs:m,maskInputOptions:g,slimDOMOptions:y,maskAttributeFn:b,maskInputFn:v,maskTextFn:_,maxCanvasSize:S=null,packFn:w,sampling:k={},dataURLOptions:x={},mousemoveWait:T,recordDOM:E=!0,recordCanvas:I=!1,recordCrossOriginIframes:C=!1,recordAfter:M=("DOMContentLoaded"===e.recordAfter?e.recordAfter:"load"),userTriggeredOnInput:R=!1,collectFonts:O=!1,inlineImages:A=!1,plugins:N,keepIframeSrcFn:D=()=>!1,ignoreCSSAttributes:L=new Set([]),errorHandler:P,onMutation:F,getCanvasManager:$}=e;ml=P;const j=!C||window.parent===window;let B=!1;if(!j)try{window.parent.document&&(B=!1)}catch(e){B=!0}if(j&&!t)throw new Error("emit function is required");if(!j&&!B)return()=>{};void 0!==T&&void 0===k.mousemove&&(k.mousemove=T),Hl.reset();const U=!0===m?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:void 0!==g?g:{},H=!0===y||"all"===y?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===y,headMetaDescKeywords:"all"===y}:y||{};let z;!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let q=0;const W=e=>{for(const t of N||[])t.eventProcessor&&(e=t.eventProcessor(e));return w&&!B&&(e=w(e)),e};Bl=(e,r)=>{const o=e;if(o.timestamp=Fu(),!yl[0]?.isFrozen()||o.type===tl.FullSnapshot||o.type===tl.IncrementalSnapshot&&o.data.source===nl.Mutation||yl.forEach(e=>e.unfreeze()),j)t?.(W(o),r);else if(B){const e={type:"rrweb",event:W(o),origin:window.location.origin,isCheckout:r};window.parent.postMessage(e,"*")}if(o.type===tl.FullSnapshot)z=o,q=0;else if(o.type===tl.IncrementalSnapshot){if(o.data.source===nl.Mutation&&o.data.isAttachIframe)return;q++;const e=s&&q>=s,t=n&&z&&o.timestamp-z.timestamp>n;(e||t)&&ee(!0)}};const V=e=>{Bl({type:tl.IncrementalSnapshot,data:{source:nl.Mutation,...e}})},J=e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.Scroll,...e}}),K=e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.CanvasMutation,...e}}),G=new $l({mutationCb:V,adoptedStyleSheetCb:e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.AdoptedStyleSheet,...e}})}),X="boolean"==typeof __RRWEB_EXCLUDE_IFRAME__&&__RRWEB_EXCLUDE_IFRAME__?new Ol:new Al({mirror:Hl,mutationCb:V,stylesheetManager:G,recordCrossOriginIframes:C,wrappedEmit:Bl});for(const e of N||[])e.getMirror&&e.getMirror({nodeMirror:Hl,crossOriginIframeMirror:X.crossOriginIframeMirror,crossOriginIframeStyleMirror:X.crossOriginIframeStyleMirror});const Y=new jl,Q=function(e,t){try{return e?e(t):new Fl}catch{return console.warn("Unable to initialize CanvasManager"),new Fl}}($,{mirror:Hl,win:window,mutationCb:e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.CanvasMutation,...e}}),recordCanvas:I,blockClass:r,blockSelector:o,unblockSelector:i,maxCanvasSize:S,sampling:k.canvas,dataURLOptions:x,errorHandler:P}),Z="boolean"==typeof __RRWEB_EXCLUDE_SHADOW_DOM__&&__RRWEB_EXCLUDE_SHADOW_DOM__?new Nl:new Dl({mutationCb:V,scrollCb:J,bypassOptions:{onMutation:F,blockClass:r,blockSelector:o,unblockSelector:i,maskAllText:u,maskTextClass:l,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,inlineStylesheet:f,maskInputOptions:U,dataURLOptions:x,maskAttributeFn:b,maskTextFn:_,maskInputFn:v,recordCanvas:I,inlineImages:A,sampling:k,slimDOMOptions:H,iframeManager:X,stylesheetManager:G,canvasManager:Q,keepIframeSrcFn:D,processedNodeManager:Y},mirror:Hl}),ee=(e=!1)=>{if(!E)return;Bl({type:tl.Meta,data:{href:window.location.href,width:Bu(),height:ju()}},e),G.reset(),Z.init(),yl.forEach(e=>e.lock());const t=function(e,t){const{mirror:n=new Gc,blockClass:s="rr-block",blockSelector:r=null,unblockSelector:o=null,maskAllText:i=!1,maskTextClass:a="rr-mask",unmaskTextClass:c=null,maskTextSelector:u=null,unmaskTextSelector:l=null,inlineStylesheet:d=!0,inlineImages:p=!1,recordCanvas:h=!1,maskAllInputs:f=!1,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOM:b=!1,dataURLOptions:v,preserveWhiteSpace:_,onSerialize:S,onIframeLoad:w,iframeLoadTimeout:k,onBlockedImageLoad:x,onStylesheetLoad:T,stylesheetLoadTimeout:E,keepIframeSrcFn:I=()=>!1}=t||{};return Ru(e,{doc:e,mirror:n,blockClass:s,blockSelector:r,unblockSelector:o,maskAllText:i,maskTextClass:a,unmaskTextClass:c,maskTextSelector:u,unmaskTextSelector:l,skipChild:!1,inlineStylesheet:d,maskInputOptions:!0===f?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:!1===f?{}:f,maskAttributeFn:m,maskTextFn:g,maskInputFn:y,slimDOMOptions:!0===b||"all"===b?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===b,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===b?{}:b,dataURLOptions:v,inlineImages:p,recordCanvas:h,preserveWhiteSpace:_,onSerialize:S,onIframeLoad:w,iframeLoadTimeout:k,onBlockedImageLoad:x,onStylesheetLoad:T,stylesheetLoadTimeout:E,keepIframeSrcFn:I,newlyAddedElement:!1})}(document,{mirror:Hl,blockClass:r,blockSelector:o,unblockSelector:i,maskAllText:u,maskTextClass:l,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,inlineStylesheet:f,maskAllInputs:U,maskAttributeFn:b,maskInputFn:v,maskTextFn:_,slimDOM:H,dataURLOptions:x,recordCanvas:I,inlineImages:A,onSerialize:e=>{Vu(e,Hl)&&X.addIframe(e),Ju(e,Hl)&&G.trackLinkElement(e),Ku(e)&&Z.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{X.attachIframe(e,t),e.contentWindow&&Q.addWindow(e.contentWindow),Z.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{G.attachLinkElement(e,t)},onBlockedImageLoad:(e,t,{width:n,height:s})=>{V({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:{style:{width:`${n}px`,height:`${s}px`}}}]})},keepIframeSrcFn:D});if(!t)return console.warn("Failed to snapshot the document");Bl({type:tl.FullSnapshot,data:{node:t,initialOffset:$u(window)}}),yl.forEach(e=>e.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&G.adoptStyleSheets(document.adoptedStyleSheets,Hl.getId(document))};Ul=ee;try{const e=[],t=e=>gl(Il)({onMutation:F,mutationCb:V,mousemoveCb:(e,t)=>Bl({type:tl.IncrementalSnapshot,data:{source:t,positions:e}}),mouseInteractionCb:e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.MouseInteraction,...e}}),scrollCb:J,viewportResizeCb:e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.ViewportResize,...e}}),inputCb:e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.Input,...e}}),mediaInteractionCb:e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.MediaInteraction,...e}}),styleSheetRuleCb:e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.StyleSheetRule,...e}}),styleDeclarationCb:e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.StyleDeclaration,...e}}),canvasMutationCb:K,fontCb:e=>Bl({type:tl.IncrementalSnapshot,data:{source:nl.Font,...e}}),selectionCb:e=>{Bl({type:tl.IncrementalSnapshot,data:{source:nl.Selection,...e}})},customElementCb:e=>{Bl({type:tl.IncrementalSnapshot,data:{source:nl.CustomElement,...e}})},blockClass:r,ignoreClass:a,ignoreSelector:c,maskAllText:u,maskTextClass:l,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,maskInputOptions:U,inlineStylesheet:f,sampling:k,recordDOM:E,recordCanvas:I,inlineImages:A,userTriggeredOnInput:R,collectFonts:O,doc:e,maskAttributeFn:b,maskInputFn:v,maskTextFn:_,keepIframeSrcFn:D,blockSelector:o,unblockSelector:i,slimDOMOptions:H,dataURLOptions:x,mirror:Hl,iframeManager:X,stylesheetManager:G,shadowDomManager:Z,processedNodeManager:Y,canvasManager:Q,ignoreCSSAttributes:L,plugins:N?.filter(e=>e.observer)?.map(e=>({observer:e.observer,options:e.options,callback:t=>Bl({type:tl.Plugin,data:{plugin:e.name,payload:t}})}))||[]},{});X.addLoadListener(n=>{try{e.push(t(n.contentDocument))}catch(e){console.warn(e)}});const n=()=>{ee(),e.push(t(document))};return"interactive"===document.readyState||"complete"===document.readyState?n():(e.push(Ou("DOMContentLoaded",()=>{Bl({type:tl.DomContentLoaded,data:{}}),"DOMContentLoaded"===M&&n()})),e.push(Ou("load",()=>{Bl({type:tl.Load,data:{}}),"load"===M&&n()},window))),()=>{e.forEach(e=>e()),Y.destroy(),Ul=void 0,ml=void 0}}catch(e){console.warn(e)}}var ql,Wl;function Vl(e){return e>9999999999?e:1e3*e}function Jl(e){return e>9999999999?e/1e3:e}function Kl(e,t){"sentry.transaction"!==t.category&&(["ui.click","ui.input"].includes(t.category)?e.triggerUserActivity():e.checkAndHandleExpiredSession(),e.addUpdate(()=>(e.throttledAddEvent({type:tl.Custom,timestamp:1e3*(t.timestamp||0),data:{tag:"breadcrumb",payload:bn(t,10,1e3)}}),"console"===t.category)))}function Gl(e){return e.closest("button,a")||e}function Xl(e){const t=Yl(e);return t&&t instanceof Element?Gl(t):t}function Yl(e){return function(e){return"object"==typeof e&&!!e&&"target"in e}(e)?e.target:e}let Ql;zl.mirror=Hl,zl.takeFullSnapshot=function(e){if(!Ul)throw new Error("please take full snapshot after start recording");Ul(e)},(Wl=ql||(ql={}))[Wl.NotStarted=0]="NotStarted",Wl[Wl.Running=1]="Running",Wl[Wl.Stopped=2]="Stopped";const Zl=new Set([nl.Mutation,nl.StyleSheetRule,nl.StyleDeclaration,nl.AdoptedStyleSheet,nl.CanvasMutation,nl.Selection,nl.MediaInteraction]);class ed{constructor(e,t,n=Kl){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=t.timeout/1e3,this._threshold=t.threshold/1e3,this._scrollTimeout=t.scrollTimeout/1e3,this._replay=e,this._ignoreSelector=t.ignoreSelector,this._addBreadcrumbEvent=n}addListeners(){const e=(t=()=>{this._lastMutation=nd()},Ql||(Ql=[],H(Pc,"open",function(e){return function(...t){if(Ql)try{Ql.forEach(e=>e())}catch{}return e.apply(Pc,t)}})),Ql.push(t),()=>{const e=Ql?Ql.indexOf(t):-1;e>-1&&Ql.splice(e,1)});var t;this._teardown=()=>{e(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(e,t){if(function(e,t){return!td.includes(e.tagName)||("INPUT"===e.tagName&&!["submit","button"].includes(e.getAttribute("type")||"")||(!("A"!==e.tagName||!(e.hasAttribute("download")||e.hasAttribute("target")&&"_self"!==e.getAttribute("target")))||!(!t||!e.matches(t))))}(t,this._ignoreSelector)||!function(e){return!(!e.data||"number"!=typeof e.data.nodeId||!e.timestamp)}(e))return;const n={timestamp:Jl(e.timestamp),clickBreadcrumb:e,clickCount:0,node:t};this._clicks.some(e=>e.node===n.node&&Math.abs(e.timestamp-n.timestamp)<1)||(this._clicks.push(n),1===this._clicks.length&&this._scheduleCheckClicks())}registerMutation(e=Date.now()){this._lastMutation=Jl(e)}registerScroll(e=Date.now()){this._lastScroll=Jl(e)}registerClick(e){const t=Gl(e);this._handleMultiClick(t)}_handleMultiClick(e){this._getClicks(e).forEach(e=>{e.clickCount++})}_getClicks(e){return this._clicks.filter(t=>t.node===e)}_checkClicks(){const e=[],t=nd();this._clicks.forEach(n=>{!n.mutationAfter&&this._lastMutation&&(n.mutationAfter=n.timestamp<=this._lastMutation?this._lastMutation-n.timestamp:void 0),!n.scrollAfter&&this._lastScroll&&(n.scrollAfter=n.timestamp<=this._lastScroll?this._lastScroll-n.timestamp:void 0),n.timestamp+this._timeout<=t&&e.push(n)});for(const t of e){const e=this._clicks.indexOf(t);e>-1&&(this._generateBreadcrumbs(t),this._clicks.splice(e,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(e){const t=this._replay,n=e.scrollAfter&&e.scrollAfter<=this._scrollTimeout,s=e.mutationAfter&&e.mutationAfter<=this._threshold,r=!n&&!s,{clickCount:o,clickBreadcrumb:i}=e;if(r){const n=1e3*Math.min(e.mutationAfter||this._timeout,this._timeout),s=n<1e3*this._timeout?"mutation":"timeout",r={type:"default",message:i.message,timestamp:i.timestamp,category:"ui.slowClickDetected",data:{...i.data,url:Pc.location.href,route:t.getCurrentRoute(),timeAfterClickMs:n,endReason:s,clickCount:o||1}};return void this._addBreadcrumbEvent(t,r)}if(o>1){const e={type:"default",message:i.message,timestamp:i.timestamp,category:"ui.multiClick",data:{...i.data,url:Pc.location.href,route:t.getCurrentRoute(),clickCount:o,metric:!0}};this._addBreadcrumbEvent(t,e)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=Xo(()=>this._checkClicks(),1e3)}}const td=["A","BUTTON","INPUT"];function nd(){return Date.now()/1e3}function sd(e){return{timestamp:Date.now()/1e3,type:"default",...e}}var rd=(e=>(e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment",e))(rd||{});const od=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function id(e){const t={};!e["data-sentry-component"]&&e["data-sentry-element"]&&(e["data-sentry-component"]=e["data-sentry-element"]);for(const n in e)if(od.has(n)){let s=n;"data-testid"!==n&&"data-test-id"!==n||(s="testId"),t[s]=e[n]}return t}function ad(e,t){const n=zl.mirror.getId(e),s=n&&zl.mirror.getNode(n),r=s&&zl.mirror.getMeta(s),o=r&&function(e){return e.type===rd.Element}(r)?r:null;return{message:t,data:o?{nodeId:n,node:{id:n,tagName:o.tagName,textContent:Array.from(o.childNodes).map(e=>e.type===rd.Text&&e.textContent).filter(Boolean).map(e=>e.trim()).join(""),attributes:id(o.attributes)}}:{}}}const cd={resource:function(e){const{entryType:t,initiatorType:n,name:s,responseEnd:r,startTime:o,decodedBodySize:i,encodedBodySize:a,responseStatus:c,transferSize:u}=e;return["fetch","xmlhttprequest"].includes(n)?null:{type:`${t}.${n}`,start:dd(o),end:dd(r),name:s,data:{size:u,statusCode:c,decodedBodySize:i,encodedBodySize:a}}},paint:function(e){const{duration:t,entryType:n,name:s,startTime:r}=e,o=dd(r);return{type:n,name:s,start:o,end:o+t,data:void 0}},navigation:function(e){const{entryType:t,name:n,decodedBodySize:s,duration:r,domComplete:o,encodedBodySize:i,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,domInteractive:u,loadEventStart:l,loadEventEnd:d,redirectCount:p,startTime:h,transferSize:f,type:m}=e;return 0===r?null:{type:`${t}.${m}`,start:dd(h),end:dd(o),name:n,data:{size:f,decodedBodySize:s,encodedBodySize:i,duration:r,domInteractive:u,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,loadEventStart:l,loadEventEnd:d,domComplete:o,redirectCount:p}}}};function ud(e,t){return({metric:n})=>{t.replayPerformanceEntries.push(e(n))}}function ld(e){const t=cd[e.entryType];return t?t(e):null}function dd(e){return((ie()||Pc.performance.timeOrigin)+e)/1e3}function pd(e){const t=e.entries[e.entries.length-1];return gd(e,"largest-contentful-paint",t?.element?[t.element]:void 0)}function hd(e){return void 0!==e.sources}function fd(e){const t=[],n=[];for(const s of e.entries)if(hd(s)){const e=[];for(const t of s.sources)if(t.node){n.push(t.node);const s=zl.mirror.getId(t.node);s&&e.push(s)}t.push({value:s.value,nodeIds:e.length?e:void 0})}return gd(e,"cumulative-layout-shift",n,t)}function md(e){const t=e.entries[e.entries.length-1];return gd(e,"interaction-to-next-paint",t?.target?[t.target]:void 0)}function gd(e,t,n,s){const r=e.value,o=e.rating,i=dd(r);return{type:"web-vital",name:t,start:i,end:i,data:{value:r,size:r,rating:o,nodeIds:n?n.map(e=>zl.mirror.getId(e)):void 0,attributions:s}}}const yd="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,bd=["log","warn","error"],vd="[Replay] ";function _d(e,t="info"){Rr({category:"console",data:{logger:"replay"},level:t,message:`${vd}${e}`},{level:t})}const Sd=function(){let e=!1,t=!1;const n={exception:()=>{},infoTick:()=>{},setConfig:n=>{e=!!n.captureExceptions,t=!!n.traceInternals}};return yd?(bd.forEach(e=>{n[e]=(...n)=>{P[e](vd,...n),t&&_d(n.join(""),Or(e))}}),n.exception=(s,...r)=>{r.length&&n.error&&n.error(...r),P.error(vd,s),e?Hs(s,{mechanism:{handled:!0,type:"auto.function.replay.debug"}}):t&&_d(s,"error")},n.infoTick=(...e)=>{P.log(vd,...e),t&&setTimeout(()=>_d(e[0]),0)}):bd.forEach(e=>{n[e]=()=>{}}),n}();class wd extends Error{constructor(){super("Event buffer exceeded maximum size of 20000000.")}}class kd{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1,this.waitForCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(e){const t=JSON.stringify(e).length;if(this._totalSize+=t,this._totalSize>Uc)throw new wd;this.events.push(e)}finish(){return new Promise(e=>{const t=this.events;this.clear(),e(JSON.stringify(t))})}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const e=this.events.map(e=>e.timestamp).sort()[0];return e?Vl(e):null}}class xd{constructor(e){this._worker=e,this._id=0}ensureReady(){return this._ensureReadyPromise||(this._ensureReadyPromise=new Promise((e,t)=>{this._worker.addEventListener("message",({data:n})=>{n.success?e():t()},{once:!0}),this._worker.addEventListener("error",e=>{t(e)},{once:!0})})),this._ensureReadyPromise}destroy(){yd&&Sd.log("Destroying compression worker"),this._worker.terminate()}postMessage(e,t){const n=this._getAndIncrementId();return new Promise((s,r)=>{const o=({data:t})=>{const i=t;if(i.method===e&&i.id===n){if(this._worker.removeEventListener("message",o),!i.success)return yd&&Sd.error("Error in compression worker: ",i.response),void r(new Error("Error in compression worker"));s(i.response)}};this._worker.addEventListener("message",o),this._worker.postMessage({id:n,method:e,arg:t})})}_getAndIncrementId(){return this._id++}}class Td{constructor(e){this._worker=new xd(e),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this.waitForCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(e){const t=Vl(e.timestamp);(!this._earliestTimestamp||t<this._earliestTimestamp)&&(this._earliestTimestamp=t);const n=JSON.stringify(e);return this._totalSize+=n.length,this._totalSize>Uc?Promise.reject(new wd):this._sendEventToWorker(n)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,e=>{yd&&Sd.exception(e,'Sending "clear" message to worker failed',e)})}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(e){return this._worker.postMessage("addEvent",e)}async _finishRequest(){const e=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,e}}class Ed{constructor(e){this._fallback=new kd,this._compression=new Td(e),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get waitForCheckout(){return this._used.waitForCheckout}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(e){this._used.hasCheckout=e}set waitForCheckout(e){this._used.waitForCheckout=e}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(e){return this._used.addEvent(e)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch(e){return void(yd&&Sd.exception(e,"Failed to load the compression worker, falling back to simple buffer"))}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:e,hasCheckout:t,waitForCheckout:n}=this._fallback,s=[];for(const t of e)s.push(this._compression.addEvent(t));this._compression.hasCheckout=t,this._compression.waitForCheckout=n,this._used=this._compression;try{await Promise.all(s),this._fallback.clear()}catch(e){yd&&Sd.exception(e,"Failed to add events when switching buffers.")}}}function Id(){try{return"sessionStorage"in Pc&&!!Pc.sessionStorage}catch{return!1}}function Cd(e){return void 0!==e&&Math.random()<e}function Md(e){if(Id())try{Pc.sessionStorage.setItem(Fc,JSON.stringify(e))}catch{}}function Rd(e){const t=Date.now();return{id:e.id||G(),started:e.started||t,lastActivity:e.lastActivity||t,segmentId:e.segmentId||0,sampled:e.sampled,previousSessionId:e.previousSessionId}}function Od({sessionSampleRate:e,allowBuffering:t,stickySession:n=!1},{previousSessionId:s}={}){const r=function(e,t){return Cd(e)?"session":!!t&&"buffer"}(e,t),o=Rd({sampled:r,previousSessionId:s});return n&&Md(o),o}function Ad(e,t,n=+new Date){return null===e||void 0===t||t<0||0!==t&&e+t<=n}function Nd(e,{maxReplayDuration:t,sessionIdleExpire:n,targetTime:s=Date.now()}){return Ad(e.started,t,s)||Ad(e.lastActivity,n,s)}function Dd(e,{sessionIdleExpire:t,maxReplayDuration:n}){return!!Nd(e,{sessionIdleExpire:t,maxReplayDuration:n})&&("buffer"!==e.sampled||0!==e.segmentId)}function Ld({sessionIdleExpire:e,maxReplayDuration:t,previousSessionId:n},s){const r=s.stickySession&&function(){if(!Id())return null;try{const e=Pc.sessionStorage.getItem(Fc);if(!e)return null;const t=JSON.parse(e);return yd&&Sd.infoTick("Loading existing session"),Rd(t)}catch{return null}}();return r?Dd(r,{sessionIdleExpire:e,maxReplayDuration:t})?(yd&&Sd.infoTick("Session in sessionStorage is expired, creating new one..."),Od(s,{previousSessionId:r.id})):r:(yd&&Sd.infoTick("Creating new session"),Od(s,{previousSessionId:n}))}function Pd(e,t,n){return!!$d(e,t)&&(Fd(e,t,n),!0)}async function Fd(e,t,n){const{eventBuffer:s}=e;if(!s||s.waitForCheckout&&!n)return null;const r="buffer"===e.recordingMode;try{n&&r&&s.clear(),n&&(s.hasCheckout=!0,s.waitForCheckout=!1);const o=function(e,t){try{if("function"==typeof t&&function(e){return e.type===tl.Custom}(e))return t(e)}catch(e){return yd&&Sd.exception(e,"An error occurred in the `beforeAddRecordingEvent` callback, skipping the event..."),null}return e}(t,e.getOptions().beforeAddRecordingEvent);if(!o)return;return await s.addEvent(o)}catch(t){const n=t&&t instanceof wd,o=n?"addEventSizeExceeded":"addEvent";if(n&&r)return s.clear(),s.waitForCheckout=!0,null;e.handleException(t),await e.stop({reason:o});const i=Ee();i&&i.recordDroppedEvent("internal_sdk_error","replay")}}function $d(e,t){if(!e.eventBuffer||e.isPaused()||!e.isEnabled())return!1;const n=Vl(t.timestamp);return!(n+e.timeouts.sessionIdlePause<Date.now()||n>e.getContext().initialTimestamp+e.getOptions().maxReplayDuration&&(yd&&Sd.infoTick(`Skipping event with timestamp ${n} because it is after maxReplayDuration`),1))}function jd(e){return!e.type}function Bd(e){return"transaction"===e.type}function Ud(e){return"feedback"===e.type}function Hd(e){return!!e.category}function zd(){const e=Se().getPropagationContext().dsc;e&&delete e.replay_id;const t=un();t&&delete gn(t).replay_id}function qd(e,t){return t.map(({type:t,start:n,end:s,name:r,data:o})=>{const i=e.throttledAddEvent({type:tl.Custom,timestamp:n,data:{tag:"performanceSpan",payload:{op:t,description:r,startTimestamp:n,endTimestamp:s,data:o}}});return"string"==typeof i?Promise.resolve(null):i})}function Wd(e,t){e.isEnabled()&&null!==t&&(function(e,t){return(!yd||!e.getOptions()._experiments.traceInternals)&&Rc(t,Ee())}(e,t.name)||e.addUpdate(()=>(qd(e,[t]),!0)))}function Vd(e){if(!e)return;const t=new TextEncoder;try{if("string"==typeof e)return t.encode(e).length;if(e instanceof URLSearchParams)return t.encode(e.toString()).length;if(e instanceof FormData){const n=Nc(e);return t.encode(n).length}if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength}catch{}}function Jd(e){if(!e)return;const t=parseInt(e,10);return isNaN(t)?void 0:t}function Kd(e,t){if(!e)return{headers:{},size:void 0,_meta:{warnings:[t]}};const n={...e._meta},s=n.warnings||[];return n.warnings=[...s,t],e._meta=n,e}function Gd(e,t){if(!t)return null;const{startTimestamp:n,endTimestamp:s,url:r,method:o,statusCode:i,request:a,response:c}=t;return{type:e,start:n/1e3,end:s/1e3,name:r,data:{method:o,statusCode:i,request:a,response:c}}}function Xd(e){return{headers:{},size:e,_meta:{warnings:["URL_SKIPPED"]}}}function Yd(e,t,n){if(!t&&0===Object.keys(e).length)return;if(!t)return{headers:e};if(!n)return{headers:e,size:t};const s={headers:e,size:t},{body:r,warnings:o}=function(e){if(!e||"string"!=typeof e)return{body:e};const t=e.length>jc,n=function(e){const t=e[0],n=e[e.length-1];return"["===t&&"]"===n||"{"===t&&"}"===n}(e);if(t){const t=e.slice(0,jc);return n?{body:t,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${t}`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(e)}}catch{}return{body:e}}(n);return s.body=r,o?.length&&(s._meta={warnings:o}),s}function Qd(e,t){return Object.entries(e).reduce((n,[s,r])=>{const o=s.toLowerCase();return t.includes(o)&&e[s]&&(n[o]=r),n},{})}function Zd(e,t){const n=function(e,t=Pc.document.baseURI){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith(Pc.location.origin))return e;const n=new URL(e,t);if(n.origin!==new URL(t).origin)return e;const s=n.href;return!e.endsWith("/")&&s.endsWith("/")?s.slice(0,-1):s}(e);return U(n,t)}function ep(e,t){const n={};return t.forEach(t=>{e.get(t)&&(n[t]=e.get(t))}),n}function tp(e,t){if(!e)return{};const n=e.headers;return n?n instanceof Headers?ep(n,t):Array.isArray(n)?{}:Qd(n,t):{}}function np(e){const t=Ee();try{const{networkDetailAllowUrls:n,networkDetailDenyUrls:s,networkCaptureBodies:r,networkRequestHeaders:o,networkResponseHeaders:i}=e.getOptions(),a={replay:e,networkDetailAllowUrls:n,networkDetailDenyUrls:s,networkCaptureBodies:r,networkRequestHeaders:o,networkResponseHeaders:i};t&&t.on("beforeAddBreadcrumb",(e,t)=>function(e,t,n){if(t.data)try{(function(e){return"xhr"===e.category})(t)&&function(e){return e?.xhr}(n)&&(function(e,t){const{xhr:n,input:s}=t;if(!n)return;const r=Vd(s),o=n.getResponseHeader("content-length")?Jd(n.getResponseHeader("content-length")):function(e,t){try{return Vd("json"===t&&e&&"object"==typeof e?JSON.stringify(e):e)}catch{return}}(n.response,n.responseType);void 0!==r&&(e.data.request_body_size=r),void 0!==o&&(e.data.response_body_size=o)}(t,n),async function(e,t,n){try{const s=function(e,t,n){const s=Date.now(),{startTimestamp:r=s,endTimestamp:o=s,input:i,xhr:a}=t,{url:c,method:u,status_code:l=0,request_body_size:d,response_body_size:p}=e.data;if(!c)return null;if(!a||!Zd(c,n.networkDetailAllowUrls)||Zd(c,n.networkDetailDenyUrls))return{startTimestamp:r,endTimestamp:o,url:c,method:u,statusCode:l,request:Xd(d),response:Xd(p)};const h=a[Vr],f=h?Qd(h.request_headers,n.networkRequestHeaders):{},m=Qd(function(e){const t=e.getAllResponseHeaders();return t?t.split("\r\n").reduce((e,t)=>{const[n,s]=t.split(": ");return s&&(e[n.toLowerCase()]=s),e},{}):{}}(a),n.networkResponseHeaders),[g,y]=n.networkCaptureBodies?Dc(i,Sd):[void 0],[b,v]=n.networkCaptureBodies?function(e){const t=[];try{return[e.responseText]}catch(e){t.push(e)}try{return function(e,t){try{if("string"==typeof e)return[e];if(e instanceof Document)return[e.body.outerHTML];if("json"===t&&e&&"object"==typeof e)return[JSON.stringify(e)];if(!e)return[void 0]}catch(t){return yd&&Sd.exception(t,"Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return yd&&Sd.log("Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}(e.response,e.responseType)}catch(e){t.push(e)}return yd&&Sd.warn("Failed to get xhr response body",...t),[void 0]}(a):[void 0],_=Yd(f,d,g),S=Yd(m,p,b);return{startTimestamp:r,endTimestamp:o,url:c,method:u,statusCode:l,request:y?Kd(_,y):_,response:v?Kd(S,v):S}}(e,t,n),r=Gd("resource.xhr",s);Wd(n.replay,r)}catch(e){yd&&Sd.exception(e,"Failed to capture xhr breadcrumb")}}(t,n,e)),function(e){return"fetch"===e.category}(t)&&function(e){return e?.response}(n)&&(function(e,t){const{input:n,response:s}=t,r=Vd(n?Lc(n):void 0),o=s?Jd(s.headers.get("content-length")):void 0;void 0!==r&&(e.data.request_body_size=r),void 0!==o&&(e.data.response_body_size=o)}(t,n),async function(e,t,n){try{const s=await async function(e,t,n){const s=Date.now(),{startTimestamp:r=s,endTimestamp:o=s}=t,{url:i,method:a,status_code:c=0,request_body_size:u,response_body_size:l}=e.data,d=Zd(i,n.networkDetailAllowUrls)&&!Zd(i,n.networkDetailDenyUrls),p=d?function({networkCaptureBodies:e,networkRequestHeaders:t},n,s){const r=n?(i=t,1===(o=n).length&&"string"!=typeof o[0]?tp(o[0],i):2===o.length?tp(o[1],i):{}):{};var o,i;if(!e)return Yd(r,s,void 0);const a=Lc(n),[c,u]=Dc(a,Sd),l=Yd(r,s,c);return u?Kd(l,u):l}(n,t.input,u):Xd(u),h=await async function(e,{networkCaptureBodies:t,networkResponseHeaders:n},s,r){if(!e&&void 0!==r)return Xd(r);const o=s?ep(s.headers,n):{};if(!s||!t&&void 0!==r)return Yd(o,r,void 0);const[i,a]=await async function(e){const t=function(e){try{return e.clone()}catch(e){yd&&Sd.exception(e,"Failed to clone response body")}}(e);if(!t)return[void 0,"BODY_PARSE_ERROR"];try{const e=await function(e){return new Promise((t,n)=>{const s=Xo(()=>n(new Error("Timeout while trying to read response body")),500);(async function(e){return await e.text()})(e).then(e=>t(e),e=>n(e)).finally(()=>clearTimeout(s))})}(t);return[e]}catch(e){return e instanceof Error&&e.message.indexOf("Timeout")>-1?(yd&&Sd.warn("Parsing text body from response timed out"),[void 0,"BODY_PARSE_TIMEOUT"]):(yd&&Sd.exception(e,"Failed to get text body from response"),[void 0,"BODY_PARSE_ERROR"])}}(s),c=function(e,{networkCaptureBodies:t,responseBodySize:n,captureDetails:s,headers:r}){try{const o=e?.length&&void 0===n?Vd(e):n;return s?Yd(r,o,t?e:void 0):Xd(o)}catch(e){return yd&&Sd.exception(e,"Failed to serialize response body"),Yd(r,n,void 0)}}(i,{networkCaptureBodies:t,responseBodySize:r,captureDetails:e,headers:o});return a?Kd(c,a):c}(d,n,t.response,l);return{startTimestamp:r,endTimestamp:o,url:i,method:a,statusCode:c,request:p,response:h}}(e,t,n),r=Gd("resource.fetch",s);Wd(n.replay,r)}catch(e){yd&&Sd.exception(e,"Failed to capture fetch breadcrumb")}}(t,n,e))}catch(e){yd&&Sd.exception(e,"Error when enriching network breadcrumb")}}(a,e,t))}catch{}}function sp(e){const{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:s}=e,r=Date.now()/1e3;return{type:"memory",name:"memory",start:r,end:r,data:{memory:{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:s}}}}const rp=i.navigator;function op(e){let t=!1;return(n,s)=>{if(!e.checkAndHandleExpiredSession())return void(yd&&Sd.warn("Received replay event after session expired."));const r=s||!t;t=!0,e.clickDetector&&function(e,t){try{if(!function(e){return 3===e.type}(t))return;const{source:n}=t.data;if(Zl.has(n)&&e.registerMutation(t.timestamp),n===nl.Scroll&&e.registerScroll(t.timestamp),function(e){return e.data.source===nl.MouseInteraction}(t)){const{type:n,id:s}=t.data,r=zl.mirror.getNode(s);r instanceof HTMLElement&&n===sl.Click&&e.registerClick(r)}}catch{}}(e.clickDetector,n),e.addUpdate(()=>{if("buffer"===e.recordingMode&&r&&e.setInitialState(),!Pd(e,n,r))return!0;if(!r)return!1;const t=e.session;if(function(e,t){t&&e.session&&0===e.session.segmentId&&Pd(e,function(e){const t=e.getOptions();return{type:tl.Custom,timestamp:Date.now(),data:{tag:"options",payload:{shouldRecordCanvas:e.isRecordingCanvas(),sessionSampleRate:t.sessionSampleRate,errorSampleRate:t.errorSampleRate,useCompressionOption:t.useCompression,blockAllMedia:t.blockAllMedia,maskAllText:t.maskAllText,maskAllInputs:t.maskAllInputs,useCompression:!!e.eventBuffer&&"worker"===e.eventBuffer.type,networkDetailHasUrls:t.networkDetailAllowUrls.length>0,networkCaptureBodies:t.networkCaptureBodies,networkRequestHasHeaders:t.networkRequestHeaders.length>0,networkResponseHasHeaders:t.networkResponseHeaders.length>0}}}}(e),!1)}(e,r),"buffer"===e.recordingMode&&t&&e.eventBuffer){const n=e.eventBuffer.getEarliestTimestamp();n&&(yd&&Sd.log(`Updating session start time to earliest event in buffer to ${new Date(n)}`),t.started=n,e.getOptions().stickySession&&Md(t))}return t?.previousSessionId||"session"===e.recordingMode&&e.flush(),!0})}}class ip extends Error{constructor(e){super(`Transport returned status code ${e}`)}}class ap extends Error{constructor(e){super("Rate limit hit"),this.rateLimits=e}}async function cp(e,t={count:0,interval:5e3}){const{recordingData:n,onError:s}=e;if(n.length)try{return await async function({recordingData:e,replayId:t,segmentId:n,eventContext:s,timestamp:r,session:o}){const i=function({recordingData:e,headers:t}){let n;const s=`${JSON.stringify(t)}\n`;if("string"==typeof e)n=`${s}${e}`;else{const t=(new TextEncoder).encode(s);n=new Uint8Array(t.length+e.length),n.set(t),n.set(e,t.length)}return n}({recordingData:e,headers:{segment_id:n}}),{urls:a,errorIds:c,traceIds:u,initialTimestamp:l}=s,d=Ee(),p=Se(),h=d?.getTransport(),f=d?.getDsn();if(!(d&&h&&f&&o.sampled))return Promise.resolve({});const m={type:"replay_event",replay_start_timestamp:l/1e3,timestamp:r/1e3,error_ids:c,trace_ids:u,urls:a,replay_id:t,segment_id:n,replay_type:o.sampled},g=await async function({client:e,scope:t,replayId:n,event:s}){const r={event_id:n,integrations:"object"!=typeof e._integrations||null===e._integrations||Array.isArray(e._integrations)?void 0:Object.keys(e._integrations)};e.emit("preprocessEvent",s,r);const o=await ds(e.getOptions(),s,r,t,e,we());if(!o)return null;e.emit("postprocessEvent",o,r),o.platform=o.platform||"javascript";const i=e.getSdkMetadata(),{name:a,version:c,settings:u}=i?.sdk||{};return o.sdk={...o.sdk,name:a||"sentry.javascript.unknown",version:c||"0.0.0",settings:u},o}({scope:p,client:d,replayId:t,event:m});if(!g)return d.recordDroppedEvent("event_processor","replay"),yd&&Sd.log("An event processor returned `null`, will not send event."),Promise.resolve({});delete g.sdkProcessingMetadata;const y=function(e,t,n,s){return Sn(An(e,On(e),s,n),[[{type:"replay_event"},e],[{type:"replay_recording",length:"string"==typeof t?(new TextEncoder).encode(t).length:t.length},t]])}(g,i,f,d.getOptions().tunnel);let b;try{b=await h.send(y)}catch(e){const t=new Error($c);try{t.cause=e}catch{}throw t}if("number"==typeof b.statusCode&&(b.statusCode<200||b.statusCode>=300))throw new ip(b.statusCode);const v=qo({},b);if(zo(v,"replay"))throw new ap(v);return b}(e),!0}catch(n){if(n instanceof ip||n instanceof ap)throw n;if(Ws("Replays",{_retryCount:t.count}),s&&s(n),t.count>=3){const e=new Error(`${$c} - max retries exceeded`);try{e.cause=n}catch{}throw e}return t.interval*=++t.count,new Promise((n,s)=>{Xo(async()=>{try{await cp(e,t),n(!0)}catch(e){s(e)}},t.interval)})}}const up="__THROTTLED";class lp{constructor({options:e,recordingOptions:t}){this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:3e5,sessionIdleExpire:9e5},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._requiresManualStart=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=t,this._options=e,this._debouncedFlush=function(e,t,n){return function(e,t,n){let s,r,o;const i=n?.maxWait?Math.max(n.maxWait,t):0,a=n?.setTimeoutImpl||setTimeout;function c(){return u(),s=e(),s}function u(){void 0!==r&&clearTimeout(r),void 0!==o&&clearTimeout(o),r=o=void 0}function l(){return r&&clearTimeout(r),r=a(c,t),i&&void 0===o&&(o=a(c,i)),s}return l.cancel=u,l.flush=function(){return void 0!==r||void 0!==o?c():s},l}(e,t,{...n,setTimeoutImpl:Xo})}(()=>this._flush(),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=function(e,t,n){const s=new Map;let r=!1;return(...o)=>{const i=Math.floor(Date.now()/1e3);if((e=>{const t=e-n;s.forEach((e,n)=>{n<t&&s.delete(n)})})(i),[...s.values()].reduce((e,t)=>e+t,0)>=t){const e=r;return r=!0,e?"__SKIPPED":up}r=!1;const a=s.get(i)||0;return s.set(i,a+1),e(...o)}}((e,t)=>function(e,t,n){return $d(e,t)?Fd(e,t,n):Promise.resolve(null)}(this,e,t),300,5);const{slowClickTimeout:n,slowClickIgnoreSelectors:s}=this.getOptions(),r=n?{threshold:Math.min(3e3,n),timeout:n,scrollTimeout:300,ignoreSelector:s?s.join(","):""}:void 0;if(r&&(this.clickDetector=new ed(this,r)),yd){const t=e._experiments;Sd.setConfig({captureExceptions:!!t.captureExceptions,traceInternals:!!t.traceInternals})}this._handleVisibilityChange=()=>{"visible"===Pc.document.visibilityState?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()},this._handleWindowBlur=()=>{const e=sd({category:"ui.blur"});this._doChangeToBackgroundTasks(e)},this._handleWindowFocus=()=>{const e=sd({category:"ui.focus"});this._doChangeToForegroundTasks(e)},this._handleKeyboardEvent=e=>{!function(e,t){if(!e.isEnabled())return;e.updateUserActivity();const n=function(e){const{metaKey:t,shiftKey:n,ctrlKey:s,altKey:r,key:o,target:i}=e;if(!i||function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable}(i)||!o)return null;const a=t||s||r,c=1===o.length;if(!a&&c)return null;const u=E(i,{maxStringLength:200})||"<unknown>";return sd({category:"ui.keyDown",message:u,data:{...ad(i,u).data,metaKey:t,shiftKey:n,ctrlKey:s,altKey:r,key:o}})}(t);n&&Kl(e,n)}(this,e)}}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}isRecordingCanvas(){return Boolean(this._canvas)}getOptions(){return this._options}handleException(e){yd&&Sd.exception(e),this._options.onError&&this._options.onError(e)}initializeSampling(e){const{errorSampleRate:t,sessionSampleRate:n}=this._options,s=t<=0&&n<=0;this._requiresManualStart=s,s||(this._initializeSessionForSampling(e),this.session?!1!==this.session.sampled&&(this.recordingMode="buffer"===this.session.sampled&&0===this.session.segmentId?"buffer":"session",yd&&Sd.infoTick(`Starting replay in ${this.recordingMode} mode`),this._initializeRecording()):yd&&Sd.exception(new Error("Unable to initialize and create session")))}start(){if(this._isEnabled&&"session"===this.recordingMode)return void(yd&&Sd.log("Recording is already in progress"));if(this._isEnabled&&"buffer"===this.recordingMode)return void(yd&&Sd.log("Buffering is in progress, call `flush()` to save the replay"));yd&&Sd.infoTick("Starting replay in session mode"),this._updateUserActivity();const e=Ld({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=e,this.recordingMode="session",this._initializeRecording()}startBuffering(){if(this._isEnabled)return void(yd&&Sd.log("Buffering is in progress, call `flush()` to save the replay"));yd&&Sd.infoTick("Starting replay in buffer mode");const e=Ld({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const e=this._canvas;this._stopRecording=zl({...this._recordingOptions,..."buffer"===this.recordingMode?{checkoutEveryNms:6e4}:this._options._experiments.continuousCheckout&&{checkoutEveryNms:Math.max(36e4,this._options._experiments.continuousCheckout)},emit:op(this),.../iPhone|iPad|iPod/i.test(rp?.userAgent??"")||/Macintosh/i.test(rp?.userAgent??"")&&rp?.maxTouchPoints&&rp?.maxTouchPoints>1?{sampling:{mousemove:!1}}:{},onMutation:this._onMutationHandler.bind(this),...e?{recordCanvas:e.recordCanvas,getCanvasManager:e.getCanvasManager,sampling:e.sampling,dataURLOptions:e.dataURLOptions}:{}})}catch(e){this.handleException(e)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(e){return this.handleException(e),!1}}async stop({forceFlush:e=!1,reason:t}={}){if(this._isEnabled){this._isEnabled=!1,this.recordingMode="buffer";try{yd&&Sd.log("Stopping Replay"+(t?` triggered by ${t}`:"")),zd(),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),e&&await this._flush({force:!0}),this.eventBuffer?.destroy(),this.eventBuffer=null,n=this,function(){if(Id())try{Pc.sessionStorage.removeItem(Fc)}catch{}}(),n.session=void 0}catch(e){this.handleException(e)}}var n}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),yd&&Sd.log("Pausing replay"))}resume(){this._isPaused&&this._checkSession()&&(this._isPaused=!1,this.startRecording(),yd&&Sd.log("Resuming replay"))}async sendBufferedReplayOrFlush({continueRecording:e=!0}={}){if("session"===this.recordingMode)return this.flushImmediate();const t=Date.now();yd&&Sd.log("Converting buffer to session"),await this.flushImmediate();const n=this.stopRecording();e&&n&&"session"!==this.recordingMode&&(this.recordingMode="session",this.session&&(this._updateUserActivity(t),this._updateSessionActivity(t),this._maybeSaveSession()),this.startRecording())}addUpdate(e){const t=e();"buffer"!==this.recordingMode&&this._isEnabled&&!0!==t&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),this._stopRecording)this.checkAndHandleExpiredSession(),this._updateSessionActivity();else{if(!this._checkSession())return;this.resume()}}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return"buffer"===this.recordingMode?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(e){if(!e||!1!==this.session?.sampled)return this.session?.id}checkAndHandleExpiredSession(){if(!(this._lastActivity&&Ad(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&"session"===this.session.sampled))return!!this._checkSession();this.pause()}setInitialState(){const e=`${Pc.location.pathname}${Pc.location.hash}${Pc.location.search}`,t=`${Pc.location.origin}${e}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=t,this._context.initialTimestamp=Date.now(),this._context.urls.push(t)}throttledAddEvent(e,t){const n=this._throttledAddEvent(e,t);if(n===up){const e=sd({category:"replay.throttled"});this.addUpdate(()=>!Pd(this,{type:5,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e,metric:!0}}))}return n}getCurrentRoute(){const e=this.lastActiveSpan||un(),t=e&&cn(e),n=(t&&en(t).data||{})[ht];if(t&&n&&["route","custom"].includes(n))return en(t).description}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=function({useCompression:e,workerUrl:t}){if(e&&window.Worker){const e=function(e){try{const t=e||("undefined"!=typeof __SENTRY_EXCLUDE_REPLAY_WORKER__&&__SENTRY_EXCLUDE_REPLAY_WORKER__?"":function(){const e=new Blob(['var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),s=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(t,e){for(var i=new n(31),s=0;s<31;++s)i[s]=e+=1<<t[s-1];var a=new r(i[30]);for(s=1;s<30;++s)for(var o=i[s];o<i[s+1];++o)a[o]=o-i[s]<<5|s;return{b:i,r:a}},o=a(e,2),h=o.b,f=o.r;h[28]=258,f[258]=28;for(var l=a(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,s=0,a=new n(r);s<i;++s)t[s]&&++a[t[s]-1];var o,h=new n(r);for(s=1;s<r;++s)h[s]=h[s-1]+a[s-1]<<1;if(e){o=new n(1<<r);var f=15-r;for(s=0;s<i;++s)if(t[s])for(var l=s<<4|t[s],c=r-t[s],v=h[t[s]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>f]=l}else for(o=new n(i),s=0;s<i;++s)t[s]&&(o[s]=u[h[t[s]-1]++]>>15-t[s]);return o},p=new t(288);for(c=0;c<144;++c)p[c]=8;for(c=144;c<256;++c)p[c]=9;for(c=256;c<280;++c)p[c]=7;for(c=280;c<288;++c)p[c]=8;var g=new t(32);for(c=0;c<32;++c)g[c]=5;var w=d(p,9,0),y=d(g,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},_=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},x=function(r,e){for(var i=[],s=0;s<r.length;++s)r[s]&&i.push({s:s,f:r[s]});var a=i.length,o=i.slice();if(!a)return{t:F,l:0};if(1==a){var h=new t(i[0].s+1);return h[i[0].s]=1,{t:h,l:1}}i.sort(function(t,n){return t.f-n.f}),i.push({s:-1,f:25001});var f=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:f.f+l.f,l:f,r:l};c!=a-1;)f=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:f.f+l.f,l:f,r:l};var d=o[0].s;for(s=1;s<a;++s)o[s].s>d&&(d=o[s].s);var p=new n(d+1),g=A(i[c-1],p,0);if(g>e){s=0;var w=0,y=g-e,m=1<<y;for(o.sort(function(t,n){return p[n.s]-p[t.s]||t.f-n.f});s<a;++s){var b=o[s].s;if(!(p[b]>e))break;w+=m-(1<<g-p[b]),p[b]=e}for(w>>=y;w>0;){var M=o[s].s;p[M]<e?w-=1<<e-p[M]++-1:++s}for(;s>=0&&w;--s){var E=o[s].s;p[E]==e&&(--p[E],++w)}g=e}return{t:new t(p),l:g}},A=function(t,n,r){return-1==t.s?Math.max(A(t.l,n,r+1),A(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,s=t[0],a=1,o=function(t){e[i++]=t},h=1;h<=r;++h)if(t[h]==s&&h!=r)++a;else{if(!s&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(s),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(s);a=1,s=t[h]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var s=0;s<e;++s)t[i+s+4]=r[s];return 8*(i+4+e)},U=function(t,r,a,o,h,f,l,u,c,v,m){z(r,m++,a),++h[256];for(var b=x(h,15),M=b.t,E=b.l,A=x(f,15),U=A.t,C=A.l,F=D(M),I=F.c,S=F.n,L=D(U),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=x(q,7),H=G.t,J=G.l,K=19;K>4&&!H[s[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(h,p)+T(f,g)+l,X=T(h,M)+T(f,U)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(U,C,0),R=U;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[s[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=w,P=p,Q=y,R=g;for(B=0;B<u;++B){var rt=o[B];if(rt>255){_(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;_(r,m,Q[et]),m+=R[et],et>3&&(_(r,m,rt>>5&8191),m+=i[et])}else _(r,m,N[rt]),m+=P[rt]}return _(r,m,N[256]),m+P[256]},C=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,s=0|r.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=e+=r[a];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},L=function(s,a,o,h,u){if(!u&&(u={l:1},a.dictionary)){var c=a.dictionary.subarray(-32768),v=new t(c.length+s.length);v.set(c),v.set(s,c.length),s=v,u.w=c.length}return function(s,a,o,h,u,c){var v=c.z||s.length,d=new t(h+v+5*(1+Math.ceil(v/7e3))+u),p=d.subarray(h,d.length-u),g=c.l,w=7&(c.r||0);if(a){w&&(p[0]=c.r>>3);for(var y=C[a-1],M=y>>13,E=8191&y,z=(1<<o)-1,_=c.p||new n(32768),x=c.h||new n(z+1),A=Math.ceil(o/3),D=2*A,T=function(t){return(s[t]^s[t+1]<<A^s[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=x[H];if(_[J]=K,x[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!g)){w=U(s,p,0,F,I,S,O,q,G,j-G,w),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(s[j+Q]==s[j+Q-W]){for(var $=0;$<Z&&s[j+$]==s[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-_[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=_[J])&32767}if(R){F[q++]=268435456|f[Q]<<18|l[R];var it=31&f[Q],st=31&l[R];O+=e[it]+i[st],++I[257+it],++S[st],B=j+Q,++L}else F[q++]=s[j],++I[s[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=s[j],++I[s[j]];w=U(s,p,g,F,I,S,O,q,G,j-G,w),g||(c.r=7&w|p[w/8|0]<<3,w-=7,c.h=x,c.p=_,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+g;j+=65535){var at=j+65535;at>=v&&(p[w/8|0]=g,at=v),w=k(p,w+1,s.subarray(j,at))}c.i=v}return b(d,0,h+m(w)+u)}(s,null==a.level?6:a.level,null==a.mem?u.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(s.length)))):20:12+a.mem,o,h,u)},O=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},j=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(L(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var s=this.b.length-this.s.z;this.b.set(n.subarray(0,s),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(s),32768),this.s.z=n.length-s+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n.prototype.flush=function(){this.ondata||E(5),this.s.l&&E(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},n}();function q(t,n){n||(n={});var r=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}}(),e=t.length;r.p(t);var i,s=L(t,n,10+((i=n).filename?i.filename.length+1:0),8),a=s.length;return function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&O(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}}(s,n),O(s,a-8,r.d()),O(s,a-4,e),s}var B=function(){function t(t,n){this.c=S(),this.v=1,j.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),j.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=L(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=S();i.p(n.dictionary),O(t,2,i.d())}}(r,this.o),this.v=0),n&&O(r,r.length-4,this.c.d()),this.ondata(r,n)},t.prototype.flush=function(){j.prototype.flush.call(this)},t}(),G="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}var J=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(K(t),this.d=n||!1)},t}();function K(n,r){if(G)return G.encode(n);for(var e=n.length,i=new t(n.length+(n.length>>1)),s=0,a=function(t){i[s++]=t},o=0;o<e;++o){if(s+5>i.length){var h=new t(s+8+(e-o<<1));h.set(i),i=h}var f=n.charCodeAt(o);f<128||r?a(f):f<2048?(a(192|f>>6),a(128|63&f)):f>55295&&f<57344?(a(240|(f=65536+(1047552&f)|1023&n.charCodeAt(++o))>>18),a(128|f>>12&63),a(128|f>>6&63),a(128|63&f)):(a(224|f>>12),a(128|f>>6&63),a(128|63&f))}return b(i,0,s)}const N=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(const r of t)n+=r.length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new B,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new J((t,n)=>{this.deflate.push(t,n)}),this.stream.push("[")}},P={clear:()=>{N.clear()},addEvent:t=>N.addEvent(t),finish:()=>N.finish(),compress:t=>function(t){return q(K(t))}(t)};addEventListener("message",function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in P&&"function"==typeof P[n])try{const t=P[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}}),postMessage({id:void 0,method:"init",success:!0,response:void 0});']);return URL.createObjectURL(e)}());if(!t)return;yd&&Sd.log("Using compression worker"+(e?` from ${e}`:""));const n=new Worker(t);return new Ed(n)}catch(e){yd&&Sd.exception(e,"Failed to create compression worker")}}(t);if(e)return e}return yd&&Sd.log("Using simple buffer"),new kd}({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_initializeSessionForSampling(e){const t=this._options.errorSampleRate>0,n=Ld({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,previousSessionId:e},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:t});this.session=n}_checkSession(){if(!this.session)return!1;const e=this.session;return!Dd(e,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})||(this._refreshSession(e),!1)}async _refreshSession(e){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(e.id))}_addListeners(){try{Pc.document.addEventListener("visibilitychange",this._handleVisibilityChange),Pc.addEventListener("blur",this._handleWindowBlur),Pc.addEventListener("focus",this._handleWindowFocus),Pc.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(function(e){const t=Ee();zr((e=>t=>{if(!e.isEnabled())return;const n=function(e){const{target:t,message:n}=function(e){const t="click"===e.name;let n,s=null;try{s=t?Xl(e.event):Yl(e.event),n=E(s,{maxStringLength:200})||"<unknown>"}catch{n="<unknown>"}return{target:s,message:n}}(e);return sd({category:`ui.${e.name}`,...ad(t,n)})}(t);if(!n)return;const s="click"===t.name,r=s?t.event:void 0;var o,i,a;!(s&&e.clickDetector&&r?.target)||r.altKey||r.metaKey||r.ctrlKey||r.shiftKey||(o=e.clickDetector,i=n,a=Xl(t.event),o.handleClick(i,a)),Kl(e,n)})(e)),Xr(function(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{from:t,to:n}=e,s=Date.now()/1e3;return{type:"navigation.push",start:s,end:s,name:n,data:{previous:t}}}(t);null!==n&&(e.getContext().urls.push(n.name),e.triggerUserActivity(),e.addUpdate(()=>(qd(e,[n]),!1)))}}(e)),function(e){const t=Ee();t&&t.on("beforeAddBreadcrumb",t=>function(e,t){if(!e.isEnabled()||!Hd(t))return;const n=function(e){return!Hd(e)||["fetch","xhr","sentry.event","sentry.transaction"].includes(e.category)||e.category.startsWith("ui.")?null:"console"===e.category?function(e){const t=e.data?.arguments;if(!Array.isArray(t)||0===t.length)return sd(e);let n=!1;const s=t.map(e=>{if(!e)return e;if("string"==typeof e)return e.length>Bc?(n=!0,`${e.slice(0,Bc)}`):e;if("object"==typeof e)try{const t=bn(e,7);return JSON.stringify(t).length>Bc?(n=!0,`${JSON.stringify(t,null,2).slice(0,Bc)}`):t}catch{}return e});return sd({...e,data:{...e.data,arguments:s,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}(e):sd(e)}(t);n&&Kl(e,n)}(e,t))}(e),np(e),nr(function(e){return Object.assign((t,n)=>{if(!e.isEnabled()||e.isPaused())return t;if(function(e){return"replay_event"===e.type}(t))return delete t.breadcrumbs,t;if(!jd(t)&&!Bd(t)&&!Ud(t))return t;if(!e.checkAndHandleExpiredSession())return zd(),t;if(Ud(t))return e.flush(),t.contexts.feedback.replay_id=e.getSessionId(),function(e,t){e.triggerUserActivity(),e.addUpdate(()=>!t.timestamp||(e.throttledAddEvent({type:tl.Custom,timestamp:1e3*t.timestamp,data:{tag:"breadcrumb",payload:{timestamp:t.timestamp,type:"default",category:"sentry.feedback",data:{feedbackId:t.event_id}}}}),!1))}(e,t),t;if(function(e,t){return!(e.type||!e.exception?.values?.length||!t.originalException?.__rrweb__)}(t,n)&&!e.getOptions()._experiments.captureExceptions)return yd&&Sd.log("Ignoring error from rrweb internals",t),null;const s=function(e,t){return"buffer"===e.recordingMode&&t.message!==$c&&!(!t.exception||t.type)&&Cd(e.getOptions().errorSampleRate)}(e,t);return(s||"session"===e.recordingMode)&&(t.tags={...t.tags,replayId:e.getSessionId()}),t},{id:"Replay"})}(e)),t&&(t.on("beforeSendEvent",function(e){return t=>{e.isEnabled()&&jd(t)&&function(e,t){const n=t.exception?.values?.[0]?.value;"string"==typeof n&&(n.match(/(reactjs\.org\/docs\/error-decoder\.html\?invariant=|react\.dev\/errors\/)(418|419|422|423|425)/)||n.match(/(does not match server-rendered HTML|Hydration failed because)/i))&&Kl(e,sd({category:"replay.hydrate-error",data:{url:C()}}))}(e,t)}}(e)),t.on("afterSendEvent",function(e){return(t,n)=>{if(!e.isEnabled()||!jd(t)&&!Bd(t))return;const s=n.statusCode;!s||s<200||s>=300||(Bd(t)?function(e,t){const n=e.getContext();t.contexts?.trace?.trace_id&&n.traceIds.size<100&&n.traceIds.add(t.contexts.trace.trace_id)}(e,t):function(e,t){const n=e.getContext();if(t.event_id&&n.errorIds.size<100&&n.errorIds.add(t.event_id),"buffer"!==e.recordingMode||!t.tags||!t.tags.replayId)return;const{beforeErrorSampling:s}=e.getOptions();("function"!=typeof s||s(t))&&Xo(async()=>{try{await e.sendBufferedReplayOrFlush()}catch(t){e.handleException(t)}})}(e,t))}}(e)),t.on("createDsc",t=>{const n=e.getSessionId();n&&e.isEnabled()&&"session"===e.recordingMode&&e.checkAndHandleExpiredSession()&&(t.replay_id=n)}),t.on("spanStart",t=>{e.lastActiveSpan=t}),t.on("spanEnd",t=>{e.lastActiveSpan=t}),t.on("beforeSendFeedback",async(t,n)=>{const s=e.getSessionId();n?.includeReplay&&e.isEnabled()&&s&&t.contexts?.feedback&&("api"===t.contexts.feedback.source&&await e.sendBufferedReplayOrFlush(),t.contexts.feedback.replay_id=s)}),t.on("openFeedbackWidget",async()=>{await e.sendBufferedReplayOrFlush()}))}(this),this._hasInitializedCoreListeners=!0)}catch(e){this.handleException(e)}this._performanceCleanupCallback=function(e){function t(t){e.performanceEntries.includes(t)||e.performanceEntries.push(t)}function n({entries:e}){e.forEach(t)}const s=[];return["navigation","paint","resource"].forEach(e=>{s.push(fa(e,n))}),s.push(pa(ud(pd,e)),da(ud(fd,e)),ha(ud(md,e))),()=>{s.forEach(e=>e())}}(this)}_removeListeners(){try{Pc.document.removeEventListener("visibilitychange",this._handleVisibilityChange),Pc.removeEventListener("blur",this._handleWindowBlur),Pc.removeEventListener("focus",this._handleWindowFocus),Pc.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(e){this.handleException(e)}}_doChangeToBackgroundTasks(e){this.session&&(Nd(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(e&&this._createCustomBreadcrumb(e),this.conditionalFlush()))}_doChangeToForegroundTasks(e){this.session&&(this.checkAndHandleExpiredSession()?e&&this._createCustomBreadcrumb(e):yd&&Sd.log("Document has become active, but session has expired"))}_updateUserActivity(e=Date.now()){this._lastActivity=e}_updateSessionActivity(e=Date.now()){this.session&&(this.session.lastActivity=e,this._maybeSaveSession())}_createCustomBreadcrumb(e){this.addUpdate(()=>{this.throttledAddEvent({type:tl.Custom,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e}})})}_addPerformanceEntries(){let e=(t=this.performanceEntries,t.map(ld).filter(Boolean)).concat(this.replayPerformanceEntries);var t;if(this.performanceEntries=[],this.replayPerformanceEntries=[],this._requiresManualStart){const t=this._context.initialTimestamp/1e3;e=e.filter(e=>e.start>=t)}return Promise.all(qd(this,e))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:e,eventBuffer:t}=this;if(!e||!t||this._requiresManualStart)return;if(e.segmentId)return;const n=t.getEarliestTimestamp();n&&n<this._context.initialTimestamp&&(this._context.initialTimestamp=n)}_popEventContext(){const e={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),e}async _runFlush(){const e=this.getSessionId();if(this.session&&this.eventBuffer&&e){if(await this._addPerformanceEntries(),this.eventBuffer?.hasEvents&&(await async function(e){try{return Promise.all(qd(e,[sp(Pc.performance.memory)]))}catch{return[]}}(this),this.eventBuffer&&e===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const t=Date.now();if(t-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const n=this._popEventContext(),s=this.session.segmentId++;this._maybeSaveSession();const r=await this.eventBuffer.finish();await cp({replayId:e,recordingData:r,segmentId:s,eventContext:n,session:this.session,timestamp:t,onError:e=>this.handleException(e)})}catch(e){this.handleException(e),this.stop({reason:"sendReplay"});const t=Ee();if(t){const n=e instanceof ap?"ratelimit_backoff":"send_error";t.recordDroppedEvent(n,"replay")}}}else yd&&Sd.error("No session or eventBuffer found to flush.")}async _flush({force:e=!1}={}){if(!this._isEnabled&&!e)return;if(!this.checkAndHandleExpiredSession())return void(yd&&Sd.error("Attempting to finish replay event after session expired."));if(!this.session)return;const t=this.session.started,n=Date.now()-t;this._debouncedFlush.cancel();const s=n<this._options.minReplayDuration,r=n>this._options.maxReplayDuration+5e3;if(s||r)return yd&&Sd.log(`Session duration (${Math.floor(n/1e3)}s) is too ${s?"short":"long"}, not sending replay.`),void(s&&this._debouncedFlush());const o=this.eventBuffer;o&&0===this.session.segmentId&&!o.hasCheckout&&yd&&Sd.log("Flushing initial segment without checkout.");const i=!!this._flushLock;this._flushLock||(this._flushLock=this._runFlush());try{await this._flushLock}catch(e){this.handleException(e)}finally{this._flushLock=void 0,i&&this._debouncedFlush()}}_maybeSaveSession(){this.session&&this._options.stickySession&&Md(this.session)}_onMutationHandler(e){const{ignoreMutations:t}=this._options._experiments;if(t?.length&&e.some(e=>{const n=function(e){if(!e)return null;try{return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}catch{return null}}(e.target),s=t.join(",");return n?.matches(s)}))return!1;const n=e.length,s=this._options.mutationLimit,r=s&&n>s;if(n>this._options.mutationBreadcrumbLimit||r){const e=sd({category:"replay.mutations",data:{count:n,limit:r}});this._createCustomBreadcrumb(e)}return!r||(this.stop({reason:"mutationLimit",forceFlush:"session"===this.recordingMode}),!1)}}function dp(e,t){return[...e,...t].join(",")}const pp='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',hp=["content-length","content-type","accept"];let fp=!1;const mp=e=>new gp(e);class gp{constructor({flushMinDelay:e=5e3,flushMaxDelay:t=5500,minReplayDuration:n=4999,maxReplayDuration:s=36e5,stickySession:r=!0,useCompression:o=!0,workerUrl:i,_experiments:a={},maskAllText:c=!0,maskAllInputs:u=!0,blockAllMedia:l=!0,mutationBreadcrumbLimit:d=750,mutationLimit:p=1e4,slowClickTimeout:h=7e3,slowClickIgnoreSelectors:f=[],networkDetailAllowUrls:m=[],networkDetailDenyUrls:g=[],networkCaptureBodies:y=!0,networkRequestHeaders:b=[],networkResponseHeaders:v=[],mask:_=[],maskAttributes:S=["title","placeholder","aria-label"],unmask:w=[],block:k=[],unblock:x=[],ignore:T=[],maskFn:E,beforeAddRecordingEvent:I,beforeErrorSampling:C,onError:M}={}){this.name="Replay";const R=function({mask:e,unmask:t,block:n,unblock:s,ignore:r}){return{maskTextSelector:dp(e,[".sentry-mask","[data-sentry-mask]"]),unmaskTextSelector:dp(t,[]),blockSelector:dp(n,[".sentry-block","[data-sentry-block]","base","iframe[srcdoc]:not([src])"]),unblockSelector:dp(s,[]),ignoreSelector:dp(r,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'])}}({mask:_,unmask:w,block:k,unblock:x,ignore:T});if(this._recordingOptions={maskAllInputs:u,maskAllText:c,maskInputOptions:{password:!0},maskTextFn:E,maskInputFn:E,maskAttributeFn:(e,t,n)=>function({el:e,key:t,maskAttributes:n,maskAllText:s,privacyOptions:r,value:o}){return s?r.unmaskTextSelector&&e.matches(r.unmaskTextSelector)?o:n.includes(t)||"value"===t&&"INPUT"===e.tagName&&["submit","button"].includes(e.getAttribute("type")||"")?o.replace(/[\S]/g,"*"):o:o}({maskAttributes:S,maskAllText:c,privacyOptions:R,key:e,value:t,el:n}),...R,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:e=>{try{e.__rrweb__=!0}catch{}},recordCrossOriginIframes:Boolean(a.recordCrossOriginIframes)},this._initialOptions={flushMinDelay:e,flushMaxDelay:t,minReplayDuration:Math.min(n,15e3),maxReplayDuration:Math.min(s,36e5),stickySession:r,useCompression:o,workerUrl:i,blockAllMedia:l,maskAllInputs:u,maskAllText:c,mutationBreadcrumbLimit:d,mutationLimit:p,slowClickTimeout:h,slowClickIgnoreSelectors:f,networkDetailAllowUrls:m,networkDetailDenyUrls:g,networkCaptureBodies:y,networkRequestHeaders:yp(b),networkResponseHeaders:yp(v),beforeAddRecordingEvent:I,beforeErrorSampling:C,onError:M,_experiments:a},this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${pp}`:pp),this._isInitialized&&Ac())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return fp}set _isInitialized(e){fp=e}afterAllSetup(e){Ac()&&!this._replay&&(this._setup(e),this._initialize(e))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:"session"===this._replay.recordingMode}):Promise.resolve()}flush(e){return this._replay?this._replay.isEnabled()?this._replay.sendBufferedReplayOrFlush(e):(this._replay.start(),Promise.resolve()):Promise.resolve()}getReplayId(e){if(this._replay?.isEnabled())return this._replay.getSessionId(e)}getRecordingMode(){if(this._replay?.isEnabled())return this._replay.recordingMode}_initialize(e){this._replay&&(this._maybeLoadFromReplayCanvasIntegration(e),this._replay.initializeSampling())}_setup(e){const t=function(e,t){const n=t.getOptions(),s={sessionSampleRate:0,errorSampleRate:0,...e},r=Ut(n.replaysSessionSampleRate),o=Ut(n.replaysOnErrorSampleRate);return null==r&&null==o&&A(()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}),null!=r&&(s.sessionSampleRate=r),null!=o&&(s.errorSampleRate=o),s}(this._initialOptions,e);this._replay=new lp({options:t,recordingOptions:this._recordingOptions})}_maybeLoadFromReplayCanvasIntegration(e){try{const t=e.getIntegrationByName("ReplayCanvas");if(!t)return;this._replay._canvas=t.getOptions()}catch{}}}function yp(e){return[...hp,...e.map(e=>e.toLowerCase())]}function bp(){const e=Ee();return e?.getIntegrationByName("Replay")}const vp=100,_p=10,Sp="flag.evaluation.";function wp(e){const t=Se().getScopeData().contexts.flags,n=t?t.values:[];return n.length?(void 0===e.contexts&&(e.contexts={}),e.contexts.flags={values:[...n]},e):e}function kp(e,t,n=vp){const s=Se().getScopeData().contexts;s.flags||(s.flags={values:[]}),function(e,t,n,s){if("boolean"!=typeof n)return;if(e.length>s)return void(r&&P.error(`[Feature Flags] insertToFlagBuffer called on a buffer larger than maxSize=${s}`));const o=e.findIndex(e=>e.flag===t);-1!==o&&e.splice(o,1),e.length===s&&e.shift(),e.push({flag:t,result:n})}(s.flags.values,e,t,n)}function xp(e,t,n=_p){if("boolean"!=typeof t)return;const s=un();if(!s)return;const r=en(s).data;(`${Sp}${e}`in r||Object.keys(r).filter(e=>e.startsWith(Sp)).length<n)&&s.setAttribute(`${Sp}${e}`,t)}const Tp=()=>({name:"LaunchDarkly",processEvent:(e,t,n)=>wp(e)});function Ep(){return{name:"sentry-flag-auditor",type:"flag-used",synchronous:!0,method:(e,t,n)=>{kp(e,t.value),xp(e,t.value)}}}function Ip(e,t={},n=Se()){const{message:s,name:r,email:o,url:i,source:a,associatedEventId:c,tags:u}=e,l={contexts:{feedback:{contact_email:o,name:r,message:s,url:i,source:a,associated_event_id:c}},type:"feedback",level:"info",tags:u},d=n?.getClient()||Ee();return d&&d.emit("beforeSendFeedback",l,t),n.captureEvent(l,t)}const Cp=i,Mp=Cp.document,Rp=Cp.navigator,Op="Report a Bug",Ap=(e,t={includeReplay:!0})=>{if(!e.message)throw new Error("Unable to submit feedback with empty message");const n=Ee();if(!n)throw new Error("No client setup, cannot send feedback.");e.tags&&Object.keys(e.tags).length&&Se().setTags(e.tags);const s=Ip({source:"api",url:C(),...e},t);return new Promise((e,t)=>{const r=setTimeout(()=>t("Unable to determine if Feedback was correctly sent."),3e4),o=n.on("afterSendEvent",(n,i)=>{if(n.event_id===s)return clearTimeout(r),o(),i?.statusCode&&i.statusCode>=200&&i.statusCode<300?e(s):t(403===i?.statusCode?"Unable to send feedback. This could be because this domain is not in your list of allowed domains.":"Unable to send feedback. This could be because of network issues, or because you are using an ad-blocker.")})})},Np="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function Dp(e,t){return{...e,...t,tags:{...e.tags,...t.tags},onFormOpen:()=>{t.onFormOpen?.(),e.onFormOpen?.()},onFormClose:()=>{t.onFormClose?.(),e.onFormClose?.()},onSubmitSuccess:(n,s)=>{t.onSubmitSuccess?.(n,s),e.onSubmitSuccess?.(n,s)},onSubmitError:n=>{t.onSubmitError?.(n),e.onSubmitError?.(n)},onFormSubmitted:()=>{t.onFormSubmitted?.(),e.onFormSubmitted?.()},themeDark:{...e.themeDark,...t.themeDark},themeLight:{...e.themeLight,...t.themeLight}}}function Lp(e,t){return Object.entries(t).forEach(([t,n])=>{e.setAttributeNS(null,t,n)}),e}const Pp="rgba(88, 74, 192, 1)",Fp={foreground:"#2b2233",background:"#ffffff",accentForeground:"white",accentBackground:Pp,successColor:"#268d75",errorColor:"#df3338",border:"1.5px solid rgba(41, 35, 47, 0.13)",boxShadow:"0px 4px 24px 0px rgba(43, 34, 51, 0.12)",outline:"1px auto var(--accent-background)",interactiveFilter:"brightness(95%)"},$p={foreground:"#ebe6ef",background:"#29232f",accentForeground:"white",accentBackground:Pp,successColor:"#2da98c",errorColor:"#f55459",border:"1.5px solid rgba(235, 230, 239, 0.15)",boxShadow:"0px 4px 24px 0px rgba(43, 34, 51, 0.12)",outline:"1px auto var(--accent-background)",interactiveFilter:"brightness(150%)"};function jp(e){return`\n  --foreground: ${e.foreground};\n  --background: ${e.background};\n  --accent-foreground: ${e.accentForeground};\n  --accent-background: ${e.accentBackground};\n  --success-color: ${e.successColor};\n  --error-color: ${e.errorColor};\n  --border: ${e.border};\n  --box-shadow: ${e.boxShadow};\n  --outline: ${e.outline};\n  --interactive-filter: ${e.interactiveFilter};\n  `}const Bp=({lazyLoadIntegration:e,getModalIntegration:t,getScreenshotIntegration:n})=>({id:s="sentry-feedback",autoInject:r=!0,showBranding:o=!0,isEmailRequired:i=!1,isNameRequired:a=!1,showEmail:c=!0,showName:u=!0,enableScreenshot:l=!0,useSentryUser:d={email:"email",name:"username"},tags:p,styleNonce:h,scriptNonce:f,colorScheme:m="system",themeLight:g={},themeDark:y={},addScreenshotButtonLabel:b="Add a screenshot",cancelButtonLabel:v="Cancel",confirmButtonLabel:_="Confirm",emailLabel:S="Email",emailPlaceholder:w="your.email@example.org",formTitle:k="Report a Bug",isRequiredLabel:x="(required)",messageLabel:T="Description",messagePlaceholder:E="What's the bug? What did you expect?",nameLabel:I="Name",namePlaceholder:C="Your Name",removeScreenshotButtonLabel:M="Remove screenshot",submitButtonLabel:R="Send Bug Report",successMessageText:O="Thank you for your report!",triggerLabel:A=Op,triggerAriaLabel:N="",highlightToolText:D="Highlight",hideToolText:L="Hide",removeHighlightText:F="Remove",onFormOpen:$,onFormClose:j,onSubmitSuccess:B,onSubmitError:U,onFormSubmitted:H}={})=>{const z={id:s,autoInject:r,showBranding:o,isEmailRequired:i,isNameRequired:a,showEmail:c,showName:u,enableScreenshot:l,useSentryUser:d,tags:p,styleNonce:h,scriptNonce:f,colorScheme:m,themeDark:y,themeLight:g,triggerLabel:A,triggerAriaLabel:N,cancelButtonLabel:v,submitButtonLabel:R,confirmButtonLabel:_,formTitle:k,emailLabel:S,emailPlaceholder:w,messageLabel:T,messagePlaceholder:E,nameLabel:I,namePlaceholder:C,successMessageText:O,isRequiredLabel:x,addScreenshotButtonLabel:b,removeScreenshotButtonLabel:M,highlightToolText:D,hideToolText:L,removeHighlightText:F,onFormClose:j,onFormOpen:$,onSubmitError:U,onSubmitSuccess:B,onFormSubmitted:H};let q=null,W=[];const V=e=>{if(!q){const t=Mp.createElement("div");t.id=String(e.id),Mp.body.appendChild(t),q=t.attachShadow({mode:"open"}),q.appendChild(function({colorScheme:e,themeDark:t,themeLight:n,styleNonce:s}){const r=Mp.createElement("style");return r.textContent=`\n:host {\n  --font-family: system-ui, 'Helvetica Neue', Arial, sans-serif;\n  --font-size: 14px;\n  --z-index: 100000;\n\n  --page-margin: 16px;\n  --inset: auto 0 0 auto;\n  --actor-inset: var(--inset);\n\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n\n  ${"system"!==e?"color-scheme: only light;":""}\n\n  ${jp("dark"===e?{...$p,...t}:{...Fp,...n})}\n}\n\n${"system"===e?`\n@media (prefers-color-scheme: dark) {\n  :host {\n    ${jp({...$p,...t})}\n  }\n}`:""}\n}\n`,s&&r.setAttribute("nonce",s),r}(e))}return q},J=async s=>{const r=s.enableScreenshot&&!(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(Rp.userAgent)||/Macintosh/i.test(Rp.userAgent)&&Rp.maxTouchPoints&&Rp.maxTouchPoints>1||!isSecureContext);let o,i;try{o=(t?t():await e("feedbackModalIntegration",f))(),Ae(o)}catch{throw Np&&P.error("[Feedback] Error when trying to load feedback integrations. Try using `feedbackSyncIntegration` in your `Sentry.init`."),new Error("[Feedback] Missing feedback modal integration!")}try{const t=r?n?n():await e("feedbackScreenshotIntegration",f):void 0;t&&(i=t(),Ae(i))}catch{Np&&P.error("[Feedback] Missing feedback screenshot integration. Proceeding without screenshots.")}const a=o.createDialog({options:{...s,onFormClose:()=>{a?.close(),s.onFormClose?.()},onFormSubmitted:()=>{a?.close(),s.onFormSubmitted?.()}},screenshotIntegration:i,sendFeedback:Ap,shadow:V(s)});return a},K=(e,t={})=>{const n=Dp(z,t),s="string"==typeof e?Mp.querySelector(e):"function"==typeof e.addEventListener?e:null;if(!s)throw Np&&P.error("[Feedback] Unable to attach to target element"),new Error("Unable to attach to target element");let r=null;const o=async()=>{r||(r=await J({...n,onFormSubmitted:()=>{r?.removeFromDom(),n.onFormSubmitted?.()}})),r.appendToDom(),r.open()};s.addEventListener("click",o);const i=()=>{W=W.filter(e=>e!==i),r?.removeFromDom(),r=null,s.removeEventListener("click",o)};return W.push(i),i},G=(e={})=>{const t=Dp(z,e),n=V(t),s=function({triggerLabel:e,triggerAriaLabel:t,shadow:n,styleNonce:s}){const r=Mp.createElement("button");if(r.type="button",r.className="widget__actor",r.ariaHidden="false",r.ariaLabel=t||e||Op,r.appendChild(function(){const e=e=>Cp.document.createElementNS("http://www.w3.org/2000/svg",e),t=Lp(e("svg"),{width:"20",height:"20",viewBox:"0 0 20 20",fill:"var(--actor-color, var(--foreground))"}),n=Lp(e("g"),{clipPath:"url(#clip0_57_80)"}),s=Lp(e("path"),{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.6622 15H12.3997C12.2129 14.9959 12.031 14.9396 11.8747 14.8375L8.04965 12.2H7.49956V19.1C7.4875 19.3348 7.3888 19.5568 7.22256 19.723C7.05632 19.8892 6.83435 19.9879 6.59956 20H2.04956C1.80193 19.9968 1.56535 19.8969 1.39023 19.7218C1.21511 19.5467 1.1153 19.3101 1.11206 19.0625V12.2H0.949652C0.824431 12.2017 0.700142 12.1783 0.584123 12.1311C0.468104 12.084 0.362708 12.014 0.274155 11.9255C0.185602 11.8369 0.115689 11.7315 0.0685419 11.6155C0.0213952 11.4995 -0.00202913 11.3752 -0.00034808 11.25V3.75C-0.00900498 3.62067 0.0092504 3.49095 0.0532651 3.36904C0.0972798 3.24712 0.166097 3.13566 0.255372 3.04168C0.344646 2.94771 0.452437 2.87327 0.571937 2.82307C0.691437 2.77286 0.82005 2.74798 0.949652 2.75H8.04965L11.8747 0.1625C12.031 0.0603649 12.2129 0.00407221 12.3997 0H15.6622C15.9098 0.00323746 16.1464 0.103049 16.3215 0.278167C16.4966 0.453286 16.5964 0.689866 16.5997 0.9375V3.25269C17.3969 3.42959 18.1345 3.83026 18.7211 4.41679C19.5322 5.22788 19.9878 6.32796 19.9878 7.47502C19.9878 8.62209 19.5322 9.72217 18.7211 10.5333C18.1345 11.1198 17.3969 11.5205 16.5997 11.6974V14.0125C16.6047 14.1393 16.5842 14.2659 16.5395 14.3847C16.4948 14.5035 16.4268 14.6121 16.3394 14.7042C16.252 14.7962 16.147 14.8698 16.0307 14.9206C15.9144 14.9714 15.7891 14.9984 15.6622 15ZM1.89695 10.325H1.88715V4.625H8.33715C8.52423 4.62301 8.70666 4.56654 8.86215 4.4625L12.6872 1.875H14.7247V13.125H12.6872L8.86215 10.4875C8.70666 10.3835 8.52423 10.327 8.33715 10.325H2.20217C2.15205 10.3167 2.10102 10.3125 2.04956 10.3125C1.9981 10.3125 1.94708 10.3167 1.89695 10.325ZM2.98706 12.2V18.1625H5.66206V12.2H2.98706ZM16.5997 9.93612V5.01393C16.6536 5.02355 16.7072 5.03495 16.7605 5.04814C17.1202 5.13709 17.4556 5.30487 17.7425 5.53934C18.0293 5.77381 18.2605 6.06912 18.4192 6.40389C18.578 6.73866 18.6603 7.10452 18.6603 7.47502C18.6603 7.84552 18.578 8.21139 18.4192 8.54616C18.2605 8.88093 18.0293 9.17624 17.7425 9.41071C17.4556 9.64518 17.1202 9.81296 16.7605 9.90191C16.7072 9.91509 16.6536 9.9265 16.5997 9.93612Z"});t.appendChild(n).appendChild(s);const r=e("defs"),o=Lp(e("clipPath"),{id:"clip0_57_80"}),i=Lp(e("rect"),{width:"20",height:"20",fill:"white"});return o.appendChild(i),r.appendChild(o),t.appendChild(r).appendChild(o).appendChild(i),t}()),e){const t=Mp.createElement("span");t.appendChild(Mp.createTextNode(e)),r.appendChild(t)}const o=function(e){const t=Mp.createElement("style");return t.textContent='\n.widget__actor {\n  position: fixed;\n  z-index: var(--z-index);\n  margin: var(--page-margin);\n  inset: var(--actor-inset);\n\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n\n  font-family: inherit;\n  font-size: var(--font-size);\n  font-weight: 600;\n  line-height: 1.14em;\n  text-decoration: none;\n\n  background: var(--actor-background, var(--background));\n  border-radius: var(--actor-border-radius, 1.7em/50%);\n  border: var(--actor-border, var(--border));\n  box-shadow: var(--actor-box-shadow, var(--box-shadow));\n  color: var(--actor-color, var(--foreground));\n  fill: var(--actor-color, var(--foreground));\n  cursor: pointer;\n  opacity: 1;\n  transition: transform 0.2s ease-in-out;\n  transform: translate(0, 0) scale(1);\n}\n.widget__actor[aria-hidden="true"] {\n  opacity: 0;\n  pointer-events: none;\n  visibility: hidden;\n  transform: translate(0, 16px) scale(0.98);\n}\n\n.widget__actor:hover {\n  background: var(--actor-hover-background, var(--background));\n  filter: var(--interactive-filter);\n}\n\n.widget__actor svg {\n  width: 1.14em;\n  height: 1.14em;\n}\n\n@media (max-width: 600px) {\n  .widget__actor span {\n    display: none;\n  }\n}\n',e&&t.setAttribute("nonce",e),t}(s);return{el:r,appendToDom(){n.appendChild(o),n.appendChild(r)},removeFromDom(){r.remove(),o.remove()},show(){r.ariaHidden="false"},hide(){r.ariaHidden="true"}}}({triggerLabel:t.triggerLabel,triggerAriaLabel:t.triggerAriaLabel,shadow:n,styleNonce:h});return K(s.el,{...t,onFormOpen(){s.hide()},onFormClose(){s.show()},onFormSubmitted(){s.show()}}),s};return{name:"Feedback",setupOnce(){Ac()&&z.autoInject&&("loading"===Mp.readyState?Mp.addEventListener("DOMContentLoaded",()=>G().appendToDom()):G().appendToDom())},attachTo:K,createWidget(e={}){const t=G(Dp(z,e));return t.appendToDom(),t},createForm:async(e={})=>J(Dp(z,e)),remove(){q&&(q.parentElement?.remove(),q=null),W.forEach(e=>e()),W=[]}}};function Up(){const e=Ee();return e?.getIntegrationByName("Feedback")}var Hp,zp,qp,Wp,Vp,Jp,Kp,Gp={},Xp=[],Yp=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Qp=Array.isArray;function Zp(e,t){for(var n in t)e[n]=t[n];return e}function eh(e){var t=e.parentNode;t&&t.removeChild(e)}function th(e,t,n){var s,r,o,i={};for(o in t)"key"==o?s=t[o]:"ref"==o?r=t[o]:i[o]=t[o];if(arguments.length>2&&(i.children=arguments.length>3?Hp.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(o in e.defaultProps)void 0===i[o]&&(i[o]=e.defaultProps[o]);return nh(e,i,s,r,null)}function nh(e,t,n,s,r){var o={type:e,props:t,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==r?++qp:r,__i:-1,__u:0};return null==r&&null!=zp.vnode&&zp.vnode(o),o}function sh(e){return e.children}function rh(e,t){this.props=e,this.context=t}function oh(e,t){if(null==t)return e.__?oh(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?oh(e):null}function ih(e,t,n){var s,r=e.__v,o=r.__e,i=e.__P;if(i)return(s=Zp({},r)).__v=r.__v+1,zp.vnode&&zp.vnode(s),yh(i,s,r,e.__n,void 0!==i.ownerSVGElement,32&r.__u?[o]:null,t,null==o?oh(r):o,!!(32&r.__u),n),s.__.__k[s.__i]=s,s.__d=void 0,s.__e!=o&&ah(s),s}function ah(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return ah(e)}}function ch(e){(!e.__d&&(e.__d=!0)&&Wp.push(e)&&!uh.__r++||Vp!==zp.debounceRendering)&&((Vp=zp.debounceRendering)||Jp)(uh)}function uh(){var e,t,n,s=[],r=[];for(Wp.sort(Kp);e=Wp.shift();)e.__d&&(n=Wp.length,t=ih(e,s,r)||t,0===n||Wp.length>n?(bh(s,t,r),r.length=s.length=0,t=void 0,Wp.sort(Kp)):t&&zp.__c&&zp.__c(t,Xp));t&&bh(s,t,r),uh.__r=0}function lh(e,t,n,s,r,o,i,a,c,u,l){var d,p,h,f,m,g=s&&s.__k||Xp,y=t.length;for(n.__d=c,function(e,t,n){var s,r,o,i,a,c=t.length,u=n.length,l=u,d=0;for(e.__k=[],s=0;s<c;s++)null!=(r=e.__k[s]=null==(r=t[s])||"boolean"==typeof r||"function"==typeof r?null:"string"==typeof r||"number"==typeof r||"bigint"==typeof r||r.constructor==String?nh(null,r,null,null,r):Qp(r)?nh(sh,{children:r},null,null,null):void 0===r.constructor&&r.__b>0?nh(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r)?(r.__=e,r.__b=e.__b+1,a=ph(r,n,i=s+d,l),r.__i=a,o=null,-1!==a&&(l--,(o=n[a])&&(o.__u|=131072)),null==o||null===o.__v?(-1==a&&d--,"function"!=typeof r.type&&(r.__u|=65536)):a!==i&&(a===i+1?d++:a>i?l>c-i?d+=a-i:d--:d=a<i&&a==i-1?a-i:0,a!==s+d&&(r.__u|=65536))):(o=n[s])&&null==o.key&&o.__e&&(o.__e==e.__d&&(e.__d=oh(o)),_h(o,o,!1),n[s]=null,l--);if(l)for(s=0;s<u;s++)null!=(o=n[s])&&!(131072&o.__u)&&(o.__e==e.__d&&(e.__d=oh(o)),_h(o,o))}(n,t,g),c=n.__d,d=0;d<y;d++)null!=(h=n.__k[d])&&"boolean"!=typeof h&&"function"!=typeof h&&(p=-1===h.__i?Gp:g[h.__i]||Gp,h.__i=d,yh(e,h,p,r,o,i,a,c,u,l),f=h.__e,h.ref&&p.ref!=h.ref&&(p.ref&&vh(p.ref,null,h),l.push(h.ref,h.__c||f,h)),null==m&&null!=f&&(m=f),65536&h.__u||p.__k===h.__k?c=dh(h,c,e):"function"==typeof h.type&&void 0!==h.__d?c=h.__d:f&&(c=f.nextSibling),h.__d=void 0,h.__u&=-196609);n.__d=c,n.__e=m}function dh(e,t,n){var s,r;if("function"==typeof e.type){for(s=e.__k,r=0;s&&r<s.length;r++)s[r]&&(s[r].__=e,t=dh(s[r],t,n));return t}e.__e!=t&&(n.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8===t.nodeType);return t}function ph(e,t,n,s){var r=e.key,o=e.type,i=n-1,a=n+1,c=t[n];if(null===c||c&&r==c.key&&o===c.type)return n;if(s>(null==c||131072&c.__u?0:1))for(;i>=0||a<t.length;){if(i>=0){if((c=t[i])&&!(131072&c.__u)&&r==c.key&&o===c.type)return i;i--}if(a<t.length){if((c=t[a])&&!(131072&c.__u)&&r==c.key&&o===c.type)return a;a++}}return-1}function hh(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||Yp.test(t)?n:n+"px"}function fh(e,t,n,s,r){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof s&&(e.style.cssText=s=""),s)for(t in s)n&&t in n||hh(e.style,t,"");if(n)for(t in n)s&&n[t]===s[t]||hh(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?s?n.u=s.u:(n.u=Date.now(),e.addEventListener(t,o?gh:mh,o)):e.removeEventListener(t,o?gh:mh,o);else{if(r)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==t&&"height"!==t&&"href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&"rowSpan"!==t&&"colSpan"!==t&&"role"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,n))}}function mh(e){if(this.l){var t=this.l[e.type+!1];if(e.t){if(e.t<=t.u)return}else e.t=Date.now();return t(zp.event?zp.event(e):e)}}function gh(e){if(this.l)return this.l[e.type+!0](zp.event?zp.event(e):e)}function yh(e,t,n,s,r,o,i,a,c,u){var l,d,p,h,f,m,g,y,b,v,_,S,w,k,x,T=t.type;if(void 0!==t.constructor)return null;128&n.__u&&(c=!!(32&n.__u),o=[a=t.__e=n.__e]),(l=zp.__b)&&l(t);e:if("function"==typeof T)try{if(y=t.props,b=(l=T.contextType)&&s[l.__c],v=l?b?b.props.value:l.__:s,n.__c?g=(d=t.__c=n.__c).__=d.__E:("prototype"in T&&T.prototype.render?t.__c=d=new T(y,v):(t.__c=d=new rh(y,v),d.constructor=T,d.render=Sh),b&&b.sub(d),d.props=y,d.state||(d.state={}),d.context=v,d.__n=s,p=d.__d=!0,d.__h=[],d._sb=[]),null==d.__s&&(d.__s=d.state),null!=T.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=Zp({},d.__s)),Zp(d.__s,T.getDerivedStateFromProps(y,d.__s))),h=d.props,f=d.state,d.__v=t,p)null==T.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==T.getDerivedStateFromProps&&y!==h&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(y,v),!d.__e&&(null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(y,d.__s,v)||t.__v===n.__v)){for(t.__v!==n.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(e){e&&(e.__=t)}),_=0;_<d._sb.length;_++)d.__h.push(d._sb[_]);d._sb=[],d.__h.length&&i.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(y,d.__s,v),null!=d.componentDidUpdate&&d.__h.push(function(){d.componentDidUpdate(h,f,m)})}if(d.context=v,d.props=y,d.__P=e,d.__e=!1,S=zp.__r,w=0,"prototype"in T&&T.prototype.render){for(d.state=d.__s,d.__d=!1,S&&S(t),l=d.render(d.props,d.state,d.context),k=0;k<d._sb.length;k++)d.__h.push(d._sb[k]);d._sb=[]}else do{d.__d=!1,S&&S(t),l=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++w<25);d.state=d.__s,null!=d.getChildContext&&(s=Zp(Zp({},s),d.getChildContext())),p||null==d.getSnapshotBeforeUpdate||(m=d.getSnapshotBeforeUpdate(h,f)),lh(e,Qp(x=null!=l&&l.type===sh&&null==l.key?l.props.children:l)?x:[x],t,n,s,r,o,i,a,c,u),d.base=t.__e,t.__u&=-161,d.__h.length&&i.push(d),g&&(d.__E=d.__=null)}catch(e){t.__v=null,c||null!=o?(t.__e=a,t.__u|=c?160:32,o[o.indexOf(a)]=null):(t.__e=n.__e,t.__k=n.__k),zp.__e(e,t,n)}else null==o&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=function(e,t,n,s,r,o,i,a,c){var u,l,d,p,h,f,m,g=n.props,y=t.props,b=t.type;if("svg"===b&&(r=!0),null!=o)for(u=0;u<o.length;u++)if((h=o[u])&&"setAttribute"in h==!!b&&(b?h.localName===b:3===h.nodeType)){e=h,o[u]=null;break}if(null==e){if(null===b)return document.createTextNode(y);e=r?document.createElementNS("http://www.w3.org/2000/svg",b):document.createElement(b,y.is&&y),o=null,a=!1}if(null===b)g===y||a&&e.data===y||(e.data=y);else{if(o=o&&Hp.call(e.childNodes),g=n.props||Gp,!a&&null!=o)for(g={},u=0;u<e.attributes.length;u++)g[(h=e.attributes[u]).name]=h.value;for(u in g)h=g[u],"children"==u||("dangerouslySetInnerHTML"==u?d=h:"key"===u||u in y||fh(e,u,null,h,r));for(u in y)h=y[u],"children"==u?p=h:"dangerouslySetInnerHTML"==u?l=h:"value"==u?f=h:"checked"==u?m=h:"key"===u||a&&"function"!=typeof h||g[u]===h||fh(e,u,h,g[u],r);if(l)a||d&&(l.__html===d.__html||l.__html===e.innerHTML)||(e.innerHTML=l.__html),t.__k=[];else if(d&&(e.innerHTML=""),lh(e,Qp(p)?p:[p],t,n,s,r&&"foreignObject"!==b,o,i,o?o[0]:n.__k&&oh(n,0),a,c),null!=o)for(u=o.length;u--;)null!=o[u]&&eh(o[u]);a||(u="value",void 0!==f&&(f!==e[u]||"progress"===b&&!f||"option"===b&&f!==g[u])&&fh(e,u,f,g[u],!1),u="checked",void 0!==m&&m!==e[u]&&fh(e,u,m,g[u],!1))}return e}(n.__e,t,n,s,r,o,i,c,u);(l=zp.diffed)&&l(t)}function bh(e,t,n){for(var s=0;s<n.length;s++)vh(n[s],n[++s],n[++s]);zp.__c&&zp.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){zp.__e(e,t.__v)}})}function vh(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){zp.__e(e,n)}}function _h(e,t,n){var s,r;if(zp.unmount&&zp.unmount(e),(s=e.ref)&&(s.current&&s.current!==e.__e||vh(s,null,t)),null!=(s=e.__c)){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(e){zp.__e(e,t)}s.base=s.__P=null,e.__c=void 0}if(s=e.__k)for(r=0;r<s.length;r++)s[r]&&_h(s[r],t,n||"function"!=typeof e.type);n||null==e.__e||eh(e.__e),e.__=e.__e=e.__d=void 0}function Sh(e,t,n){return this.constructor(e,n)}Hp=Xp.slice,zp={__e:function(e,t,n,s){for(var r,o,i;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&null!=o.getDerivedStateFromError&&(r.setState(o.getDerivedStateFromError(e)),i=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e,s||{}),i=r.__d),i)return r.__E=r}catch(t){e=t}throw e}},qp=0,rh.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=Zp({},this.state),"function"==typeof e&&(e=e(Zp({},n),this.props)),e&&Zp(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),ch(this))},rh.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ch(this))},rh.prototype.render=sh,Wp=[],Jp="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Kp=function(e,t){return e.__v.__b-t.__v.__b},uh.__r=0;var wh,kh,xh,Th,Eh=0,Ih=[],Ch=[],Mh=zp,Rh=Mh.__b,Oh=Mh.__r,Ah=Mh.diffed,Nh=Mh.__c,Dh=Mh.unmount,Lh=Mh.__;function Ph(e,t){Mh.__h&&Mh.__h(kh,e,Eh||t),Eh=0;var n=kh.__H||(kh.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:Ch}),n.__[e]}function Fh(e){return Eh=1,$h(Kh,e)}function $h(e,t,n){var s=Ph(wh++,2);if(s.t=e,!s.__c&&(s.__=[n?n(t):Kh(void 0,t),function(e){var t=s.__N?s.__N[0]:s.__[0],n=s.t(t,e);t!==n&&(s.__N=[n,s.__[1]],s.__c.setState({}))}],s.__c=kh,!kh.u)){var r=function(e,t,n){if(!s.__c.__H)return!0;var r=s.__c.__H.__.filter(function(e){return!!e.__c});if(r.every(function(e){return!e.__N}))return!o||o.call(this,e,t,n);var i=!1;return r.forEach(function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(i=!0)}}),!(!i&&s.__c.props===e)&&(!o||o.call(this,e,t,n))};kh.u=!0;var o=kh.shouldComponentUpdate,i=kh.componentWillUpdate;kh.componentWillUpdate=function(e,t,n){if(this.__e){var s=o;o=void 0,r(e,t,n),o=s}i&&i.call(this,e,t,n)},kh.shouldComponentUpdate=r}return s.__N||s.__}function jh(e,t){var n=Ph(wh++,4);!Mh.__s&&Jh(n.__H,t)&&(n.__=e,n.i=t,kh.__h.push(n))}function Bh(e,t){var n=Ph(wh++,7);return Jh(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function Uh(e,t){return Eh=8,Bh(function(){return e},t)}function Hh(){for(var e;e=Ih.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Wh),e.__H.__h.forEach(Vh),e.__H.__h=[]}catch(t){e.__H.__h=[],Mh.__e(t,e.__v)}}Mh.__b=function(e){kh=null,Rh&&Rh(e)},Mh.__=function(e,t){t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Lh&&Lh(e,t)},Mh.__r=function(e){Oh&&Oh(e),wh=0;var t=(kh=e.__c).__H;t&&(xh===kh?(t.__h=[],kh.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.__V=Ch,e.__N=e.i=void 0})):(t.__h.forEach(Wh),t.__h.forEach(Vh),t.__h=[],wh=0)),xh=kh},Mh.diffed=function(e){Ah&&Ah(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Ih.push(t)&&Th===Mh.requestAnimationFrame||((Th=Mh.requestAnimationFrame)||qh)(Hh)),t.__H.__.forEach(function(e){e.i&&(e.__H=e.i),e.__V!==Ch&&(e.__=e.__V),e.i=void 0,e.__V=Ch})),xh=kh=null},Mh.__c=function(e,t){t.some(function(e){try{e.__h.forEach(Wh),e.__h=e.__h.filter(function(e){return!e.__||Vh(e)})}catch(n){t.some(function(e){e.__h&&(e.__h=[])}),t=[],Mh.__e(n,e.__v)}}),Nh&&Nh(e,t)},Mh.unmount=function(e){Dh&&Dh(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(e){try{Wh(e)}catch(e){t=e}}),n.__H=void 0,t&&Mh.__e(t,n.__v))};var zh="function"==typeof requestAnimationFrame;function qh(e){var t,n=function(){clearTimeout(s),zh&&cancelAnimationFrame(t),setTimeout(e)},s=setTimeout(n,100);zh&&(t=requestAnimationFrame(n))}function Wh(e){var t=kh,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),kh=t}function Vh(e){var t=kh;e.__c=e.__(),kh=t}function Jh(e,t){return!e||e.length!==t.length||t.some(function(t,n){return t!==e[n]})}function Kh(e,t){return"function"==typeof t?t(e):t}const Gh=Object.defineProperty({__proto__:null,useCallback:Uh,useContext:function(e){var t=kh.context[e.__c],n=Ph(wh++,9);return n.c=e,t?(null==n.__&&(n.__=!0,t.sub(kh)),t.props.value):e.__},useDebugValue:function(e,t){Mh.useDebugValue&&Mh.useDebugValue(t?t(e):e)},useEffect:function(e,t){var n=Ph(wh++,3);!Mh.__s&&Jh(n.__H,t)&&(n.__=e,n.i=t,kh.__H.__h.push(n))},useErrorBoundary:function(e){var t=Ph(wh++,10),n=Fh();return t.__=e,kh.componentDidCatch||(kh.componentDidCatch=function(e,s){t.__&&t.__(e,s),n[1](e)}),[n[0],function(){n[1](void 0)}]},useId:function(){var e=Ph(wh++,11);if(!e.__){for(var t=kh.__v;null!==t&&!t.__m&&null!==t.__;)t=t.__;var n=t.__m||(t.__m=[0,0]);e.__="P"+n[0]+"-"+n[1]++}return e.__},useImperativeHandle:function(e,t,n){Eh=6,jh(function(){return"function"==typeof e?(e(t()),function(){return e(null)}):e?(e.current=t(),function(){return e.current=null}):void 0},null==n?n:n.concat(e))},useLayoutEffect:jh,useMemo:Bh,useReducer:$h,useRef:function(e){return Eh=5,Bh(function(){return{current:e}},[])},useState:Fh},Symbol.toStringTag,{value:"Module"});function Xh(){const e=e=>Mp.createElementNS("http://www.w3.org/2000/svg",e),t=Lp(e("svg"),{width:"32",height:"30",viewBox:"0 0 72 66",fill:"inherit"}),n=Lp(e("path"),{transform:"translate(11, 11)",d:"M29,2.26a4.67,4.67,0,0,0-8,0L14.42,13.53A32.21,32.21,0,0,1,32.17,40.19H27.55A27.68,27.68,0,0,0,12.09,17.47L6,28a15.92,15.92,0,0,1,9.23,12.17H4.62A.76.76,0,0,1,4,39.06l2.94-5a10.74,10.74,0,0,0-3.36-1.9l-2.91,5a4.54,4.54,0,0,0,1.69,6.24A4.66,4.66,0,0,0,4.62,44H19.15a19.4,19.4,0,0,0-8-17.31l2.31-4A23.87,23.87,0,0,1,23.76,44H36.07a35.88,35.88,0,0,0-16.41-31.8l4.67-8a.77.77,0,0,1,1.05-.27c.53.29,20.29,34.77,20.66,35.17a.76.76,0,0,1-.68,1.13H40.6q.09,1.91,0,3.81h4.78A4.59,4.59,0,0,0,50,39.43a4.49,4.49,0,0,0-.62-2.28Z"});return t.appendChild(n),t}function Yh({options:e}){const t=Bh(()=>({__html:Xh().outerHTML}),[]);return th("h2",{class:"dialog__header"},th("span",{class:"dialog__title"},e.formTitle),e.showBranding?th("a",{class:"brand-link",target:"_blank",href:"https://sentry.io/welcome/",title:"Powered by Sentry",rel:"noopener noreferrer",dangerouslySetInnerHTML:t}):null)}function Qh(e,t){const n=e.get(t);return"string"==typeof n?n.trim():""}function Zh({options:e,defaultEmail:t,defaultName:n,onFormClose:s,onSubmit:r,onSubmitSuccess:o,onSubmitError:i,showEmail:a,showName:c,screenshotInput:u}){const{tags:l,addScreenshotButtonLabel:d,removeScreenshotButtonLabel:p,cancelButtonLabel:h,emailLabel:f,emailPlaceholder:m,isEmailRequired:g,isNameRequired:y,messageLabel:b,messagePlaceholder:v,nameLabel:_,namePlaceholder:S,submitButtonLabel:w,isRequiredLabel:k}=e,[x,T]=Fh(!1),[E,I]=Fh(null),[C,M]=Fh(!1),R=u?.input,[O,A]=Fh(null),N=Uh(e=>{A(e),M(!1)},[]),D=Uh(e=>{const t=function(e,t){const n=[];return t.isNameRequired&&!e.name&&n.push(t.nameLabel),t.isEmailRequired&&!e.email&&n.push(t.emailLabel),e.message||n.push(t.messageLabel),n}(e,{emailLabel:f,isEmailRequired:g,isNameRequired:y,messageLabel:b,nameLabel:_});return t.length>0?I(`Please enter in the following required fields: ${t.join(", ")}`):I(null),0===t.length},[f,g,y,b,_]),L=Uh(async e=>{T(!0);try{if(e.preventDefault(),!(e.target instanceof HTMLFormElement))return;const t=new FormData(e.target),n=await(u&&C?u.value():void 0),s={name:Qh(t,"name"),email:Qh(t,"email"),message:Qh(t,"message"),attachments:n?[n]:void 0};if(!D(s))return;try{const e=await r({name:s.name,email:s.email,message:s.message,source:"widget",tags:l},{attachments:s.attachments});o(s,e)}catch(e){Np&&P.error(e),I(e),i(e)}}finally{T(!1)}},[u&&C,o,i]);return th("form",{class:"form",onSubmit:L},R&&C?th(R,{onError:N}):null,th("fieldset",{class:"form__right","data-sentry-feedback":!0,disabled:x},th("div",{class:"form__top"},E?th("div",{class:"form__error-container"},E):null,c?th("label",{for:"name",class:"form__label"},th(ef,{label:_,isRequiredLabel:k,isRequired:y}),th("input",{class:"form__input",defaultValue:n,id:"name",name:"name",placeholder:S,required:y,type:"text"})):th("input",{"aria-hidden":!0,value:n,name:"name",type:"hidden"}),a?th("label",{for:"email",class:"form__label"},th(ef,{label:f,isRequiredLabel:k,isRequired:g}),th("input",{class:"form__input",defaultValue:t,id:"email",name:"email",placeholder:m,required:g,type:"email"})):th("input",{"aria-hidden":!0,value:t,name:"email",type:"hidden"}),th("label",{for:"message",class:"form__label"},th(ef,{label:b,isRequiredLabel:k,isRequired:!0}),th("textarea",{autoFocus:!0,class:"form__input form__input--textarea",id:"message",name:"message",placeholder:v,required:!0,rows:5})),R?th("label",{for:"screenshot",class:"form__label"},th("button",{class:"btn btn--default",disabled:x,type:"button",onClick:()=>{A(null),M(e=>!e)}},C?p:d),O?th("div",{class:"form__error-container"},O.message):null):null),th("div",{class:"btn-group"},th("button",{class:"btn btn--primary",disabled:x,type:"submit"},w),th("button",{class:"btn btn--default",disabled:x,type:"button",onClick:s},h))))}function ef({label:e,isRequired:t,isRequiredLabel:n}){return th("span",{class:"form__label__text"},e,t&&th("span",{class:"form__label__text--required"},n))}function tf(){const e=e=>Cp.document.createElementNS("http://www.w3.org/2000/svg",e),t=Lp(e("svg"),{width:"16",height:"17",viewBox:"0 0 16 17",fill:"inherit"}),n=Lp(e("g"),{clipPath:"url(#clip0_57_156)"}),s=Lp(e("path"),{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.55544 15.1518C4.87103 16.0308 6.41775 16.5 8 16.5C10.1217 16.5 12.1566 15.6571 13.6569 14.1569C15.1571 12.6566 16 10.6217 16 8.5C16 6.91775 15.5308 5.37103 14.6518 4.05544C13.7727 2.73985 12.5233 1.71447 11.0615 1.10897C9.59966 0.503466 7.99113 0.34504 6.43928 0.653721C4.88743 0.962403 3.46197 1.72433 2.34315 2.84315C1.22433 3.96197 0.462403 5.38743 0.153721 6.93928C-0.15496 8.49113 0.00346625 10.0997 0.608967 11.5615C1.21447 13.0233 2.23985 14.2727 3.55544 15.1518ZM4.40546 3.1204C5.46945 2.40946 6.72036 2.03 8 2.03C9.71595 2.03 11.3616 2.71166 12.575 3.92502C13.7883 5.13838 14.47 6.78405 14.47 8.5C14.47 9.77965 14.0905 11.0306 13.3796 12.0945C12.6687 13.1585 11.6582 13.9878 10.476 14.4775C9.29373 14.9672 7.99283 15.0953 6.73777 14.8457C5.48271 14.596 4.32987 13.9798 3.42502 13.075C2.52018 12.1701 1.90397 11.0173 1.65432 9.76224C1.40468 8.50718 1.5328 7.20628 2.0225 6.02404C2.5122 4.8418 3.34148 3.83133 4.40546 3.1204Z"}),r=Lp(e("path"),{d:"M6.68775 12.4297C6.78586 12.4745 6.89218 12.4984 7 12.5C7.11275 12.4955 7.22315 12.4664 7.32337 12.4145C7.4236 12.3627 7.51121 12.2894 7.58 12.2L12 5.63999C12.0848 5.47724 12.1071 5.28902 12.0625 5.11098C12.0178 4.93294 11.9095 4.77744 11.7579 4.67392C11.6064 4.57041 11.4221 4.52608 11.24 4.54931C11.0579 4.57254 10.8907 4.66173 10.77 4.79999L6.88 10.57L5.13 8.56999C5.06508 8.49566 4.98613 8.43488 4.89768 8.39111C4.80922 8.34735 4.713 8.32148 4.61453 8.31498C4.51605 8.30847 4.41727 8.32147 4.32382 8.35322C4.23038 8.38497 4.14413 8.43484 4.07 8.49999C3.92511 8.63217 3.83692 8.81523 3.82387 9.01092C3.81083 9.2066 3.87393 9.39976 4 9.54999L6.43 12.24C6.50187 12.3204 6.58964 12.385 6.68775 12.4297Z"});t.appendChild(n).append(r,s);const o=e("defs"),i=Lp(e("clipPath"),{id:"clip0_57_156"}),a=Lp(e("rect"),{width:"16",height:"16",fill:"white",transform:"translate(0 0.5)"});return i.appendChild(a),o.appendChild(i),t.appendChild(o).appendChild(i).appendChild(a),t}function nf({open:e,onFormSubmitted:t,...n}){const s=n.options,r=Bh(()=>({__html:tf().outerHTML}),[]),[o,i]=Fh(null),a=Uh(()=>{o&&(clearTimeout(o),i(null)),t()},[o]),c=Uh((e,s)=>{n.onSubmitSuccess(e,s),i(setTimeout(()=>{t(),i(null)},5e3))},[t]);return th(sh,null,o?th("div",{class:"success__position",onClick:a},th("div",{class:"success__content"},s.successMessageText,th("span",{class:"success__icon",dangerouslySetInnerHTML:r}))):th("dialog",{class:"dialog",onClick:s.onFormClose,open:e},th("div",{class:"dialog__position"},th("div",{class:"dialog__content",onClick:e=>{e.stopPropagation()}},th(Yh,{options:s}),th(Zh,{...n,onSubmitSuccess:c})))))}const sf=()=>({name:"FeedbackModal",setupOnce(){},createDialog:({options:e,screenshotIntegration:t,sendFeedback:n,shadow:s})=>{const r=s,o=e.useSentryUser,i=function(){const e=Se().getUser(),t=we().getUser(),n=ke().getUser();return e&&Object.keys(e).length?e:t&&Object.keys(t).length?t:n}(),a=Mp.createElement("div"),c=function(e){const t=Mp.createElement("style");return t.textContent="\n:host {\n  --dialog-inset: var(--inset);\n}\n\n\n.dialog {\n  position: fixed;\n  z-index: var(--z-index);\n  margin: 0;\n  inset: 0;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0;\n  height: 100vh;\n  width: 100vw;\n\n  color: var(--dialog-color, var(--foreground));\n  fill: var(--dialog-color, var(--foreground));\n  line-height: 1.75em;\n\n  background-color: rgba(0, 0, 0, 0.05);\n  border: none;\n  inset: 0;\n  opacity: 1;\n  transition: opacity 0.2s ease-in-out;\n}\n\n.dialog__position {\n  position: fixed;\n  z-index: var(--z-index);\n  inset: var(--dialog-inset);\n  padding: var(--page-margin);\n  display: flex;\n  max-height: calc(100vh - (2 * var(--page-margin)));\n}\n@media (max-width: 600px) {\n  .dialog__position {\n    inset: var(--page-margin);\n    padding: 0;\n  }\n}\n\n.dialog__position:has(.editor) {\n  inset: var(--page-margin);\n  padding: 0;\n}\n\n.dialog:not([open]) {\n  opacity: 0;\n  pointer-events: none;\n  visibility: hidden;\n}\n.dialog:not([open]) .dialog__content {\n  transform: translate(0, -16px) scale(0.98);\n}\n\n.dialog__content {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n  padding: var(--dialog-padding, 24px);\n  max-width: 100%;\n  width: 100%;\n  max-height: 100%;\n  overflow: auto;\n\n  background: var(--dialog-background, var(--background));\n  border-radius: var(--dialog-border-radius, 20px);\n  border: var(--dialog-border, var(--border));\n  box-shadow: var(--dialog-box-shadow, var(--box-shadow));\n  transform: translate(0, 0) scale(1);\n  transition: transform 0.2s ease-in-out;\n}\n\n\n\n.dialog__header {\n  display: flex;\n  gap: 4px;\n  justify-content: space-between;\n  font-weight: var(--dialog-header-weight, 600);\n  margin: 0;\n}\n.dialog__title {\n  align-self: center;\n  width: var(--form-width, 272px);\n}\n\n@media (max-width: 600px) {\n  .dialog__title {\n    width: auto;\n  }\n}\n\n.dialog__position:has(.editor) .dialog__title {\n  width: auto;\n}\n\n\n.brand-link {\n  display: inline-flex;\n}\n.brand-link:focus-visible {\n  outline: var(--outline);\n}\n\n\n.form {\n  display: flex;\n  overflow: auto;\n  flex-direction: row;\n  gap: 16px;\n  flex: 1 0;\n}\n\n.form fieldset {\n  border: none;\n  margin: 0;\n  padding: 0;\n}\n\n.form__right {\n  flex: 0 0 auto;\n  display: flex;\n  overflow: auto;\n  flex-direction: column;\n  justify-content: space-between;\n  gap: 20px;\n  width: var(--form-width, 100%);\n}\n\n.dialog__position:has(.editor) .form__right {\n  width: var(--form-width, 272px);\n}\n\n.form__top {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.form__error-container {\n  color: var(--error-color);\n  fill: var(--error-color);\n}\n\n.form__label {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  margin: 0px;\n}\n\n.form__label__text {\n  display: flex;\n  gap: 4px;\n  align-items: center;\n}\n\n.form__label__text--required {\n  font-size: 0.85em;\n}\n\n.form__input {\n  font-family: inherit;\n  line-height: inherit;\n  background: transparent;\n  box-sizing: border-box;\n  border: var(--input-border, var(--border));\n  border-radius: var(--input-border-radius, 6px);\n  color: var(--input-color, inherit);\n  fill: var(--input-color, inherit);\n  font-size: var(--input-font-size, inherit);\n  font-weight: var(--input-font-weight, 500);\n  padding: 6px 12px;\n}\n\n.form__input::placeholder {\n  opacity: 0.65;\n  color: var(--input-placeholder-color, inherit);\n  filter: var(--interactive-filter);\n}\n\n.form__input:focus-visible {\n  outline: var(--input-focus-outline, var(--outline));\n}\n\n.form__input--textarea {\n  font-family: inherit;\n  resize: vertical;\n}\n\n.error {\n  color: var(--error-color);\n  fill: var(--error-color);\n}\n\n\n.btn-group {\n  display: grid;\n  gap: 8px;\n}\n\n.btn {\n  line-height: inherit;\n  border: var(--button-border, var(--border));\n  border-radius: var(--button-border-radius, 6px);\n  cursor: pointer;\n  font-family: inherit;\n  font-size: var(--button-font-size, inherit);\n  font-weight: var(--button-font-weight, 600);\n  padding: var(--button-padding, 6px 16px);\n}\n.btn[disabled] {\n  opacity: 0.6;\n  pointer-events: none;\n}\n\n.btn--primary {\n  color: var(--button-primary-color, var(--accent-foreground));\n  fill: var(--button-primary-color, var(--accent-foreground));\n  background: var(--button-primary-background, var(--accent-background));\n  border: var(--button-primary-border, var(--border));\n  border-radius: var(--button-primary-border-radius, 6px);\n  font-weight: var(--button-primary-font-weight, 500);\n}\n.btn--primary:hover {\n  color: var(--button-primary-hover-color, var(--accent-foreground));\n  fill: var(--button-primary-hover-color, var(--accent-foreground));\n  background: var(--button-primary-hover-background, var(--accent-background));\n  filter: var(--interactive-filter);\n}\n.btn--primary:focus-visible {\n  background: var(--button-primary-hover-background, var(--accent-background));\n  filter: var(--interactive-filter);\n  outline: var(--button-primary-focus-outline, var(--outline));\n}\n\n.btn--default {\n  color: var(--button-color, var(--foreground));\n  fill: var(--button-color, var(--foreground));\n  background: var(--button-background, var(--background));\n  border: var(--button-border, var(--border));\n  border-radius: var(--button-border-radius, 6px);\n  font-weight: var(--button-font-weight, 500);\n}\n.btn--default:hover {\n  color: var(--button-color, var(--foreground));\n  fill: var(--button-color, var(--foreground));\n  background: var(--button-hover-background, var(--background));\n  filter: var(--interactive-filter);\n}\n.btn--default:focus-visible {\n  background: var(--button-hover-background, var(--background));\n  filter: var(--interactive-filter);\n  outline: var(--button-focus-outline, var(--outline));\n}\n\n\n.success__position {\n  position: fixed;\n  inset: var(--dialog-inset);\n  padding: var(--page-margin);\n  z-index: var(--z-index);\n}\n.success__content {\n  background: var(--success-background, var(--background));\n  border: var(--success-border, var(--border));\n  border-radius: var(--success-border-radius, 1.7em/50%);\n  box-shadow: var(--success-box-shadow, var(--box-shadow));\n  font-weight: var(--success-font-weight, 600);\n  color: var(--success-color);\n  fill: var(--success-color);\n  padding: 12px 24px;\n  line-height: 1.75em;\n\n  display: grid;\n  align-items: center;\n  grid-auto-flow: column;\n  gap: 6px;\n  cursor: default;\n}\n\n.success__icon {\n  display: flex;\n}\n\n",e&&t.setAttribute("nonce",e),t}(e.styleNonce);let u="";const l={get el(){return a},appendToDom(){r.contains(c)||r.contains(a)||(r.appendChild(c),r.appendChild(a))},removeFromDom(){a.remove(),c.remove(),Mp.body.style.overflow=u},open(){p(!0),e.onFormOpen?.(),Ee()?.emit("openFeedbackWidget"),u=Mp.body.style.overflow,Mp.body.style.overflow="hidden"},close(){p(!1),Mp.body.style.overflow=u}},d=t?.createInput({h:th,hooks:Gh,dialog:l,options:e}),p=t=>{!function(e,t){var n,s,r;zp.__&&zp.__(e,t),n=t.__k,s=[],r=[],yh(t,e=t.__k=th(sh,null,[e]),n||Gp,Gp,void 0!==t.ownerSVGElement,n?null:t.firstChild?Hp.call(t.childNodes):null,s,n?n.__e:t.firstChild,!1,r),e.__d=void 0,bh(s,e,r)}(th(nf,{options:e,screenshotInput:d,showName:e.showName||e.isNameRequired,showEmail:e.showEmail||e.isEmailRequired,defaultName:o&&i?.[o.name]||"",defaultEmail:o&&i?.[o.email]||"",onFormClose:()=>{p(!1),e.onFormClose?.()},onSubmit:n,onSubmitSuccess:(t,n)=>{p(!1),e.onSubmitSuccess?.(t,n)},onSubmitError:t=>{e.onSubmitError?.(t)},onFormSubmitted:()=>{e.onFormSubmitted?.()},open:t}),a)};return l}});function rf(e){const t=Mp.createElement("style"),n="#1A141F",s="#302735";return t.textContent=`\n.editor {\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n}\n\n.editor__image-container {\n  justify-items: center;\n  padding: 15px;\n  position: relative;\n  height: 100%;\n  border-radius: var(--menu-border-radius, 6px);\n\n  background-color: ${n};\n  background-image: repeating-linear-gradient(\n      -145deg,\n      transparent,\n      transparent 8px,\n      ${n} 8px,\n      ${n} 11px\n    ),\n    repeating-linear-gradient(\n      -45deg,\n      transparent,\n      transparent 15px,\n      ${s} 15px,\n      ${s} 16px\n    );\n}\n\n.editor__canvas-container {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.editor__canvas-container > * {\n  object-fit: contain;\n  position: absolute;\n}\n\n.editor__tool-container {\n  padding-top: 8px;\n  display: flex;\n  justify-content: center;\n}\n\n.editor__tool-bar {\n  display: flex;\n  gap: 8px;\n}\n\n.editor__tool {\n  display: flex;\n  padding: 8px 12px;\n  justify-content: center;\n  align-items: center;\n  border: var(--button-border, var(--border));\n  border-radius: var(--button-border-radius, 6px);\n  background: var(--button-background, var(--background));\n  color: var(--button-color, var(--foreground));\n}\n\n.editor__tool--active {\n  background: var(--button-primary-background, var(--accent-background));\n  color: var(--button-primary-color, var(--accent-foreground));\n}\n\n.editor__rect {\n  position: absolute;\n  z-index: 2;\n}\n\n.editor__rect button {\n  opacity: 0;\n  position: absolute;\n  top: -12px;\n  right: -12px;\n  cursor: pointer;\n  padding: 0;\n  z-index: 3;\n  border: none;\n  background: none;\n}\n\n.editor__rect:hover button {\n  opacity: 1;\n}\n`,e&&t.setAttribute("nonce",e),t}function of(e,t,n){if(!e)return;const s=e.getContext("2d",t);s&&n(e,s)}function af(e,t){of(e,{alpha:!0},(e,n)=>{n.drawImage(t,0,0,t.width,t.height,0,0,e.width,e.height)})}function cf(e,t,n){of(e,{alpha:!0},(e,s)=>{n.length&&(s.fillStyle="rgba(0, 0, 0, 0.25)",s.fillRect(0,0,e.width,e.height)),n.forEach(e=>{!function(e,t,n){switch(e.type){case"highlight":t.shadowColor="rgba(0, 0, 0, 0.7)",t.shadowBlur=50,t.fillStyle=n,t.fillRect(e.x-1,e.y-1,e.w+2,e.h+2),t.clearRect(e.x,e.y,e.w,e.h);break;case"hide":t.fillStyle="rgb(0, 0, 0)",t.fillRect(e.x,e.y,e.w,e.h)}}(e,s,t)})})}function uf({h:e,hooks:t,outputBuffer:n,dialog:s,options:r}){const o=function({hooks:e}){return function({onBeforeScreenshot:t,onScreenshot:n,onAfterScreenshot:s,onError:r}){const o=function(){const[t,n]=e.useState(Cp.devicePixelRatio??1);return e.useEffect(()=>{const e=()=>{n(Cp.devicePixelRatio)},t=matchMedia(`(resolution: ${Cp.devicePixelRatio}dppx)`);return t.addEventListener("change",e),()=>{t.removeEventListener("change",e)}},[]),t}();e.useEffect(()=>{(async()=>{t();const e=await Rp.mediaDevices.getDisplayMedia({video:{width:Cp.innerWidth*o,height:Cp.innerHeight*o},audio:!1,monitorTypeSurfaces:"exclude",preferCurrentTab:!0,selfBrowserSurface:"include",surfaceSwitching:"exclude"}),r=Mp.createElement("video");await new Promise((t,s)=>{r.srcObject=e,r.onloadedmetadata=()=>{n(r,o),e.getTracks().forEach(e=>e.stop()),t()},r.play().catch(s)}),s()})().catch(r)},[])}}({hooks:t}),i=function({h:e}){return function({action:t,setAction:n,options:s}){return e("div",{class:"editor__tool-container"},e("div",{class:"editor__tool-bar"},e("button",{type:"button",class:"editor__tool "+("highlight"===t?"editor__tool--active":""),onClick:()=>{n("highlight"===t?"":"highlight")}},s.highlightToolText),e("button",{type:"button",class:"editor__tool "+("hide"===t?"editor__tool--active":""),onClick:()=>{n("hide"===t?"":"hide")}},s.hideToolText)))}}({h:e}),a=function({h:e}){return function(){return e("svg",{"data-test-id":"icon-close",viewBox:"0 0 16 16",fill:"#2B2233",height:"25px",width:"25px"},e("circle",{r:"7",cx:"8",cy:"8",fill:"white"}),e("path",{strokeWidth:"1.5",d:"M8,16a8,8,0,1,1,8-8A8,8,0,0,1,8,16ZM8,1.53A6.47,6.47,0,1,0,14.47,8,6.47,6.47,0,0,0,8,1.53Z"}),e("path",{strokeWidth:"1.5",d:"M5.34,11.41a.71.71,0,0,1-.53-.22.74.74,0,0,1,0-1.06l5.32-5.32a.75.75,0,0,1,1.06,1.06L5.87,11.19A.74.74,0,0,1,5.34,11.41Z"}),e("path",{strokeWidth:"1.5",d:"M10.66,11.41a.74.74,0,0,1-.53-.22L4.81,5.87A.75.75,0,0,1,5.87,4.81l5.32,5.32a.74.74,0,0,1,0,1.06A.71.71,0,0,1,10.66,11.41Z"}))}}({h:e}),c={__html:rf(r.styleNonce).innerText},u=s.el.style,l=({screenshot:s})=>{const[o,u]=t.useState("highlight"),[l,d]=t.useState([]),p=t.useRef(null),h=t.useRef(null),f=t.useRef(null),m=t.useRef(null),[g,y]=t.useState(1),b=t.useMemo(()=>{const e=Mp.getElementById(r.id);if(!e)return"white";const t=getComputedStyle(e);return t.getPropertyValue("--button-primary-background")||t.getPropertyValue("--accent-background")},[r.id]);t.useLayoutEffect(()=>{const e=()=>{const t=p.current;t&&(of(s.canvas,{alpha:!1},e=>{const n=Math.min(t.clientWidth/e.width,t.clientHeight/e.height);y(n)}),0!==t.clientHeight&&0!==t.clientWidth||setTimeout(e,0))};return e(),Cp.addEventListener("resize",e),()=>{Cp.removeEventListener("resize",e)}},[s]);const v=t.useCallback((e,t)=>{of(e,{alpha:!0},(e,n)=>{n.scale(t,t),e.width=s.canvas.width,e.height=s.canvas.height})},[s]);t.useEffect(()=>{v(h.current,s.dpi),af(h.current,s.canvas)},[s]),t.useEffect(()=>{v(f.current,s.dpi),of(f.current,{alpha:!0},(e,t)=>{t.clearRect(0,0,e.width,e.height)}),cf(f.current,b,l)},[l,b]),t.useEffect(()=>{v(n,s.dpi),af(n,s.canvas),of(Mp.createElement("canvas"),{alpha:!0},(e,t)=>{t.scale(s.dpi,s.dpi),e.width=s.canvas.width,e.height=s.canvas.height,cf(e,b,l),af(n,e)})},[l,s,b]);const _=t.useCallback(e=>t=>{t.preventDefault(),t.stopPropagation(),d(t=>{const n=[...t];return n.splice(e,1),n})},[]),S={width:s.canvas.width*g+"px",height:s.canvas.height*g+"px"},w=e=>{e.stopPropagation()};return e("div",{class:"editor"},e("style",{nonce:r.styleNonce,dangerouslySetInnerHTML:c}),e("div",{class:"editor__image-container"},e("div",{class:"editor__canvas-container",ref:p},e("canvas",{ref:h,id:"background",style:S}),e("canvas",{ref:f,id:"foreground",style:S}),e("div",{ref:m,onMouseDown:e=>{if(!o||!m.current)return;const t=m.current.getBoundingClientRect(),n={type:o,x:e.offsetX/g,y:e.offsetY/g},s=(e,n)=>{const s=(n.clientX-t.x)/g,r=(n.clientY-t.y)/g;return{type:e.type,x:Math.min(e.x,s),y:Math.min(e.y,r),w:Math.abs(s-e.x),h:Math.abs(r-e.y)}},r=e=>{of(f.current,{alpha:!0},(e,t)=>{t.clearRect(0,0,e.width,e.height)}),cf(f.current,b,[...l,s(n,e)])},i=e=>{const t=s(n,e);t.w*g>=1&&t.h*g>=1&&d(e=>[...e,t]),Mp.removeEventListener("mousemove",r),Mp.removeEventListener("mouseup",i)};Mp.addEventListener("mousemove",r),Mp.addEventListener("mouseup",i)},style:S},l.map((t,n)=>e("div",{key:n,class:"editor__rect",style:{top:t.y*g+"px",left:t.x*g+"px",width:t.w*g+"px",height:t.h*g+"px"}},e("button",{"aria-label":r.removeHighlightText,onClick:_(n),onMouseDown:w,onMouseUp:w,type:"button"},e(a,null))))))),e(i,{options:r,action:o,setAction:u}))};return function({onError:s}){const[r,i]=t.useState();return o({onBeforeScreenshot:t.useCallback(()=>{u.display="none"},[]),onScreenshot:t.useCallback((e,t)=>{of(Mp.createElement("canvas"),{alpha:!1},(n,s)=>{s.scale(t,t),n.width=e.videoWidth,n.height=e.videoHeight,s.drawImage(e,0,0,n.width,n.height),i({canvas:n,dpi:t})}),n.width=e.videoWidth,n.height=e.videoHeight},[]),onAfterScreenshot:t.useCallback(()=>{u.display="block"},[]),onError:t.useCallback(e=>{u.display="block",s(e)},[])}),r?e(l,{screenshot:r}):e("div",null)}}const lf=()=>({name:"FeedbackScreenshot",setupOnce(){},createInput:({h:e,hooks:t,dialog:n,options:s})=>{const r=Mp.createElement("canvas");return{input:uf({h:e,hooks:t,outputBuffer:r,dialog:n,options:s}),value:async()=>{const e=await new Promise(e=>{r.toBlob(e,"image/png")});if(e)return{data:new Uint8Array(await e.arrayBuffer()),filename:"screenshot.png",contentType:"application/png"}}}}}),df={replayIntegration:"replay",replayCanvasIntegration:"replay-canvas",feedbackIntegration:"feedback",feedbackModalIntegration:"feedback-modal",feedbackScreenshotIntegration:"feedback-screenshot",captureConsoleIntegration:"captureconsole",contextLinesIntegration:"contextlines",linkedErrorsIntegration:"linkederrors",dedupeIntegration:"dedupe",extraErrorDataIntegration:"extraerrordata",graphqlClientIntegration:"graphqlclient",httpClientIntegration:"httpclient",reportingObserverIntegration:"reportingobserver",rewriteFramesIntegration:"rewriteframes",browserProfilingIntegration:"browserprofiling",moduleMetadataIntegration:"modulemetadata",instrumentAnthropicAiClient:"instrumentanthropicaiclient",instrumentOpenAiClient:"instrumentopenaiclient",instrumentGoogleGenAIClient:"instrumentgooglegenaiclient"},pf=ar;async function hf(e,t){const n=df[e],s=pf.Sentry=pf.Sentry||{};if(!n)throw new Error(`Cannot lazy load integration: ${e}`);const r=s[e];if("function"==typeof r&&!("_isShim"in r))return r;const i=function(e){const t=Ee(),n=t?.getOptions()?.cdnBaseUrl||"https://browser.sentry-cdn.com";return new URL(`/${o}/${e}.min.js`,n).toString()}(n),a=ar.document.createElement("script");a.src=i,a.crossOrigin="anonymous",a.referrerPolicy="strict-origin",t&&a.setAttribute("nonce",t);const c=new Promise((e,t)=>{a.addEventListener("load",()=>e()),a.addEventListener("error",t)}),u=ar.document.currentScript,l=ar.document.body||ar.document.head||u?.parentElement;if(!l)throw new Error(`Could not find parent element to insert lazy-loaded ${e} script`);l.appendChild(a);try{await c}catch{throw new Error(`Error when loading integration: ${e}`)}const d=s[e];if("function"!=typeof d)throw new Error(`Could not load integration: ${e}`);return d}const ff=Bp({lazyLoadIntegration:hf}),mf=Bp({getModalIntegration:()=>sf,getScreenshotIntegration:()=>lf}),gf=(e={})=>{const t=e.levels||R,n=e.handled??!0;return{name:"CaptureConsole",setup(e){"console"in i&&br(({args:s,level:r})=>{Ee()===e&&t.includes(r)&&function(e,t,n){const s={level:Or(t),extra:{arguments:e}};xe(r=>{if(r.addEventProcessor(e=>(e.logger="console",Z(e,{handled:n,type:"auto.core.capture_console"}),e)),"assert"===t){if(!e[0]){const t=`Assertion failed: ${j(e.slice(1)," ")||"console.assert"}`;r.setExtra("arguments",e.slice(1)),zs(t,s)}return}const o=e.find(e=>e instanceof Error);o?Hs(o,s):zs(j(e," "),s)})}(s,r,n)})}}};function yf(e,t,n){return"util"in i&&"function"==typeof i.util.format?i.util.format(...e):function(e,t,n){return e.map(e=>y(e)?String(e):JSON.stringify(bn(e,t,n))).join(" ")}(e,t,n)}function bf(e,t){const n={},s=new Array(t.length).fill("{}").join(" ");return n["sentry.message.template"]=`${e} ${s}`,t.forEach((e,t)=>{n[`sentry.message.parameter.${t}`]=e}),n}const vf={[yt]:"auto.console.logging"},_f=(e={})=>{const t=e.levels||R;return{name:"ConsoleLogs",setup(e){const{enableLogs:n,normalizeDepth:s=3,normalizeMaxBreadth:o=1e3}=e.getOptions();n?br(({args:n,level:r})=>{if(Ee()!==e||!t.includes(r))return;const i=n[0],a=n.slice(1);if("assert"===r)return void(i||qn({level:"error",message:a.length>0?`Assertion failed: ${yf(a,s,o)}`:"Assertion failed",attributes:vf}));const c="log"===r,u=n.length>1&&"string"==typeof n[0]&&(l=n[0],!/%[sdifocO]/.test(l));var l;const d={...vf,...u?bf(i,a):{}};qn({level:c?"info":r,message:yf(n,s,o),severityNumber:c?10:void 0,attributes:d})}):r&&P.warn("`enableLogs` is not enabled, ConsoleLogs integration disabled")}}},Sf=["trace","debug","info","warn","error","fatal"];function wf(e={}){const t=new Set(e.levels??Sf),n=e.client;return{log(e){const{type:s,level:r,message:o,args:i,tag:a,date:c,...u}=e,l=n||Ee();if(!l)return;const d=function(e,t){if("verbose"===e)return"debug";if("silent"===e)return"trace";if(e){const t=kf[e];if(t)return t}if("number"==typeof t){const e=xf[t];if(e)return e}return"info"}(s,r);if(!t.has(d))return;const{normalizeDepth:p=3,normalizeMaxBreadth:h=1e3}=l.getOptions(),f=[];o&&f.push(o),i&&i.length>0&&f.push(yf(i,p,h));const m=f.join(" ");u["sentry.origin"]="auto.logging.consola",a&&(u["consola.tag"]=a),s&&(u["consola.type"]=s),null!=r&&"number"==typeof r&&(u["consola.level"]=r),qn({level:d,message:m,attributes:u})}}}const kf={silent:"trace",fatal:"fatal",error:"error",warn:"warn",log:"info",info:"info",success:"info",fail:"error",ready:"info",start:"info",box:"info",debug:"debug",trace:"trace",verbose:"debug",critical:"fatal",notice:"info"},xf={0:"fatal",1:"warn",2:"info",3:"info",4:"debug",5:"trace"},Tf=(e={})=>{const{depth:t=3,captureErrorCause:n=!0}=e;return{name:"ExtraErrorData",processEvent(e,s,r){const{maxValueLength:o=250}=r.getOptions();return function(e,t={},n,s,r){if(!t.originalException||!d(t.originalException))return e;const o=t.originalException.name||t.originalException.constructor.name,i=Ef(t.originalException,s,r);if(i){const t={...e.contexts},s=bn(i,n);return b(s)&&(z(s,"__sentry_skip_normalization__",!0),t[o]=s),{...e,contexts:t}}return e}(e,s,t,n,o)}}};function Ef(e,t,n){try{const s=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],r={};for(const t of Object.keys(e)){if(-1!==s.indexOf(t))continue;const o=e[t];r[t]=d(o)||"string"==typeof o?F(`${o}`,n):o}if(t&&void 0!==e.cause)if(d(e.cause)){const t=e.cause.name||e.cause.constructor.name;r.cause={[t]:Ef(e.cause,!1,n)}}else r.cause=e.cause;if("function"==typeof e.toJSON){const t=e.toJSON();for(const e of Object.keys(t)){const n=t[e];r[e]=d(n)?n.toString():n}}return r}catch(e){r&&P.error("Unable to extract extra data from the Error object:",e)}return null}const If=()=>({name:"FeatureFlags",processEvent:(e,t,n)=>wp(e),addFeatureFlag(e,t){kp(e,t),xp(e,t)}}),Cf="gen_ai.prompt",Mf="gen_ai.system",Rf="gen_ai.request.model",Of="gen_ai.request.stream",Af="gen_ai.request.temperature",Nf="gen_ai.request.max_tokens",Df="gen_ai.request.frequency_penalty",Lf="gen_ai.request.presence_penalty",Pf="gen_ai.request.top_p",Ff="gen_ai.request.top_k",$f="gen_ai.response.finish_reasons",jf="gen_ai.response.model",Bf="gen_ai.response.id",Uf="gen_ai.usage.input_tokens",Hf="gen_ai.usage.output_tokens",zf="gen_ai.usage.total_tokens",qf="gen_ai.operation.name",Wf="gen_ai.request.messages",Vf="gen_ai.response.text",Jf="gen_ai.request.available_tools",Kf="gen_ai.response.streaming",Gf="gen_ai.response.tool_calls",Xf="openai.response.id",Yf="openai.response.model",Qf="openai.response.timestamp",Zf="openai.usage.completion_tokens",em="openai.usage.prompt_tokens",tm={CHAT:"chat",RESPONSES:"responses"},nm="anthropic.response.timestamp";function sm(e){return e.includes("messages")?"messages":e.includes("completions")?"completions":e.includes("models")?"models":e.includes("chat")?"chat":e.split(".").pop()||"unknown"}function rm(e){return`gen_ai.${sm(e)}`}function om(e,t){return e?`${e}.${t}`:t}function im(e,t,n,s,r){if(void 0!==t&&e.setAttributes({[Uf]:t}),void 0!==n&&e.setAttributes({[Hf]:n}),void 0!==t||void 0!==n||void 0!==s||void 0!==r){const o=(t??0)+(n??0)+(s??0)+(r??0);e.setAttributes({[zf]:o})}}function am(e,t,n,s){if(!e||"object"!=typeof e)return;const r=function(e,t){return"type"in e&&"string"==typeof e.type&&"error"===e.type&&(t.setStatus({code:Dt,message:e.error?.type??"unknown_error"}),Hs(e.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}),!0)}(e,s);r||(function(e,t){if("message_delta"===e.type&&e.usage&&"output_tokens"in e.usage&&"number"==typeof e.usage.output_tokens&&(t.completionTokens=e.usage.output_tokens),e.message){const n=e.message;n.id&&(t.responseId=n.id),n.model&&(t.responseModel=n.model),n.stop_reason&&t.finishReasons.push(n.stop_reason),n.usage&&("number"==typeof n.usage.input_tokens&&(t.promptTokens=n.usage.input_tokens),"number"==typeof n.usage.cache_creation_input_tokens&&(t.cacheCreationInputTokens=n.usage.cache_creation_input_tokens),"number"==typeof n.usage.cache_read_input_tokens&&(t.cacheReadInputTokens=n.usage.cache_read_input_tokens))}}(e,t),function(e,t){"content_block_start"===e.type&&"number"==typeof e.index&&e.content_block&&("tool_use"!==e.content_block.type&&"server_tool_use"!==e.content_block.type||(t.activeToolBlocks[e.index]={id:e.content_block.id,name:e.content_block.name,inputJsonParts:[]}))}(e,t),function(e,t,n){if("content_block_delta"===e.type&&e.delta){if("number"==typeof e.index&&"partial_json"in e.delta&&"string"==typeof e.delta.partial_json){const n=t.activeToolBlocks[e.index];n&&n.inputJsonParts.push(e.delta.partial_json)}n&&"string"==typeof e.delta.text&&t.responseTexts.push(e.delta.text)}}(e,t,n),function(e,t){if("content_block_stop"!==e.type||"number"!=typeof e.index)return;const n=t.activeToolBlocks[e.index];if(!n)return;const s=n.inputJsonParts.join("");let r;try{r=s?JSON.parse(s):{}}catch{r={__unparsed:s}}t.toolCalls.push({type:"tool_use",id:n.id,name:n.name,input:r}),delete t.activeToolBlocks[e.index]}(e,t))}const cm=["messages.create","messages.stream","messages.countTokens","models.get","completions.create","models.retrieve","beta.messages.create"];function um(e,t){"messages"in t&&e.setAttributes({[Wf]:JSON.stringify(t.messages)}),"input"in t&&e.setAttributes({[Wf]:JSON.stringify(t.input)}),"prompt"in t&&e.setAttributes({[Cf]:JSON.stringify(t.prompt)})}function lm(e,t,n){throw Hs(e,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:n}}}),t.isRecording()&&(t.setStatus({code:Dt,message:"internal_error"}),t.end()),e}function dm(e,t,n,s,r,o,i,a,c,u){return di({name:`${o} ${r[Rf]??"unknown"} stream-response`,op:rm(i),attributes:r},u?async t=>{try{return c.recordInputs&&a&&um(t,a),async function*(e,t,n){const s={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};try{for await(const r of e)am(r,s,n,t),yield r}finally{s.responseId&&t.setAttributes({[Bf]:s.responseId}),s.responseModel&&t.setAttributes({[jf]:s.responseModel}),im(t,s.promptTokens,s.completionTokens,s.cacheCreationInputTokens,s.cacheReadInputTokens),t.setAttributes({[Kf]:!0}),s.finishReasons.length>0&&t.setAttributes({[$f]:JSON.stringify(s.finishReasons)}),n&&s.responseTexts.length>0&&t.setAttributes({[Vf]:s.responseTexts.join("")}),n&&s.toolCalls.length>0&&t.setAttributes({[Gf]:JSON.stringify(s.toolCalls)}),t.end()}}(await e.apply(n,s),t,c.recordOutputs??!1)}catch(e){return lm(e,t,i)}}:e=>{try{return c.recordInputs&&a&&um(e,a),function(e,t,n){const s={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};return e.on("streamEvent",e=>{am(e,s,n,t)}),e.on("message",()=>{!function(e,t,n){t.isRecording()&&(e.responseId&&t.setAttributes({[Bf]:e.responseId}),e.responseModel&&t.setAttributes({[jf]:e.responseModel}),im(t,e.promptTokens,e.completionTokens,e.cacheCreationInputTokens,e.cacheReadInputTokens),t.setAttributes({[Kf]:!0}),e.finishReasons.length>0&&t.setAttributes({[$f]:JSON.stringify(e.finishReasons)}),n&&e.responseTexts.length>0&&t.setAttributes({[Vf]:e.responseTexts.join("")}),n&&e.toolCalls.length>0&&t.setAttributes({[Gf]:JSON.stringify(e.toolCalls)}),t.end())}(s,t,n)}),e.on("error",e=>{Hs(e,{mechanism:{handled:!1,type:"auto.ai.anthropic.stream_error"}}),t.isRecording()&&(t.setStatus({code:Dt,message:"stream_error"}),t.end())}),e}(t.apply(n,s),e,c.recordOutputs??!1)}catch(t){return lm(t,e,i)}})}function pm(e,t,n,s){return new Proxy(e,{apply(r,o,i){const a=function(e,t){const n={[Mf]:"anthropic",[qf]:sm(t),[yt]:"auto.ai.anthropic"};if(e.length>0&&"object"==typeof e[0]&&null!==e[0]){const t=e[0];t.tools&&Array.isArray(t.tools)&&(n[Jf]=JSON.stringify(t.tools)),n[Rf]=t.model??"unknown","temperature"in t&&(n[Af]=t.temperature),"top_p"in t&&(n[Pf]=t.top_p),"stream"in t&&(n[Of]=t.stream),"top_k"in t&&(n[Ff]=t.top_k),"frequency_penalty"in t&&(n[Df]=t.frequency_penalty),"max_tokens"in t&&(n[Nf]=t.max_tokens)}else n[Rf]="models.retrieve"===t||"models.get"===t?e[0]:"unknown";return n}(i,t),c=a[Rf]??"unknown",u=sm(t),l="object"==typeof i[0]?i[0]:void 0,d=Boolean(l?.stream);return d||"messages.stream"===t?dm(e,r,n,i,a,u,t,l,s,d):li({name:`${u} ${c}`,op:rm(t),attributes:a},e=>(s.recordInputs&&l&&um(e,l),ci(()=>r.apply(n,i),e=>{Hs(e,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:t}}})},()=>{},t=>function(e,t,n){t&&"object"==typeof t&&("type"in t&&"error"===t.type?function(e,t){t.error&&(e.setStatus({code:Dt,message:t.error.type||"unknown_error"}),Hs(t.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}))}(e,t):(n&&function(e,t){if("content"in t&&Array.isArray(t.content)){e.setAttributes({[Vf]:t.content.map(e=>e.text).filter(e=>!!e).join("")});const n=[];for(const e of t.content)"tool_use"!==e.type&&"server_tool_use"!==e.type||n.push(e);n.length>0&&e.setAttributes({[Gf]:JSON.stringify(n)})}"completion"in t&&e.setAttributes({[Vf]:t.completion}),"input_tokens"in t&&e.setAttributes({[Vf]:JSON.stringify(t.input_tokens)})}(e,t),function(e,t){"id"in t&&"model"in t&&(e.setAttributes({[Bf]:t.id,[jf]:t.model}),"created"in t&&"number"==typeof t.created&&e.setAttributes({[nm]:new Date(1e3*t.created).toISOString()}),"created_at"in t&&"number"==typeof t.created_at&&e.setAttributes({[nm]:new Date(1e3*t.created_at).toISOString()}),"usage"in t&&t.usage&&im(e,t.usage.input_tokens,t.usage.output_tokens,t.usage.cache_creation_input_tokens,t.usage.cache_read_input_tokens))}(e,t)))}(e,t,s.recordOutputs))))}})}function hm(e,t="",n){return new Proxy(e,{get(e,s){const r=e[s],o=om(t,String(s));return"function"==typeof r&&function(e){return cm.includes(e)}(o)?pm(r,o,e,n):"function"==typeof r?r.bind(e):r&&"object"==typeof r?hm(r,o,n):r}})}function fm(e,t){const n=Boolean(Ee()?.getOptions().sendDefaultPii);return hm(e,"",{recordInputs:n,recordOutputs:n,...t})}const mm=["models.generateContent","models.generateContentStream","chats.create","sendMessage","sendMessageStream"],gm="google_genai",ym="chats.create",bm="chat";function vm(e,t,n,s){e&&!function(e,t){const n=e?.promptFeedback;if(n?.blockReason){const e=n.blockReasonMessage??n.blockReason;return t.setStatus({code:Dt,message:`Content blocked: ${e}`}),Hs(`Content blocked: ${e}`,{mechanism:{handled:!1,type:"auto.ai.google_genai"}}),!0}return!1}(e,s)&&(function(e,t){"string"==typeof e.responseId&&(t.responseId=e.responseId),"string"==typeof e.modelVersion&&(t.responseModel=e.modelVersion);const n=e.usageMetadata;n&&("number"==typeof n.promptTokenCount&&(t.promptTokens=n.promptTokenCount),"number"==typeof n.candidatesTokenCount&&(t.completionTokens=n.candidatesTokenCount),"number"==typeof n.totalTokenCount&&(t.totalTokens=n.totalTokenCount))}(e,t),function(e,t,n){Array.isArray(e.functionCalls)&&t.toolCalls.push(...e.functionCalls);for(const s of e.candidates??[]){s?.finishReason&&!t.finishReasons.includes(s.finishReason)&&t.finishReasons.push(s.finishReason);for(const e of s?.content?.parts??[])n&&e.text&&t.responseTexts.push(e.text),e.functionCall&&t.toolCalls.push({type:"function",id:e.functionCall.id,name:e.functionCall.name,arguments:e.functionCall.args})}}(e,t,n))}function _m(e,t){if("model"in e&&"string"==typeof e.model)return e.model;if(t&&"object"==typeof t){const e=t;if("model"in e&&"string"==typeof e.model)return e.model;if("modelVersion"in e&&"string"==typeof e.modelVersion)return e.modelVersion}return"unknown"}function Sm(e,t){"contents"in t&&e.setAttributes({[Wf]:JSON.stringify(t.contents)}),"message"in t&&e.setAttributes({[Wf]:JSON.stringify(t.message)}),"history"in t&&e.setAttributes({[Wf]:JSON.stringify(t.history)})}function wm(e,t,n,s){const r=t===ym;return new Proxy(e,{apply(e,o,i){const a=i[0],c=function(e,t,n){const s={[Mf]:gm,[qf]:sm(e),[yt]:"auto.ai.google_genai"};if(t){if(s[Rf]=_m(t,n),"config"in t&&"object"==typeof t.config&&t.config){const e=t.config;if(Object.assign(s,function(e){const t={};return"temperature"in e&&"number"==typeof e.temperature&&(t[Af]=e.temperature),"topP"in e&&"number"==typeof e.topP&&(t[Pf]=e.topP),"topK"in e&&"number"==typeof e.topK&&(t[Ff]=e.topK),"maxOutputTokens"in e&&"number"==typeof e.maxOutputTokens&&(t[Nf]=e.maxOutputTokens),"frequencyPenalty"in e&&"number"==typeof e.frequencyPenalty&&(t[Df]=e.frequencyPenalty),"presencePenalty"in e&&"number"==typeof e.presencePenalty&&(t[Lf]=e.presencePenalty),t}(e)),"tools"in e&&Array.isArray(e.tools)){const t=e.tools.map(e=>e.functionDeclarations);s[Jf]=JSON.stringify(t)}}}else s[Rf]=_m({},n);return s}(t,a,n),u=c[Rf]??"unknown",l=sm(t);return function(e){return e.includes("Stream")||e.endsWith("generateContentStream")||e.endsWith("sendMessageStream")}(t)?di({name:`${l} ${u} stream-response`,op:rm(t),attributes:c},async r=>{try{return s.recordInputs&&a&&Sm(r,a),async function*(e,t,n){const s={responseTexts:[],finishReasons:[],toolCalls:[]};try{for await(const r of e)vm(r,s,n,t),yield r}finally{const e={[Kf]:!0};s.responseId&&(e[Bf]=s.responseId),s.responseModel&&(e[jf]=s.responseModel),void 0!==s.promptTokens&&(e[Uf]=s.promptTokens),void 0!==s.completionTokens&&(e[Hf]=s.completionTokens),void 0!==s.totalTokens&&(e[zf]=s.totalTokens),s.finishReasons.length&&(e[$f]=JSON.stringify(s.finishReasons)),n&&s.responseTexts.length&&(e[Vf]=s.responseTexts.join("")),n&&s.toolCalls.length&&(e[Gf]=JSON.stringify(s.toolCalls)),t.setAttributes(e),t.end()}}(await e.apply(n,i),r,Boolean(s.recordOutputs))}catch(e){throw r.setStatus({code:Dt,message:"internal_error"}),Hs(e,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:t}}}),r.end(),e}}):li({name:r?`${l} ${u} create`:`${l} ${u}`,op:rm(t),attributes:c},o=>(s.recordInputs&&a&&Sm(o,a),ci(()=>e.apply(n,i),e=>{Hs(e,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:t}}})},()=>{},e=>{r||function(e,t,n){if(t&&"object"==typeof t){if(t.usageMetadata&&"object"==typeof t.usageMetadata){const n=t.usageMetadata;"number"==typeof n.promptTokenCount&&e.setAttributes({[Uf]:n.promptTokenCount}),"number"==typeof n.candidatesTokenCount&&e.setAttributes({[Hf]:n.candidatesTokenCount}),"number"==typeof n.totalTokenCount&&e.setAttributes({[zf]:n.totalTokenCount})}if(n&&Array.isArray(t.candidates)&&t.candidates.length>0){const n=t.candidates.map(e=>e.content?.parts&&Array.isArray(e.content.parts)?e.content.parts.map(e=>"string"==typeof e.text?e.text:"").filter(e=>e.length>0).join(""):"").filter(e=>e.length>0);n.length>0&&e.setAttributes({[Vf]:n.join("")})}if(n&&t.functionCalls){const n=t.functionCalls;Array.isArray(n)&&n.length>0&&e.setAttributes({[Gf]:JSON.stringify(n)})}}}(o,e,s.recordOutputs)})))}})}function km(e,t="",n){return new Proxy(e,{get:(e,s,r)=>{const o=Reflect.get(e,s,r),i=om(t,String(s));if("function"==typeof o&&function(e){if(mm.includes(e))return!0;const t=e.split(".").pop();return mm.includes(t)}(i)){if(i===ym){const t=wm(o,i,e,n);return function(...e){const s=t(...e);return s&&"object"==typeof s?km(s,bm,n):s}}return wm(o,i,e,n)}return"function"==typeof o?o.bind(e):o&&"object"==typeof o?km(o,i,n):o}})}function xm(e,t){const n=Boolean(Ee()?.getOptions().sendDefaultPii);return km(e,"",{recordInputs:n,recordOutputs:n,...t})}const Tm="OpenAI",Em=["responses.create","chat.completions.create"],Im=["response.created","response.in_progress","response.failed","response.completed","response.incomplete","response.queued","response.output_text.delta","response.output_item.added","response.function_call_arguments.delta","response.function_call_arguments.done","response.output_item.done"];function Cm(e){return e.includes("chat.completions")?tm.CHAT:e.includes("responses")?tm.RESPONSES:e.split(".").pop()||"unknown"}function Mm(e){return`gen_ai.${Cm(e)}`}function Rm(e){return null!==e&&"object"==typeof e&&"type"in e&&"string"==typeof e.type&&e.type.startsWith("response.")}function Om(e){return null!==e&&"object"==typeof e&&"object"in e&&"chat.completion.chunk"===e.object}function Am(e,t,n,s){void 0!==t&&e.setAttributes({[em]:t,[Uf]:t}),void 0!==n&&e.setAttributes({[Zf]:n,[Hf]:n}),void 0!==s&&e.setAttributes({[zf]:s})}function Nm(e,t,n,s){e.setAttributes({[Xf]:t,[Bf]:t}),e.setAttributes({[Yf]:n,[jf]:n}),e.setAttributes({[Qf]:new Date(1e3*s).toISOString()})}function Dm(e,t){for(const n of e){const e=n.index;if(void 0!==e&&n.function)if(e in t.chatCompletionToolCalls){const s=t.chatCompletionToolCalls[e];n.function.arguments&&s?.function&&(s.function.arguments+=n.function.arguments)}else t.chatCompletionToolCalls[e]={...n,function:{name:n.function.name,arguments:n.function.arguments||""}}}}function Lm(e,t,n){t.responseId=e.id??t.responseId,t.responseModel=e.model??t.responseModel,t.responseTimestamp=e.created??t.responseTimestamp,e.usage&&(t.promptTokens=e.usage.prompt_tokens,t.completionTokens=e.usage.completion_tokens,t.totalTokens=e.usage.total_tokens);for(const s of e.choices??[])n&&(s.delta?.content&&t.responseTexts.push(s.delta.content),s.delta?.tool_calls&&Dm(s.delta.tool_calls,t)),s.finish_reason&&t.finishReasons.push(s.finish_reason)}function Pm(e,t,n,s){if(!e||"object"!=typeof e)return void t.eventTypes.push("unknown:non-object");if(e instanceof Error)return s.setStatus({code:Dt,message:"internal_error"}),void Hs(e,{mechanism:{handled:!1,type:"auto.ai.openai.stream-response"}});if(!("type"in e))return;const r=e;if(Im.includes(r.type)){if(n&&("response.output_item.done"===r.type&&"item"in r&&t.responsesApiToolCalls.push(r.item),"response.output_text.delta"===r.type&&"delta"in r&&r.delta))t.responseTexts.push(r.delta);else if("response"in r){const{response:e}=r;t.responseId=e.id??t.responseId,t.responseModel=e.model??t.responseModel,t.responseTimestamp=e.created_at??t.responseTimestamp,e.usage&&(t.promptTokens=e.usage.input_tokens,t.completionTokens=e.usage.output_tokens,t.totalTokens=e.usage.total_tokens),e.status&&t.finishReasons.push(e.status),n&&e.output_text&&t.responseTexts.push(e.output_text)}}else t.eventTypes.push(r.type)}function Fm(e,t){"messages"in t&&e.setAttributes({[Wf]:JSON.stringify(t.messages)}),"input"in t&&e.setAttributes({[Wf]:JSON.stringify(t.input)})}function $m(e,t,n,s){return async function(...r){const o=s||function(){const e=Se().getClient(),t=e?.getIntegrationByName(Tm),n=!!t&&Boolean(e?.getOptions().sendDefaultPii);return{recordInputs:t?.options?.recordInputs??n,recordOutputs:t?.options?.recordOutputs??n}}(),i=function(e,t){const n={[Mf]:"openai",[qf]:Cm(t),[yt]:"auto.ai.openai"};if(e.length>0&&"object"==typeof e[0]&&null!==e[0]){const t=e[0],s=[...Array.isArray(t.tools)?t.tools:[],...t.web_search_options&&"object"==typeof t.web_search_options?[{type:"web_search_options",...t.web_search_options}]:[]];s.length>0&&(n[Jf]=JSON.stringify(s))}if(e.length>0&&"object"==typeof e[0]&&null!==e[0]){const t=e[0];n[Rf]=t.model??"unknown","temperature"in t&&(n[Af]=t.temperature),"top_p"in t&&(n[Pf]=t.top_p),"frequency_penalty"in t&&(n[Df]=t.frequency_penalty),"presence_penalty"in t&&(n[Lf]=t.presence_penalty),"stream"in t&&(n[Of]=t.stream)}else n[Rf]="unknown";return n}(r,t),a=i[Rf]||"unknown",c=Cm(t),u=r[0];return u&&"object"==typeof u&&!0===u.stream?di({name:`${c} ${a} stream-response`,op:Mm(t),attributes:i},async s=>{try{return o.recordInputs&&r[0]&&"object"==typeof r[0]&&Fm(s,r[0]),async function*(e,t,n){const s={eventTypes:[],responseTexts:[],finishReasons:[],responseId:"",responseModel:"",responseTimestamp:0,promptTokens:void 0,completionTokens:void 0,totalTokens:void 0,chatCompletionToolCalls:{},responsesApiToolCalls:[]};try{for await(const r of e)Om(r)?Lm(r,s,n):Rm(r)&&Pm(r,s,n,t),yield r}finally{Nm(t,s.responseId,s.responseModel,s.responseTimestamp),Am(t,s.promptTokens,s.completionTokens,s.totalTokens),t.setAttributes({[Kf]:!0}),s.finishReasons.length&&t.setAttributes({[$f]:JSON.stringify(s.finishReasons)}),n&&s.responseTexts.length&&t.setAttributes({[Vf]:s.responseTexts.join("")});const e=[...Object.values(s.chatCompletionToolCalls),...s.responsesApiToolCalls];e.length>0&&t.setAttributes({[Gf]:JSON.stringify(e)}),t.end()}}(await e.apply(n,r),s,o.recordOutputs??!1)}catch(e){throw s.setStatus({code:Dt,message:"internal_error"}),Hs(e,{mechanism:{handled:!1,type:"auto.ai.openai.stream",data:{function:t}}}),s.end(),e}}):li({name:`${c} ${a}`,op:Mm(t),attributes:i},async s=>{try{o.recordInputs&&r[0]&&"object"==typeof r[0]&&Fm(s,r[0]);const t=await e.apply(n,r);return function(e,t,n){if(!t||"object"!=typeof t)return;const s=t;if(function(e){return null!==e&&"object"==typeof e&&"object"in e&&"chat.completion"===e.object}(s)){if(function(e,t,n){if(Nm(e,t.id,t.model,t.created),t.usage&&Am(e,t.usage.prompt_tokens,t.usage.completion_tokens,t.usage.total_tokens),Array.isArray(t.choices)){const s=t.choices.map(e=>e.finish_reason).filter(e=>null!==e);if(s.length>0&&e.setAttributes({[$f]:JSON.stringify(s)}),n){const n=t.choices.map(e=>e.message?.tool_calls).filter(e=>Array.isArray(e)&&e.length>0).flat();n.length>0&&e.setAttributes({[Gf]:JSON.stringify(n)})}}}(e,s,n),n&&s.choices?.length){const t=s.choices.map(e=>e.message?.content||"");e.setAttributes({[Vf]:JSON.stringify(t)})}}else(function(e){return null!==e&&"object"==typeof e&&"object"in e&&"response"===e.object})(s)&&(function(e,t,n){if(Nm(e,t.id,t.model,t.created_at),t.status&&e.setAttributes({[$f]:JSON.stringify([t.status])}),t.usage&&Am(e,t.usage.input_tokens,t.usage.output_tokens,t.usage.total_tokens),n){const n=t;if(Array.isArray(n.output)&&n.output.length>0){const t=n.output.filter(e=>"object"==typeof e&&null!==e&&"function_call"===e.type);t.length>0&&e.setAttributes({[Gf]:JSON.stringify(t)})}}}(e,s,n),n&&s.output_text&&e.setAttributes({[Vf]:s.output_text}))}(s,t,o.recordOutputs),t}catch(e){throw Hs(e,{mechanism:{handled:!1,type:"auto.ai.openai",data:{function:t}}}),e}})}}function jm(e,t="",n){return new Proxy(e,{get(e,s){const r=e[s],o=function(e,t){return e?`${e}.${t}`:t}(t,String(s));return"function"==typeof r&&function(e){return Em.includes(e)}(o)?$m(r,o,e,n):"function"==typeof r?r.bind(e):r&&"object"==typeof r?jm(r,o,n):r}})}function Bm(e,t){return jm(e,"",t)}const Um=["reauthenticate","signInAnonymously","signInWithOAuth","signInWithIdToken","signInWithOtp","signInWithPassword","signInWithSSO","signOut","signUp","verifyOtp"],Hm=["createUser","deleteUser","listUsers","getUserById","updateUserById","inviteUserByEmail"],zm={eq:"eq",neq:"neq",gt:"gt",gte:"gte",lt:"lt",lte:"lte",like:"like","like(all)":"likeAllOf","like(any)":"likeAnyOf",ilike:"ilike","ilike(all)":"ilikeAllOf","ilike(any)":"ilikeAnyOf",is:"is",in:"in",cs:"contains",cd:"containedBy",sr:"rangeGt",nxl:"rangeGte",sl:"rangeLt",nxr:"rangeLte",adj:"rangeAdjacent",ov:"overlaps",fts:"",plfts:"plain",phfts:"phrase",wfts:"websearch",not:"not"},qm=["select","insert","upsert","update","delete"];function Wm(e){try{e.__SENTRY_INSTRUMENTED__=!0}catch{}}function Vm(e){try{return e.__SENTRY_INSTRUMENTED__}catch{return!1}}function Jm(e,t){if(""===t||"*"===t)return"select(*)";if("select"===e)return`select(${t})`;if("or"===e||e.endsWith(".or"))return`${e}${t}`;const[n,...s]=t.split(".");let r;return r=n?.startsWith("fts")?"textSearch":n?.startsWith("plfts")?"textSearch[plain]":n?.startsWith("phfts")?"textSearch[phrase]":n?.startsWith("wfts")?"textSearch[websearch]":n&&zm[n]||"filter",`${r}(${e}, ${s.join(".")})`}function Km(e,t=!1){return new Proxy(e,{apply:(n,s,r)=>li({name:`auth ${t?"(admin) ":""}${e.name}`,attributes:{[yt]:"auto.db.supabase",[gt]:"db","db.system":"postgresql","db.operation":`auth.${t?"admin.":""}${e.name}`}},e=>Reflect.apply(n,s,r).then(t=>(t&&"object"==typeof t&&"error"in t&&t.error?(e.setStatus({code:Dt}),Hs(t.error,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}})):e.setStatus({code:Nt}),e.end(),t)).catch(t=>{throw e.setStatus({code:Dt}),e.end(),Hs(t,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}}),t}).then(...r))})}function Gm(e){Vm(e.prototype.then)||(e.prototype.then=new Proxy(e.prototype.then,{apply(e,t,n){const s=qm,r=t,o=function(e,t={}){switch(e){case"GET":return"select";case"POST":return t.Prefer?.includes("resolution=")?"upsert":"insert";case"PATCH":return"update";case"DELETE":return"delete";default:return"<unknown-op>"}}(r.method,r.headers);if(!s.includes(o))return Reflect.apply(e,t,n);if(!r?.url?.pathname||"string"!=typeof r.url.pathname)return Reflect.apply(e,t,n);const i=r.url.pathname.split("/"),a=i.length>0?i[i.length-1]:"",c=[];for(const[e,t]of r.url.searchParams.entries())c.push(Jm(e,t));const u=Object.create(null);if(b(r.body))for(const[e,t]of Object.entries(r.body))u[e]=t;const l=`${"select"===o?"":`${o}${u?"(...) ":""}`}${c.join(" ")} from(${a})`,d={"db.table":a,"db.schema":r.schema,"db.url":r.url.origin,"db.sdk":r.headers["X-Client-Info"],"db.system":"postgresql","db.operation":o,[yt]:"auto.db.supabase",[gt]:"db"};return c.length&&(d["db.query"]=c),Object.keys(u).length&&(d["db.body"]=u),li({name:l,attributes:d},s=>Reflect.apply(e,t,[]).then(e=>{if(s&&(e&&"object"==typeof e&&"status"in e&&Pt(s,e.status||500),s.end()),e.error){const t=new Error(e.error.message);e.error.code&&(t.code=e.error.code),e.error.details&&(t.details=e.error.details);const n={};c.length&&(n.query=c),Object.keys(u).length&&(n.body=u),Hs(t,e=>(e.addEventProcessor(e=>(Z(e,{handled:!1,type:"auto.db.supabase.postgres"}),e)),e.setContext("supabase",n),e))}const t={type:"supabase",category:`db.${o}`,message:l},n={};return c.length&&(n.query=c),Object.keys(u).length&&(n.body=u),Object.keys(n).length&&(t.data=n),Rr(t),e},e=>{throw s&&(Pt(s,500),s.end()),e}).then(...n))}}),Wm(e.prototype.then))}const Xm=e=>{var t;e?(Vm((t=e.constructor===Function?e:e.constructor).prototype.from)||(t.prototype.from=new Proxy(t.prototype.from,{apply(e,t,n){const s=Reflect.apply(e,t,n);return function(e){for(const t of qm)Vm(e.prototype[t])||(e.prototype[t]=new Proxy(e.prototype[t],{apply(e,n,s){const o=Reflect.apply(e,n,s),i=o.constructor;return r&&P.log(`Instrumenting ${t} operation's PostgRESTFilterBuilder`),Gm(i),o}}),Wm(e.prototype[t]))}(s.constructor),s}}),Wm(t.prototype.from)),function(e){const t=e.auth;if(t&&!Vm(e.auth)){for(const n of Um){const s=t[n];s&&"function"==typeof e.auth[n]&&(e.auth[n]=Km(s))}for(const n of Hm){const s=t.admin[n];s&&"function"==typeof e.auth.admin[n]&&(e.auth.admin[n]=Km(s,!0))}Wm(e.auth)}}(e)):r&&P.warn("Supabase integration was not installed because no Supabase client was provided.")},Ym=e=>{return t=e.supabaseClient,{setupOnce(){Xm(t)},name:"Supabase"};var t};function Qm(e,...t){const n=new String(String.raw(e,...t));return n.__sentry_template_string__=e.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),n.__sentry_template_values__=t,n}const Zm=Qm;function eg(e,t,n,s,r){qn({level:e,message:t,attributes:n,severityNumber:r},s)}function tg(e,t,{scope:n}={}){eg("trace",e,t,n)}function ng(e,t,{scope:n}={}){eg("debug",e,t,n)}function sg(e,t,{scope:n}={}){eg("info",e,t,n)}function rg(e,t,{scope:n}={}){eg("warn",e,t,n)}function og(e,t,{scope:n}={}){eg("error",e,t,n)}function ig(e,t,{scope:n}={}){eg("fatal",e,t,n)}function ag(e,t){let n;return kn(e,(e,s)=>(t.includes(s)&&(n=Array.isArray(e)?e[1]:void 0),!!n)),n}function cg(e,t){return n=>{const s=e(n),r=new Map;function o(t,s){const o=s?`${t}:${s}`:t;let i=r.get(o);if(!i){const a=ot(t);if(!a)return;const c=dt(a,n.tunnel);i=s?function(e,t){return n=>{const s=e(n);return{...s,send:async e=>{const n=ag(e,["event","transaction","profile","replay_event"]);return n&&(n.release=t),s.send(e)}}}}(e,s)({...n,url:c}):e({...n,url:c}),r.set(o,i)}return[t,i]}return{send:async function(e){const n=t({envelope:e,getEvent:function(t){return ag(e,t?.length?t:["event"])}}).map(e=>"string"==typeof e?o(e,void 0):o(e.dsn,e.release)).filter(e=>!!e),r=n.length?n:[["",s]];return(await Promise.all(r.map(([t,n])=>n.send(function(e,t){return Sn(t?{...e[0],dsn:t}:e[0],e[1])}(e,t)))))[0]},flush:async function(e){const t=[...r.values(),s];return(await Promise.all(t.map(t=>t.flush(e)))).every(e=>e)}}}}function ug(e,t,n,s){!function(e,t){const n=t?.scope??Se(),s=t?.captureSerializedMetric??Yn,o=n?.getClient()??Ee();if(!o)return void(r&&P.warn("No client available to capture metric."));const{release:i,environment:a,_experiments:c}=o.getOptions();if(!c?.enableMetrics)return void(r&&P.warn("metrics option not enabled, metric will not be captured."));const[,u]=jn(o,n),l={...e.attributes},{user:{id:d,email:p,username:h}}=function(e){const t=ke().getScopeData();return Fn(t,we().getScopeData()),Fn(t,e.getScopeData()),t}(n);Xn(l,"user.id",d,!1),Xn(l,"user.email",p,!1),Xn(l,"user.name",h,!1),Xn(l,"sentry.release",i),Xn(l,"sentry.environment",a);const{name:f,version:m}=o.getSdkMetadata()?.sdk??{};Xn(l,"sentry.sdk.name",f),Xn(l,"sentry.sdk.version",m);const g=o.getIntegrationByName("Replay"),y=g?.getReplayId(!0);Xn(l,"sentry.replay_id",y),y&&"buffer"===g?.getRecordingMode()&&Xn(l,"sentry._internal.replay_is_buffering",!0);const b={...e,attributes:l},v=c?.beforeSendMetric?c.beforeSendMetric(b):b;if(!v)return void(r&&P.log("`beforeSendMetric` returned `null`, will not send metric."));const _={};for(const e in v.attributes)void 0!==v.attributes[e]&&(_[e]=Gn(v.attributes[e]));const S=he(n),w=S?S.spanContext().traceId:u?.trace_id,k=S?S.spanContext().spanId:void 0,x={timestamp:oe(),trace_id:w,span_id:k,name:v.name,type:v.type,unit:v.unit,value:v.value,attributes:_};r&&P.log("[Metric]",x),s(o,x),o.emit("afterCaptureMetric",b)}({type:e,name:t,value:n,unit:s?.unit,attributes:s?.attributes},{scope:s?.scope})}function lg(e,t=1,n){ug("counter",e,t,n)}function dg(e,t,n){ug("gauge",e,t,n)}function pg(e,t,n){ug("distribution",e,t,n)}const hg=new Map,fg=new Set;function mg(e,t){t.exception?.values?.forEach(t=>{t.stacktrace?.frames?.forEach(t=>{if(!t.filename||t.module_metadata)return;const n=function(e,t){return function(e){if(i._sentryModuleMetadata)for(const t of Object.keys(i._sentryModuleMetadata)){const n=i._sentryModuleMetadata[t];if(fg.has(t))continue;fg.add(t);const s=e(t);for(const e of s.reverse())if(e.filename){hg.set(e.filename,n);break}}}(e),hg.get(t)}(e,t.filename);n&&(t.module_metadata=n)})})}function gg(e){e.exception?.values?.forEach(e=>{e.stacktrace?.frames?.forEach(e=>{delete e.module_metadata})})}const yg=()=>({name:"ModuleMetadata",setup(e){e.on("beforeEnvelope",e=>{kn(e,(e,t)=>{if("event"===t){const t=Array.isArray(e)?e[1]:void 0;t&&(gg(t),e[1]=t)}})}),e.on("applyFrameMetadata",t=>{t.type||mg(e.getOptions().stackParser,t)})}});const bg=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function vg(...e){let t="",n=!1;for(let s=e.length-1;s>=-1&&!n;s--){const r=s>=0?e[s]:"/";r&&(t=`${r}/${t}`,n="/"===r.charAt(0))}return t=function(e,t){let n=0;for(let t=e.length-1;t>=0;t--){const s=e[t];"."===s?e.splice(t,1):".."===s?(e.splice(t,1),n++):n&&(e.splice(t,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}(t.split("/").filter(e=>!!e),!n).join("/"),(n?"/":"")+t||"."}function _g(e){let t=0;for(;t<e.length&&""===e[t];t++);let n=e.length-1;for(;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}const Sg=(e={})=>{const t=e.root,n=e.prefix||"app:///",s="window"in i&&!!i.window,r=e.iteratee||function({isBrowser:e,root:t,prefix:n}){return s=>{if(!s.filename)return s;const r=/^[a-zA-Z]:\\/.test(s.filename)||s.filename.includes("\\")&&!s.filename.includes("/"),o=/^\//.test(s.filename);if(e){if(t){const e=s.filename;0===e.indexOf(t)&&(s.filename=e.replace(t,n))}}else if(r||o){const e=r?s.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):s.filename,o=t?function(e,t){e=vg(e).slice(1),t=vg(t).slice(1);const n=_g(e.split("/")),s=_g(t.split("/")),r=Math.min(n.length,s.length);let o=r;for(let e=0;e<r;e++)if(n[e]!==s[e]){o=e;break}let i=[];for(let e=o;e<n.length;e++)i.push("..");return i=i.concat(s.slice(o)),i.join("/")}(t,e):function(e){let t=function(e){const t=e.length>1024?`<truncated>${e.slice(-1024)}`:e,n=bg.exec(t);return n?n.slice(1):[]}(e)[2]||"";return t}(e);s.filename=`${n}${o}`}return s}}({isBrowser:s,root:t,prefix:n});return{name:"RewriteFrames",processEvent(e){let t=e;return e.exception&&Array.isArray(e.exception.values)&&(t=function(e){try{return{...e,exception:{...e.exception,values:e.exception.values.map(e=>{return{...e,...e.stacktrace&&{stacktrace:(t=e.stacktrace,{...t,frames:t?.frames?.map(e=>r(e))})}};var t})}}}catch{return e}}(t)),t}}},wg=e=>({name:"ThirdPartyErrorsFilter",setup(e){e.on("beforeEnvelope",e=>{kn(e,(e,t)=>{if("event"===t){const t=Array.isArray(e)?e[1]:void 0;t&&(gg(t),e[1]=t)}})}),e.on("applyFrameMetadata",t=>{t.type||mg(e.getOptions().stackParser,t)})},processEvent(t){const n=function(e){const t=Xe(e);if(t)return t.filter(e=>!!e.filename&&null!=(e.lineno??e.colno)).map(e=>e.module_metadata?Object.keys(e.module_metadata).filter(e=>e.startsWith(kg)).map(e=>e.slice(kg.length)):[])}(t);if(n){const s=n["drop-error-if-contains-third-party-frames"===e.behaviour||"apply-tag-if-contains-third-party-frames"===e.behaviour?"some":"every"](t=>!t.some(t=>e.filterKeys.includes(t)));if(s){if("drop-error-if-contains-third-party-frames"===e.behaviour||"drop-error-if-exclusively-contains-third-party-frames"===e.behaviour)return null;t.tags={...t.tags,third_party_code:!0}}}return t}}),kg="_sentryBundlerPluginAppKey:";function xg(e){return{...e,path:"path"in e&&Array.isArray(e.path)?e.path.join("."):void 0,keys:"keys"in e?JSON.stringify(e.keys):void 0,unionErrors:"unionErrors"in e?JSON.stringify(e.unionErrors):void 0}}function Tg(e){return e.map(e=>"number"==typeof e?"<array>":e).join(".")}function Eg(e){const t=new Set;for(const n of e.issues){const e=Tg(n.path);e.length>0&&t.add(e)}const n=Array.from(t);if(0===n.length){let t="variable";if(e.issues.length>0){const n=e.issues[0];void 0!==n&&"expected"in n&&"string"==typeof n.expected&&(t=n.expected)}return`Failed to validate ${t}`}return`Failed to validate keys: ${F(n.join(", "),100)}`}const Ig=(e={})=>{const t=e.limit??10;return{name:"ZodErrors",processEvent:(n,s)=>function(e,t=!1,n,s){if(!(n.exception?.values&&s.originalException&&(r=s.originalException,d(r)&&"ZodError"===r.name&&Array.isArray(r.issues))&&0!==s.originalException.issues.length))return n;var r;try{const r=(t?s.originalException.issues:s.originalException.issues.slice(0,e)).map(xg);return t&&(Array.isArray(s.attachments)||(s.attachments=[]),s.attachments.push({filename:"zod_issues.json",data:JSON.stringify({issues:r})})),{...n,exception:{...n.exception,values:[{...n.exception.values[0],value:Eg(s.originalException)},...n.exception.values.slice(1)]},extra:{...n.extra,"zoderror.issues":r.slice(0,e)}}}catch(e){return{...n,extra:{...n.extra,"zoderrors sentry integration parse error":{message:"an exception was thrown while processing ZodError within applyZodErrorsToEvent()",error:e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:"unknown"}}}}}(t,e.saveZodIssuesAsAttachment,n,s)}};function Cg(e,{metadata:t,tunnel:n,dsn:s}){const r={event_id:e.event_id,sent_at:(new Date).toISOString(),...t?.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!s&&{dsn:rt(s)}},o=function(e){return[{type:"user_report"},e]}(e);return Sn(r,[o])}function Mg(e={}){const t=ar.document,n=t?.head||t?.body;if(!n)return void(Qr&&P.error("[showReportDialog] Global document not defined"));const s=Se(),r=Ee(),o=r?.getDsn();if(!o)return void(Qr&&P.error("[showReportDialog] DSN not configured"));const i={...e,user:{...s.getUser(),...e.user},eventId:e.eventId||Ys()},a=ar.document.createElement("script");a.async=!0,a.crossOrigin="anonymous",a.src=function(e,t){const n=ct(e);if(!n)return"";const s=`${lt(n)}embed/error-page/`;let r=`dsn=${rt(n)}`;for(const e in t)if("dsn"!==e&&"onClose"!==e)if("user"===e){const e=t.user;if(!e)continue;e.name&&(r+=`&name=${encodeURIComponent(e.name)}`),e.email&&(r+=`&email=${encodeURIComponent(e.email)}`)}else r+=`&${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`;return`${s}?${r}`}(o,i);const{onLoad:c,onClose:u}=i;if(c&&(a.onload=c),u){const e=t=>{if("__sentry_reportdialog_closed__"===t.data)try{u()}finally{ar.removeEventListener("message",e)}};ar.addEventListener("message",e)}n.appendChild(a)}const Rg=i,Og=new WeakMap,Ag=(e={})=>{const t=e.types||["crash","deprecation","intervention"];function n(e){if(Og.has(Ee()))for(const t of e)xe(e=>{e.setExtra("url",t.url);const n=`ReportingObserver [${t.type}]`;let s="No details available";if(t.body){const n={};for(const e in t.body)n[e]=t.body[e];if(e.setExtra("body",n),"crash"===t.type){const e=t.body;s=[e.crashId||"",e.reason||""].join(" ").trim()||s}else s=t.body.message||s}zs(`${n}: ${s}`)})}return{name:"ReportingObserver",setupOnce(){"ReportingObserver"in _r&&new Rg.ReportingObserver(n,{buffered:!0,types:t}).observe()},setup(e){Og.set(e,!0)}}},Ng=(e={})=>{const t={failedRequestStatusCodes:[[500,599]],failedRequestTargets:[/.*/],...e};return{name:"HttpClient",setup(e){!function(e,t){wr()&&kr(n=>{if(Ee()!==e)return;const{response:s,args:r,error:o,virtualError:i}=n,[a,c]=r;s&&function(e,t,n,s,r){if(Fg(e,n.status,n.url)){const e=function(e,t){return!t&&e instanceof Request||e instanceof Request&&e.bodyUsed?e:new Request(e,t)}(t,s);let o,i,a,c;jg()&&([o,a]=Dg("Cookie",e),[i,c]=Dg("Set-Cookie",n)),qs($g({url:e.url,method:e.method,status:n.status,requestHeaders:o,responseHeaders:i,requestCookies:a,responseCookies:c,error:r,type:"fetch"}))}}(t,a,s,c,o||i)},!1)}(e,t),function(e,t){"XMLHttpRequest"in i&&Jr(n=>{if(Ee()!==e)return;const{error:s,virtualError:r}=n,o=n.xhr,i=o[Vr];if(!i)return;const{method:a,request_headers:c}=i;try{!function(e,t,n,s,r){if(Fg(e,t.status,t.responseURL)){let e,o,i;if(jg()){try{const e=t.getResponseHeader("Set-Cookie")||t.getResponseHeader("set-cookie")||void 0;e&&(o=Pg(e))}catch{}try{i=function(e){const t=e.getAllResponseHeaders();return t?t.split("\r\n").reduce((e,t)=>{const[n,s]=t.split(": ");return n&&s&&(e[n]=s),e},{}):{}}(t)}catch{}e=s}qs($g({url:t.responseURL,method:n,status:t.status,requestHeaders:e,responseHeaders:i,responseCookies:o,error:r,type:"xhr"}))}}(t,o,a,c,s||r)}catch(e){Qr&&P.warn("Error while extracting response event form XHR response",e)}})}(e,t)}}};function Dg(e,t){const n=function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(t.headers);let s;try{const t=n[e]||n[e.toLowerCase()]||void 0;t&&(s=Pg(t))}catch{}return[n,s]}function Lg(e){if(e){const t=e["Content-Length"]||e["content-length"];if(t)return parseInt(t,10)}}function Pg(e){return e.split("; ").reduce((e,t)=>{const[n,s]=t.split("=");return n&&s&&(e[n]=s),e},{})}function Fg(e,t,n){return function(e,t){return e.some(e=>"number"==typeof e?e===t:t>=e[0]&&t<=e[1])}(e.failedRequestStatusCodes,t)&&(s=e.failedRequestTargets,r=n,s.some(e=>"string"==typeof e?r.includes(e):e.test(r)))&&!Rc(n,Ee());var s,r}function $g(e){const t=Ee(),n=t&&e.error&&e.error instanceof Error?e.error.stack:void 0,s=n&&t?t.getOptions().stackParser(n,0,1):void 0,r=`HTTP Client Error with status code: ${e.status}`,o={message:r,exception:{values:[{type:"Error",value:r,stacktrace:s?{frames:s}:void 0}]},request:{url:e.url,method:e.method,headers:e.requestHeaders,cookies:e.requestCookies},contexts:{response:{status_code:e.status,headers:e.responseHeaders,cookies:e.responseCookies,body_size:Lg(e.responseHeaders)}}};return Z(o,{type:`auto.http.client.${e.type}`,handled:!1}),o}function jg(){const e=Ee();return!!e&&Boolean(e.getOptions().sendDefaultPii)}const Bg=i,Ug=(e={})=>{const t=null!=e.frameContextLines?e.frameContextLines:7;return{name:"ContextLines",processEvent:e=>function(e,t){const n=Bg.document,s=Bg.location&&$r(Bg.location.href);if(!n||!s)return e;const r=e.exception?.values;if(!r?.length)return e;const o=n.documentElement.innerHTML;if(!o)return e;const i=["<!DOCTYPE html>","<html>",...o.split("\n"),"</html>"];return r.forEach(e=>{const n=e.stacktrace;n?.frames&&(n.frames=n.frames.map(e=>function(e,t,n,s){return e.filename===n&&e.lineno&&t.length?(function(e,t,n=5){if(void 0===t.lineno)return;const s=e.length,r=Math.max(Math.min(s-1,t.lineno-1),0);t.pre_context=e.slice(Math.max(0,r-n),r).map(e=>$(e,0));const o=Math.min(s-1,r);t.context_line=$(e[o],t.colno||0),t.post_context=e.slice(Math.min(r+1,s),r+1+n).map(e=>$(e,0))}(t,e,s),e):e}(e,i,s,t)))}),e}(e,t)}};function Hg(e){const{query:t,operationName:n}=e,{operationName:s=n,operationType:r}=function(e){const t=e.match(/^(?:\s*)(query|mutation|subscription)(?:\s*)(\w+)(?:\s*)[{(]/);if(t)return{operationType:t[1],operationName:t[2]};const n=e.match(/^(?:\s*)(query|mutation|subscription)(?:\s*)[{(]/);return n?{operationType:n[1],operationName:void 0}:{operationType:void 0,operationName:void 0}}(t);return s?`${r} ${s}`:`${r}`}function zg(e){let t;if("xhr"in e){const n=e.xhr[Vr];t=n&&Dc(n.body)[0]}else t=Dc(Lc(e.input))[0];return t}function qg(e){let t;try{const n=JSON.parse(e);n.query&&(t=n)}finally{return t}}const Wg=e=>({name:"GraphQLClient",setup(t){!function(e,t){e.on("beforeOutgoingRequestSpan",(e,n)=>{const s=en(e).data||{};if("http.client"!==s[gt])return;const r=s["url.full"]||s["http.url"],o=s["http.request.method"]||s["http.method"];if(!m(r)||!m(o))return;const{endpoints:i}=t,a=U(r,i),c=zg(n);if(a&&c){const t=qg(c);if(t){const n=Hg(t);e.updateName(`${o} ${r} (${n})`),e.setAttribute("graphql.document",c)}}})}(t,e),function(e,t){e.on("beforeOutgoingRequestBreadcrumb",(e,n)=>{const{category:s,type:r,data:o}=e;if("http"===r&&("fetch"===s||"xhr"===s)){const e=o?.url,{endpoints:s}=t,r=U(e,s),i=zg(n);if(r&&o&&i){const e=qg(i);if(!o.graphql&&e){const t=Hg(e);o["graphql.document"]=e.query,o["graphql.operation"]=t}}}})}(t,e)}});var Vg=Object.defineProperty,Jg=(e,t,n)=>((e,t,n)=>t in e?Vg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);function Kg(e,t,n=1/0,s=0){return e?e.nodeType!==e.ELEMENT_NODE||s>n?-1:t(e)?s:Kg(e.parentNode,t,n,s+1):-1}function Gg(e,t){return n=>{const s=n;if(null===s)return!1;try{if(e)if("string"==typeof e){if(s.matches(`.${e}`))return!0}else if(function(e,t){for(let n=e.classList.length;n--;){const s=e.classList[n];if(t.test(s))return!0}return!1}(s,e))return!0;return!(!t||!s.matches(t))}catch{return!1}}}const Xg="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Yg={map:{},getId:()=>(console.error(Xg),-1),getNode:()=>(console.error(Xg),null),removeNodeFromMap(){console.error(Xg)},has:()=>(console.error(Xg),!1),reset(){console.error(Xg)}};function Qg(e,t,n,s,r=window){const o=r.Object.getOwnPropertyDescriptor(e,t);return r.Object.defineProperty(e,t,s?n:{set(e){ry(()=>{n.set.call(this,e)},0),o&&o.set&&o.set.call(this,e)}}),()=>Qg(e,t,o||{},!0)}function Zg(e,t,n){try{if(!(t in e))return()=>{};const s=e[t],r=n(s);return"function"==typeof r&&(r.prototype=r.prototype||{},Object.defineProperties(r,{__rrweb_original__:{enumerable:!1,value:s}})),e[t]=r,()=>{e[t]=s}}catch{return()=>{}}}function ey(e,t,n,s,r){if(!e)return!1;const o=function(e){if(!e)return null;try{return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}catch(e){return null}}(e);if(!o)return!1;const i=Gg(t,n);if(!r){const e=s&&o.matches(s);return i(o)&&!e}const a=Kg(o,i);let c=-1;return!(a<0)&&(s&&(c=Kg(o,Gg(null,s))),a>-1&&c<0||a<c)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Yg=new Proxy(Yg,{get:(e,t,n)=>("map"===t&&console.error(Xg),Reflect.get(e,t,n))})),Date.now().toString();const ty={};function ny(e){const t=ty[e];if(t)return t;const n=window.document;let s=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const r=t.contentWindow;r&&r[e]&&(s=r[e]),n.head.removeChild(t)}catch(e){}return ty[e]=s.bind(window)}function sy(...e){return ny("requestAnimationFrame")(...e)}function ry(...e){return ny("setTimeout")(...e)}var oy=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(oy||{});let iy;const ay=e=>iy?(...t)=>{try{return e(...t)}catch(e){if(iy&&!0===iy(e))return()=>{};throw e}}:e;for(var cy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",uy="undefined"==typeof Uint8Array?[]:new Uint8Array(256),ly=0;ly<64;ly++)uy[cy.charCodeAt(ly)]=ly;const dy=new Map,py=(e,t,n)=>{if(!e||!my(e,t)&&"object"!=typeof e)return;const s=function(e,t){let n=dy.get(e);return n||(n=new Map,dy.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}(n,e.constructor.name);let r=s.indexOf(e);return-1===r&&(r=s.length,s.push(e)),r};function hy(e,t,n){if(e instanceof Array)return e.map(e=>hy(e,t,n));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer)return{rr_type:e.constructor.name,base64:function(e){var t,n=new Uint8Array(e),s=n.length,r="";for(t=0;t<s;t+=3)r+=cy[n[t]>>2],r+=cy[(3&n[t])<<4|n[t+1]>>4],r+=cy[(15&n[t+1])<<2|n[t+2]>>6],r+=cy[63&n[t+2]];return s%3==2?r=r.substring(0,r.length-1)+"=":s%3==1&&(r=r.substring(0,r.length-2)+"=="),r}(e)};if(e instanceof DataView)return{rr_type:e.constructor.name,args:[hy(e.buffer,t,n),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const t=e.constructor.name,{src:n}=e;return{rr_type:t,src:n}}return e instanceof HTMLCanvasElement?{rr_type:"HTMLImageElement",src:e.toDataURL()}:e instanceof ImageData?{rr_type:e.constructor.name,args:[hy(e.data,t,n),e.width,e.height]}:my(e,t)||"object"==typeof e?{rr_type:e.constructor.name,index:py(e,t,n)}:e}const fy=(e,t,n)=>e.map(e=>hy(e,t,n)),my=(e,t)=>{const n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(e=>"function"==typeof t[e]);return Boolean(n.find(n=>e instanceof t[n]))};function gy(e,t,n,s,r){const o=[];try{const i=Zg(e.HTMLCanvasElement.prototype,"getContext",function(e){return function(o,...i){if(!ey(this,t,n,s,!0)){const e=function(e){return"experimental-webgl"===e?"webgl":e}(o);if("__context"in this||(this.__context=e),r&&["webgl","webgl2"].includes(e))if(i[0]&&"object"==typeof i[0]){const e=i[0];e.preserveDrawingBuffer||(e.preserveDrawingBuffer=!0)}else i.splice(0,1,{preserveDrawingBuffer:!0})}return e.apply(this,[o,...i])}});o.push(i)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{o.forEach(e=>e())}}function yy(e,t,n,s,r,o,i,a){const c=[],u=Object.getOwnPropertyNames(e);for(const i of u)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(i))try{if("function"!=typeof e[i])continue;const u=Zg(e,i,function(e){return function(...c){const u=e.apply(this,c);if(py(u,a,this),"tagName"in this.canvas&&!ey(this.canvas,s,r,o,!0)){const e=fy(c,a,this),s={type:t,property:i,args:e};n(this.canvas,s)}return u}});c.push(u)}catch{const s=Qg(e,i,{set(e){n(this.canvas,{type:t,property:i,args:[e],setter:!0})}});c.push(s)}return c}class by{constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.shadowDoms=new Set,this.windowsSet=new WeakSet,this.windows=[],this.restoreHandlers=[],this.frozen=!1,this.locked=!1,this.snapshotInProgressMap=new Map,this.worker=null,this.lastSnapshotTime=0,this.processMutation=(e,t)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};const{enableManualSnapshot:t,sampling:n="all",win:s,recordCanvas:r,errorHandler:o}=e;e.sampling=n,this.mutationCb=e.mutationCb,this.mirror=e.mirror,this.options=e,o&&(iy=o),(r&&"number"==typeof n||t)&&(this.worker=this.initFPSWorker()),this.addWindow(s),t||ay(()=>{r&&"all"===n&&(this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher()),r&&"number"==typeof n&&this.initCanvasFPSObserver()})()}reset(){this.pendingCanvasMutations.clear(),this.restoreHandlers.forEach(e=>{try{e()}catch(e){}}),this.restoreHandlers=[],this.windowsSet=new WeakSet,this.windows=[],this.shadowDoms=new Set,this.worker?.terminate(),this.worker=null,this.snapshotInProgressMap=new Map}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}addWindow(e){const{sampling:t="all",blockClass:n,blockSelector:s,unblockSelector:r,recordCanvas:o,enableManualSnapshot:i}=this.options;if(!this.windowsSet.has(e)){if(i)return this.windowsSet.add(e),void this.windows.push(new WeakRef(e));ay(()=>{if(o&&"all"===t&&this.initCanvasMutationObserver(e,n,s,r),o&&"number"==typeof t){const t=gy(e,n,s,r,!0);this.restoreHandlers.push(()=>{t()})}})(),this.windowsSet.add(e),this.windows.push(new WeakRef(e))}}addShadowRoot(e){this.shadowDoms.add(new WeakRef(e))}resetShadowRoots(){this.shadowDoms=new Set}snapshot(e,t){t?.skipRequestAnimationFrame?this.takeSnapshot(performance.now(),!0,e):sy(t=>this.takeSnapshot(t,!0,e))}initFPSWorker(){const e=new Worker(function(){const e=new Blob(['for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="undefined"==typeof Uint8Array?[]:new Uint8Array(256),a=0;a<64;a++)t[e.charCodeAt(a)]=a;var n=function(t){var a,n=new Uint8Array(t),r=n.length,s="";for(a=0;a<r;a+=3)s+=e[n[a]>>2],s+=e[(3&n[a])<<4|n[a+1]>>4],s+=e[(15&n[a+1])<<2|n[a+2]>>6],s+=e[63&n[a+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s};const r=new Map,s=new Map;const i=self;i.onmessage=async function(e){if(!("OffscreenCanvas"in globalThis))return i.postMessage({id:e.data.id});{const{id:t,bitmap:a,width:o,height:f,maxCanvasSize:c,dataURLOptions:g}=e.data,u=async function(e,t,a){const r=e+"-"+t;if("OffscreenCanvas"in globalThis){if(s.has(r))return s.get(r);const i=new OffscreenCanvas(e,t);i.getContext("2d");const o=await i.convertToBlob(a),f=await o.arrayBuffer(),c=n(f);return s.set(r,c),c}return""}(o,f,g),[h,d]=function(e,t,a){if(!a)return[e,t];const[n,r]=a;if(e<=n&&t<=r)return[e,t];let s=e,i=t;return s>n&&(i=Math.floor(n*t/e),s=n),i>r&&(s=Math.floor(r*e/t),i=r),[s,i]}(o,f,c),l=new OffscreenCanvas(h,d),w=l.getContext("bitmaprenderer"),p=h===o&&d===f?a:await createImageBitmap(a,{resizeWidth:h,resizeHeight:d,resizeQuality:"low"});w?.transferFromImageBitmap(p),a.close();const y=await l.convertToBlob(g),v=y.type,b=await y.arrayBuffer(),m=n(b);if(p.close(),!r.has(t)&&await u===m)return r.set(t,m),i.postMessage({id:t});if(r.get(t)===m)return i.postMessage({id:t});i.postMessage({id:t,type:v,base64:m,width:o,height:f}),r.set(t,m)}};']);return URL.createObjectURL(e)}());return e.onmessage=e=>{const t=e.data,{id:n}=t;if(this.snapshotInProgressMap.set(n,!1),!("base64"in t))return;const{base64:s,type:r,width:o,height:i}=t;this.mutationCb({id:n,type:oy["2D"],commands:[{property:"clearRect",args:[0,0,o,i]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:s}],type:r}]},0,0,o,i]}]})},e}initCanvasFPSObserver(){let e;if(!this.windows.length&&!this.shadowDoms.size)return;const t=n=>{this.takeSnapshot(n,!1),e=sy(t)};e=sy(t),this.restoreHandlers.push(()=>{e&&cancelAnimationFrame(e)})}initCanvasMutationObserver(e,t,n,s){const r=gy(e,t,n,s,!1),o=function(e,t,n,s,r){const o=[],i=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const a of i)try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[a])continue;const i=Zg(t.CanvasRenderingContext2D.prototype,a,function(o){return function(...i){return ey(this.canvas,n,s,r,!0)||ry(()=>{const n=fy(i,t,this);e(this.canvas,{type:oy["2D"],property:a,args:n})},0),o.apply(this,i)}});o.push(i)}catch{const n=Qg(t.CanvasRenderingContext2D.prototype,a,{set(t){e(this.canvas,{type:oy["2D"],property:a,args:[t],setter:!0})}});o.push(n)}return()=>{o.forEach(e=>e())}}(this.processMutation.bind(this),e,t,n,s),i=function(e,t,n,s,r){const o=[];return o.push(...yy(t.WebGLRenderingContext.prototype,oy.WebGL,e,n,s,r,0,t)),void 0!==t.WebGL2RenderingContext&&o.push(...yy(t.WebGL2RenderingContext.prototype,oy.WebGL2,e,n,s,r,0,t)),()=>{o.forEach(e=>e())}}(this.processMutation.bind(this),e,t,n,s,this.mirror);this.restoreHandlers.push(()=>{r(),o(),i()})}getCanvasElements(e,t,n){const s=[],r=r=>{r.querySelectorAll("canvas").forEach(r=>{ey(r,e,t,n,!0)||s.push(r)})};for(const e of this.windows){const t=e.deref();let n;try{n=t&&t.document}catch{}n&&r(n)}for(const e of this.shadowDoms){const t=e.deref();t&&r(t)}return s}takeSnapshot(e,t,n){const{sampling:s,blockClass:r,blockSelector:o,unblockSelector:i,dataURLOptions:a,maxCanvasSize:c}=this.options,u=1e3/("all"===s?2:s||2);return!(this.lastSnapshotTime&&e-this.lastSnapshotTime<u)&&(this.lastSnapshotTime=e,(n?[n]:this.getCanvasElements(r,o,i)).forEach(e=>{const n=this.mirror.getId(e);if(this.mirror.hasNode(e)&&e.width&&e.height&&!this.snapshotInProgressMap.get(n)){if(this.snapshotInProgressMap.set(n,!0),!t&&["webgl","webgl2"].includes(e.__context)){const t=e.getContext(e.__context);!1===t?.getContextAttributes()?.preserveDrawingBuffer&&t.clear(t.COLOR_BUFFER_BIT)}createImageBitmap(e).then(t=>{this.worker?.postMessage({id:n,bitmap:t,width:e.width,height:e.height,dataURLOptions:a,maxCanvasSize:c},[t])}).catch(e=>{ay(()=>{throw this.snapshotInProgressMap.delete(n),e})()})}}),!0)}startPendingCanvasMutationFlusher(){sy(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const e=t=>{this.rafStamps.latestId=t,sy(e)};sy(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,t)=>{const n=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,n)}),sy(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(e);if(!n||-1===t)return;const s=n.map(e=>{const{type:t,...n}=e;return n}),{type:r}=n[0];this.mutationCb({id:t,type:r,commands:s}),this.pendingCanvasMutations.delete(e)}}try{if(2!==Array.from([1],e=>2*e)[0]){const e=document.createElement("iframe");document.body.appendChild(e),Array.from=e.contentWindow?.Array.from||Array.from,document.body.removeChild(e)}}catch(yb){console.debug("Unable to override Array.from",yb)}var vy;new class{constructor(){Jg(this,"idNodeMap",new Map),Jg(this,"nodeMetaMap",new WeakMap)}getId(e){if(!e)return-1;const t=this.getMeta(e)?.id;return t??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(e=>this.removeNodeFromMap(e))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}},function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(vy||(vy={}));const _y={low:{sampling:{canvas:1},dataURLOptions:{type:"image/webp",quality:.25}},medium:{sampling:{canvas:2},dataURLOptions:{type:"image/webp",quality:.4}},high:{sampling:{canvas:4},dataURLOptions:{type:"image/webp",quality:.5}}},Sy=1280,wy=(e={})=>{const[t,n]=e.maxCanvasSize||[],s={quality:e.quality||"medium",enableManualSnapshot:e.enableManualSnapshot,maxCanvasSize:[t?Math.min(t,Sy):Sy,n?Math.min(n,Sy):Sy]};let r;const o=new Promise(e=>r=e);return{name:"ReplayCanvas",getOptions(){const{quality:e,enableManualSnapshot:t,maxCanvasSize:n}=s;return{enableManualSnapshot:t,recordCanvas:!0,getCanvasManager:e=>{const s=new by({...e,enableManualSnapshot:t,maxCanvasSize:n,errorHandler:e=>{try{"object"==typeof e&&(e.__rrweb__=!0)}catch{}}});return r(s),s},..._y[e]||_y.medium}},async snapshot(e,t){(await o).snapshot(e,t)}}};function ky(e=Ee()){e?.emit("endPageloadSpan")}function xy(e){const t=un();if(t===e)return;const n=Se();e.end=new Proxy(e.end,{apply:(e,s,r)=>(pe(n,t),Reflect.apply(e,s,r))}),pe(n,e)}const Ty=100,Ey=5e3,Iy=36e5;function Cy(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function My(e){return Cy(e.getAllKeys())}function Ry(e){let t;function n(){return null==t&&(t=function(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const s=Cy(n);return e=>s.then(n=>e(n.transaction(t,"readwrite").objectStore(t)))}(e.dbName||"sentry-offline",e.storeName||"queue")),t}return{push:async t=>{try{const s=await En(t);await function(e,t,n){return e(e=>My(e).then(s=>{if(!(s.length>=n))return e.put(t,Math.max(...s,0)+1),Cy(e.transaction)}))}(n(),s,e.maxQueueSize||30)}catch{}},unshift:async t=>{try{const s=await En(t);await function(e,t,n){return e(e=>My(e).then(s=>{if(!(s.length>=n))return e.put(t,Math.min(...s,0)-1),Cy(e.transaction)}))}(n(),s,e.maxQueueSize||30)}catch{}},shift:async()=>{try{const e=await function(e){return e(e=>My(e).then(t=>{const n=t[0];if(null!=n)return Cy(e.get(n)).then(t=>(e.delete(n),Cy(e.transaction).then(()=>t)))}))}(n());if(e)return function(e){let t="string"==typeof e?Tn(e):e;function n(e){const n=t.subarray(0,e);return t=t.subarray(e+1),n}function s(){let e=t.indexOf(10);return e<0&&(e=t.length),JSON.parse(function(e){const t=c(i);return t.decodePolyfill?t.decodePolyfill(e):(new TextDecoder).decode(e)}(n(e)))}const r=s(),o=[];for(;t.length;){const e=s(),t="number"==typeof e.length?e.length:void 0;o.push([e,t?n(t):s()])}return[r,o]}(e)}catch{}}}}function Oy(e=Yo){return function(e){return t=>{const n=e({...t,createStore:Ry});return ar.addEventListener("online",async e=>{await n.flush()}),n}}(function(e){function t(...e){r&&P.log("[Offline]:",...e)}return n=>{const s=e(n);if(!n.createStore)throw new Error("No `createStore` function was provided");const r=n.createStore(n);let o,i=Ey;function a(e){o&&clearTimeout(o),o=setTimeout(async()=>{o=void 0;const e=await r.shift();e&&(t("Attempting to send previously queued event"),e[0].sent_at=(new Date).toISOString(),u(e,!0).catch(e=>{t("Failed to retry sending",e)}))},e),"number"!=typeof o&&o.unref&&o.unref()}function c(){o||(a(i),i=Math.min(2*i,Iy))}async function u(e,o=!1){if(!o&&xn(e,["replay_event","replay_recording"]))return await r.push(e),a(Ty),{};try{if(n.shouldSend&&!1===await n.shouldSend(e))throw new Error("Envelope not sent because `shouldSend` callback returned false");const t=await s.send(e);let r=Ty;if(t)if(t.headers?.["retry-after"])r=Ho(t.headers["retry-after"]);else if(t.headers?.["x-sentry-rate-limits"])r=6e4;else if((t.statusCode||0)>=400)return t;return a(r),i=Ey,t}catch(s){if(await function(e,t,s){return!xn(e,["client_report"])&&(!n.shouldStore||n.shouldStore(e,t,s))}(e,s,i))return o?await r.unshift(e):await r.push(e),c(),t("Error sending. Event queued.",s),{};throw s}}return n.flushAtStartup&&c(),{send:u,flush:e=>(void 0===e&&(i=Ey,a(Ty)),s.flush(e))}}}(e))}const Ay=(e={})=>{const t=e.sidecarUrl||"http://localhost:8969/stream";return{name:"SpotlightBrowser",setup:()=>{Qr&&P.log("Using Sidecar URL",t)},processEvent:e=>function(e){return Boolean("transaction"===e.type&&e.spans&&e.contexts?.trace&&"ui.action.click"===e.contexts.trace.op&&e.spans.some(({description:e})=>e?.includes("#sentry-spotlight")))}(e)?null:e,afterAllSetup:e=>{!function(e,t){const n=Go("fetch");let s=0;e.on("beforeEnvelope",e=>{s>3?P.warn("[Spotlight] Disabled Sentry -> Spotlight integration due to too many failed requests:",s):n(t,{method:"POST",body:En(e),headers:{"Content-Type":"application/x-sentry-envelope"},mode:"cors"}).then(e=>{e.status>=200&&e.status<400&&(s=0)},e=>{s++,P.error("Sentry SDK can't connect to Sidecar is it running? See: https://spotlightjs.com/sidecar/npx/",e)})})}(e,t)}}},Ny=()=>({name:"OpenFeature",processEvent:(e,t,n)=>wp(e)});class Dy{after(e,t){kp(t.flagKey,t.value),xp(t.flagKey,t.value)}error(e,t,n){kp(e.flagKey,e.defaultValue),xp(e.flagKey,e.defaultValue)}}const Ly=({featureFlagClientClass:e})=>({name:"Unleash",setupOnce(){H(e.prototype,"isEnabled",Py)},processEvent:(e,t,n)=>wp(e)});function Py(e){return function(...t){const n=t[0],s=e.apply(this,t);return"string"==typeof n&&"boolean"==typeof s?(kp(n,s),xp(n,s)):Qr&&P.error(`[Feature Flags] UnleashClient.isEnabled does not match expected signature. arg0: ${n} (${typeof n}), result: ${s} (${typeof s})`),s}}function Fy(e){return function(...t){const n=t[0],s=e.apply(this,t);return"string"==typeof n&&"boolean"==typeof s&&(kp(n,s),xp(n,s)),s}}const $y=({growthbookClass:e})=>(({growthbookClass:e})=>({name:"GrowthBook",setupOnce(){const t=e.prototype;"function"==typeof t.isOn&&H(t,"isOn",Fy),"function"==typeof t.getFeatureValue&&H(t,"getFeatureValue",Fy)},processEvent:(e,t,n)=>wp(e)}))({growthbookClass:e}),jy=({featureFlagClient:e})=>({name:"Statsig",setup(t){e.on("gate_evaluation",e=>{kp(e.gate.name,e.gate.value),xp(e.gate.name,e.gate.value)})},processEvent:(e,t,n)=>wp(e)});async function By(){const e=Ee();if(!e)return"no-client-active";if(!e.getDsn())return"no-dsn-configured";try{await mi(()=>fetch("https://o447951.ingest.sentry.io/api/4509632503087104/envelope/?sentry_version=7&sentry_key=c1dfb07d783ad5325c245c1fd3725390&sentry_client=sentry.javascript.browser%2F1.33.7",{body:"{}",method:"POST",mode:"cors",credentials:"omit"}))}catch{return"sentry-unreachable"}}const Uy=({worker:e})=>({name:"WebWorker",setupOnce:()=>{(Array.isArray(e)?e:[e]).forEach(e=>Hy(e))},addWorker:e=>Hy(e)});function Hy(e){e.addEventListener("message",e=>{var t;b(t=e.data)&&!0===t._sentryMessage&&"_sentryDebugIds"in t&&(b(t._sentryDebugIds)||void 0===t._sentryDebugIds)&&(e.stopImmediatePropagation(),Qr&&P.log("Sentry debugId web worker message received",e.data),ar._sentryDebugIds={...e.data._sentryDebugIds,...ar._sentryDebugIds})})}function zy({self:e}){e.postMessage({_sentryMessage:!0,_sentryDebugIds:e._sentryDebugIds??void 0})}function qy(){return window.location.hostname.includes("app.napkin.ai")||"true"===new URLSearchParams(window.location.search).get("isProduction")}function Wy(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Vy(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vy(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var s=0,r=function(){};return{s:r,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function Vy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=Array(t);n<t;n++)s[n]=e[n];return s}function Jy(e,t,n){try{var s=n.toLowerCase();if(e.message&&e.message.toLowerCase().includes(s))return!0;if(t&&t.originalException){var r=t.originalException;if(r&&r.message&&r.message.toLowerCase().includes(s))return!0}if(e.exception&&Array.isArray(e.exception.values)){var o,i=Wy(e.exception.values);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(a.stacktrace&&Array.isArray(a.stacktrace.frames)){var c,u=Wy(a.stacktrace.frames);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(l.filename&&l.filename.toLowerCase().includes(s)||l.function&&l.function.toLowerCase().includes(s))return!0}}catch(e){u.e(e)}finally{u.f()}}}}catch(e){i.e(e)}finally{i.f()}}if(e.culprit&&e.culprit.toLowerCase().includes(s))return!0}catch(e){console.error("[Sentry] Error in _eventComingFromSrc: ",e)}return!1}window.NapkinSentry={errorHashes:{},init:function(){try{Zo({dsn:qy()?"https://02d72dcf91f3ffafdfa130e080a6f809@o4507804332654592.ingest.de.sentry.io/4507825891246160":"https://f7b31574b55e1d3a86ce2e969584fc2b@o4507804332654592.ingest.de.sentry.io/4507804354609232",release:window.gitCommit||"unknown",integrations:[tc(),Mc(),mp({maskAllText:!1,blockAllMedia:!1,networkRequestHeaders:["X-Napkin-Workspace-Id"],networkResponseHeaders:["X-Napkin-Workspace-Id"]}),Ep()],sendDefaultPii:!0,tracesSampleRate:.1,tracePropagationTargets:["localhost",/^https:\/\/napkin\.ai\/api/],replaysSessionSampleRate:0,replaysOnErrorSampleRate:1,profilesSampleRate:1,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications","Non-Error promise rejection captured with value","Error looking up record in object store by key range","WKWebView API client did not respond to this postMessage","Invalid call to runtime.sendMessage(). Tab not found.","Invalid event type from worker: undefined","Unexpected EOF","NS_ERROR_FILE_CORRUPTED","NS_ERROR_NOT_INITIALIZED","NS_ERROR_ABORT","NS_ERROR_FAILURE","NS_ERROR_UNEXPECTED","NS_ERROR_FILE_NOT_DIRECTORY","The operation is insecure.","Failed to execute 'write' on 'Clipboard': Document is not focused.","sendBeacon",/^Method not found$/,"Failed to execute 'insertRule' on 'CSSStyleSheet'","hookGeo",'can\'t redefine non-configurable property "geolocation"',"Invalid or unexpected token","TypeError: Illegal invocation","Unexpected token","Unexpected end of script","Unexpected end of input","Promise.resolve is not a function","Failed to fetch","Load failed","AbortError","NetworkError when attempting to fetch resource.","NS_ERROR_FILE_NOT_FOUND","Unexpected identifier 'https","Connection to Indexed Database server lost. Refresh the page to try again","Database deleted by request of the user","Encountered full disk while opening backing store for indexedDB.open.","Unable to open database file on disk","Internal error opening backing store for indexedDB.open.","Internal error deleting database.","Object store cannot be found in the database","secret is not defined","zaloJSV2","Stylesheet append timeout","LaunchDarklyFlagFetchError","GA is not defined","Invalid content for node type paragraph","Failed to execute 'collapse' on 'Selection'","null is not an object (evaluating 'o.type')","Cannot read properties of null (reading 'type')","Called contentMatchAt on a node with invalid content","Content hole not allowed in a leaf node spec","is larger than the node's length","Cannot read properties of null (reading 'pmViewDesc')","Cannot read properties of undefined (reading '_focused')","__spreadArray",'can\'t redefine non-configurable property "get"',"IFrameMessageHandler","onReady is not defined","onHide is not defined","Cannot read properties of undefined (reading 'checker')","window.webkit.messageHandlers","kCFErrorDomainCFNetwork","Attempting to change value of a readonly property.","Can only call Window.structuredClone on instances of Window","The object does not support the operation or argument.","Error: Error","No error message","TypeError: window.checkLogin is not a function","TypeError: null is not an object (evaluating 'l.formElement')","Origin is only applicable schemes http and https: file://","Object captured as promise rejection with keys:","(type=error) captured as promise rejection","(type=unhandledrejection) captured as promise rejection","AbortController is not a constructor","window.performance.getEntriesByName","jb","_chromeNamespace","contentWindow","Can't find variable: post","Can't find variable: GM_getValue","Can't find variable: unsafeWindow","Can't find variable: gmo","undefined is not an object (evaluating 'a.K')","undefined is not an object (evaluating 'a.J')","null is not an object (evaluating 'e.contentDocument.body')","webVitals.getCLS is not a function","webVitals is not defined","jQuery is not defined","$ is not defined","$ is not a function","customDispatchEvent is not defined","Java bridge method invocation error","Java object is gone","WebViewJavascriptBridge is not defined","Java exception was raised during method invocation","GetHTMLElementsAtPoint","Data cannot be cloned","window[objectName][methodName] is not a function","window[functionName] is not a function","Blocked a frame with origin","WebAssembly","TricentisAlertAlerter","TricentisShadowDomUnlocker","UCShellJava.sdkEventFire","There is no clipping info for given tab","zp_token","repeatInterval_c","shadowDOMUnlocker is not defined","toscaAlertAlerter is not defined","Mx is not defined","_0x563ad2 is not defined","LIDNotifyId is not defined","nativeInitedNotify is not defined","frappe is not defined","ethereum","HTMLOUT is not defined","wsimtgo","yandexReadabilityChecker","_logicalFormForControl","GM_listValues","WeixinJSBridge","getCosmeticsFilters","applyAdblockCode",/^Cannot read properties of null (reading 'document')$/,/^f is undefined$/,"change_ua","Menu caption text is required!","Not allowed to access cross-origin stylesheet","webtranslation_detect","args.site.enabledFeatures is undefined"],beforeSend:function(e,t){try{if(e.message&&window.NapkinSentry.errorHashes[e.message]>5)return null;window.NapkinSentry.errorHashes[e.message]=window.NapkinSentry.errorHashes[e.message]?window.NapkinSentry.errorHashes[e.message]+1:1}catch(e){console.error("[Sentry] Error in beforeSend: ",e)}return e.message&&e.message.includes("auth/network-request-failed")&&(e.fingerprint=["auth/network-request-failed"]),Jy(e,t,"file://")?(console.warn("[Sentry] Ignoring local file error: ",e.message),null):Jy(e,t,"blob:")?(console.warn("[Sentry] Ignoring blob file error: ",e.message),null):Jy(e,t,"chrome-extension://")?(console.warn("[Sentry] Ignoring chrome extension error: ",e.message),null):Jy(e,t,"moz-extension://")?(console.warn("[Sentry] Ignoring firefox extension error: ",e.message),null):Jy(e,t,"clarity.js")?(console.warn("[Sentry] Ignoring clarity.js error: ",e.message),null):Jy(e,t,"@sentry-internal")||Jy(e,t,"@sentry")?(console.warn("[Sentry] Ignoring sentry-internal error: ",e.message),null):Jy(e,t,"bundle/m.js")?(console.warn("[Sentry] Ignoring monitoring bundle error: ",e.message),null):Jy(e,t,"gtm.js")?(console.warn("[Sentry] Ignoring Google Tag Manager error: ",e.message),null):Jy(e,t,"prosemirror-transform")||Jy(e,t,"prosemirror-view")?(console.warn("[Sentry] Ignoring prosemirror error: ",e.message),null):Jy(e,t,"translate.googleapis.com")||Jy(e,t,"translate_http")||Jy(e,t,"translate.datong.info")||Jy(e,t,"intercomcdn.com")||Jy(e,t,"undefined is not an object (evaluating 'a.J')")||Jy(e,t,"rocket-loader.min.js")||Jy(e,t,"u.c.b.r.o.w.s.e.r")?null:e},beforeBreadcrumb:function(e,t){try{if("console"===e.category&&"debug"===e.level)return null}catch(e){}return e}}),console.debug("[Sentry] Loaded");try{var e=window.__napkin_sentry_queue||[];if(Array.isArray(e)&&e.length>0){console.debug("[Sentry] Flushing early error queue (exceptions/rejections only):",e.length),e.forEach(function(e){try{if(!e)return;if("exception"===e.type){var t=e.error;t instanceof Error?Hs(t):console.debug("[Sentry] Skipping early exception (not an Error instance):",e)}else if("rejection"===e.type){var n=e.reason;n instanceof Error?Hs(n):console.debug("[Sentry] Skipping early rejection (not an Error instance):",e)}}catch(e){console.error("[Sentry] Error in flushing early queue: ",e)}});try{window.__napkin_sentry_queue=[]}catch(e){}}}catch(e){console.error("[Sentry] Error flushing early queue: ",e)}}catch(e){console.error("[Sentry] Error in loading Sentry: ",e)}if(window.location.search.includes("debug-session=true"))try{bp().start(),Gs("debug-record","true"),console.debug("[Sentry] Session Replay Started from debug-session=true query parameter");var t=window.location.search.match(/email=([^&]*)/);t&&(Xs({email:t[1]}),console.debug("[Sentry] User email set for the session replay",t[1]))}catch(e){console.error("[Sentry] Error in starting the session replay: ",e)}},getClient:function(){return s}};var Ky={},Gy=Uint8Array,Xy=Uint16Array,Yy=Int32Array,Qy=new Gy([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Zy=new Gy([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),eb=new Gy([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),tb=function(e,t){for(var n=new Xy(31),s=0;s<31;++s)n[s]=t+=1<<e[s-1];var r=new Yy(n[30]);for(s=1;s<30;++s)for(var o=n[s];o<n[s+1];++o)r[o]=o-n[s]<<5|s;return{b:n,r}},nb=tb(Qy,2),sb=nb.b,rb=nb.r;sb[28]=258,rb[258]=28;for(var ob=tb(Zy,0).r,ib=new Xy(32768),ab=0;ab<32768;++ab){var cb=(43690&ab)>>1|(21845&ab)<<1;cb=(61680&(cb=(52428&cb)>>2|(13107&cb)<<2))>>4|(3855&cb)<<4,ib[ab]=((65280&cb)>>8|(255&cb)<<8)>>1}var ub=function(e,t,n){for(var s=e.length,r=0,o=new Xy(t);r<s;++r)e[r]&&++o[e[r]-1];var i,a=new Xy(t);for(r=1;r<t;++r)a[r]=a[r-1]+o[r-1]<<1;if(n){i=new Xy(1<<t);var c=15-t;for(r=0;r<s;++r)if(e[r])for(var u=r<<4|e[r],l=t-e[r],d=a[e[r]-1]++<<l,p=d|(1<<l)-1;d<=p;++d)i[ib[d]>>c]=u}else for(i=new Xy(s),r=0;r<s;++r)e[r]&&(i[r]=ib[a[e[r]-1]++]>>15-e[r]);return i},lb=new Gy(288);for(ab=0;ab<144;++ab)lb[ab]=8;for(ab=144;ab<256;++ab)lb[ab]=9;for(ab=256;ab<280;++ab)lb[ab]=7;for(ab=280;ab<288;++ab)lb[ab]=8;var db=new Gy(32);for(ab=0;ab<32;++ab)db[ab]=5;var pb=ub(lb,9,0),hb=ub(db,5,0),fb=function(e){return(e+7)/8|0},mb=function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new Gy(e.subarray(t,n))},gb=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],yb=function(e,t,n){var s=new Error(t||gb[e]);if(s.code=e,Error.captureStackTrace&&Error.captureStackTrace(s,yb),!n)throw s;return s},bb=function(e,t,n){n<<=7&t;var s=t/8|0;e[s]|=n,e[s+1]|=n>>8},vb=function(e,t,n){n<<=7&t;var s=t/8|0;e[s]|=n,e[s+1]|=n>>8,e[s+2]|=n>>16},_b=function(e,t){for(var n=[],s=0;s<e.length;++s)e[s]&&n.push({s,f:e[s]});var r=n.length,o=n.slice();if(!r)return{t:Ib,l:0};if(1==r){var i=new Gy(n[0].s+1);return i[n[0].s]=1,{t:i,l:1}}n.sort(function(e,t){return e.f-t.f}),n.push({s:-1,f:25001});var a=n[0],c=n[1],u=0,l=1,d=2;for(n[0]={s:-1,f:a.f+c.f,l:a,r:c};l!=r-1;)a=n[n[u].f<n[d].f?u++:d++],c=n[u!=l&&n[u].f<n[d].f?u++:d++],n[l++]={s:-1,f:a.f+c.f,l:a,r:c};var p=o[0].s;for(s=1;s<r;++s)o[s].s>p&&(p=o[s].s);var h=new Xy(p+1),f=Sb(n[l-1],h,0);if(f>t){s=0;var m=0,g=f-t,y=1<<g;for(o.sort(function(e,t){return h[t.s]-h[e.s]||e.f-t.f});s<r;++s){var b=o[s].s;if(!(h[b]>t))break;m+=y-(1<<f-h[b]),h[b]=t}for(m>>=g;m>0;){var v=o[s].s;h[v]<t?m-=1<<t-h[v]++-1:++s}for(;s>=0&&m;--s){var _=o[s].s;h[_]==t&&(--h[_],++m)}f=t}return{t:new Gy(h),l:f}},Sb=function(e,t,n){return-1==e.s?Math.max(Sb(e.l,t,n+1),Sb(e.r,t,n+1)):t[e.s]=n},wb=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Xy(++t),s=0,r=e[0],o=1,i=function(e){n[s++]=e},a=1;a<=t;++a)if(e[a]==r&&a!=t)++o;else{if(!r&&o>2){for(;o>138;o-=138)i(32754);o>2&&(i(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(i(r),--o;o>6;o-=6)i(8304);o>2&&(i(o-3<<5|8208),o=0)}for(;o--;)i(r);o=1,r=e[a]}return{c:n.subarray(0,s),n:t}},kb=function(e,t){for(var n=0,s=0;s<t.length;++s)n+=e[s]*t[s];return n},xb=function(e,t,n){var s=n.length,r=fb(t+2);e[r]=255&s,e[r+1]=s>>8,e[r+2]=255^e[r],e[r+3]=255^e[r+1];for(var o=0;o<s;++o)e[r+o+4]=n[o];return 8*(r+4+s)},Tb=function(e,t,n,s,r,o,i,a,c,u,l){bb(t,l++,n),++r[256];for(var d=_b(r,15),p=d.t,h=d.l,f=_b(o,15),m=f.t,g=f.l,y=wb(p),b=y.c,v=y.n,_=wb(m),S=_.c,w=_.n,k=new Xy(19),x=0;x<b.length;++x)++k[31&b[x]];for(x=0;x<S.length;++x)++k[31&S[x]];for(var T=_b(k,7),E=T.t,I=T.l,C=19;C>4&&!E[eb[C-1]];--C);var M,R,O,A,N=u+5<<3,D=kb(r,lb)+kb(o,db)+i,L=kb(r,p)+kb(o,m)+i+14+3*C+kb(k,E)+2*k[16]+3*k[17]+7*k[18];if(c>=0&&N<=D&&N<=L)return xb(t,l,e.subarray(c,c+u));if(bb(t,l,1+(L<D)),l+=2,L<D){M=ub(p,h,0),R=p,O=ub(m,g,0),A=m;var P=ub(E,I,0);for(bb(t,l,v-257),bb(t,l+5,w-1),bb(t,l+10,C-4),l+=14,x=0;x<C;++x)bb(t,l+3*x,E[eb[x]]);l+=3*C;for(var F=[b,S],$=0;$<2;++$){var j=F[$];for(x=0;x<j.length;++x){var B=31&j[x];bb(t,l,P[B]),l+=E[B],B>15&&(bb(t,l,j[x]>>5&127),l+=j[x]>>12)}}}else M=pb,R=lb,O=hb,A=db;for(x=0;x<a;++x){var U=s[x];if(U>255){vb(t,l,M[257+(B=U>>18&31)]),l+=R[B+257],B>7&&(bb(t,l,U>>23&31),l+=Qy[B]);var H=31&U;vb(t,l,O[H]),l+=A[H],H>3&&(vb(t,l,U>>5&8191),l+=Zy[H])}else vb(t,l,M[U]),l+=R[U]}return vb(t,l,M[256]),l+R[256]},Eb=new Yy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ib=new Gy(0),Cb=function(e,t,n,s,r,o){var i=o.z||e.length,a=new Gy(s+i+5*(1+Math.ceil(i/7e3))+r),c=a.subarray(s,a.length-r),u=o.l,l=7&(o.r||0);if(t){l&&(c[0]=o.r>>3);for(var d=Eb[t-1],p=d>>13,h=8191&d,f=(1<<n)-1,m=o.p||new Xy(32768),g=o.h||new Xy(f+1),y=Math.ceil(n/3),b=2*y,v=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<b)&f},_=new Yy(25e3),S=new Xy(288),w=new Xy(32),k=0,x=0,T=o.i||0,E=0,I=o.w||0,C=0;T+2<i;++T){var M=v(T),R=32767&T,O=g[M];if(m[R]=O,g[M]=R,I<=T){var A=i-T;if((k>7e3||E>24576)&&(A>423||!u)){l=Tb(e,c,0,_,S,w,x,E,C,T-C,l),E=k=x=0,C=T;for(var N=0;N<286;++N)S[N]=0;for(N=0;N<30;++N)w[N]=0}var D=2,L=0,P=h,F=R-O&32767;if(A>2&&M==v(T-F))for(var $=Math.min(p,A)-1,j=Math.min(32767,T),B=Math.min(258,A);F<=j&&--P&&R!=O;){if(e[T+D]==e[T+D-F]){for(var U=0;U<B&&e[T+U]==e[T+U-F];++U);if(U>D){if(D=U,L=F,U>$)break;var H=Math.min(F,U-2),z=0;for(N=0;N<H;++N){var q=T-F+N&32767,W=q-m[q]&32767;W>z&&(z=W,O=q)}}}F+=(R=O)-(O=m[R])&32767}if(L){_[E++]=268435456|rb[D]<<18|ob[L];var V=31&rb[D],J=31&ob[L];x+=Qy[V]+Zy[J],++S[257+V],++w[J],I=T+D,++k}else _[E++]=e[T],++S[e[T]]}}for(T=Math.max(T,I);T<i;++T)_[E++]=e[T],++S[e[T]];l=Tb(e,c,u,_,S,w,x,E,C,T-C,l),u||(o.r=7&l|c[l/8|0]<<3,l-=7,o.h=g,o.p=m,o.i=T,o.w=I)}else{for(T=o.w||0;T<i+u;T+=65535){var K=T+65535;K>=i&&(c[l/8|0]=u,K=i),l=xb(c,l+1,e.subarray(T,K))}o.i=i}return mb(a,0,s+fb(l)+r)},Mb=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,s=9;--s;)n=(1&n&&-306674912)^n>>>1;e[t]=n}return e}(),Rb=function(){var e=-1;return{p:function(t){for(var n=e,s=0;s<t.length;++s)n=Mb[255&n^t[s]]^n>>>8;e=n},d:function(){return~e}}},Ob=function(e,t,n,s,r){if(!r&&(r={l:1},t.dictionary)){var o=t.dictionary.subarray(-32768),i=new Gy(o.length+e.length);i.set(o),i.set(e,o.length),e=i,r.w=o.length}return Cb(e,null==t.level?6:t.level,null==t.mem?r.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,n,s,r)},Ab=function(e,t,n){for(var s=e(),r=e.toString(),o=r.slice(r.indexOf("[")+1,r.lastIndexOf("]")).replace(/\s+/g,"").split(","),i=0;i<s.length;++i){var a=s[i],c=o[i];if("function"==typeof a){t+=";"+c+"=";var u=a.toString();if(a.prototype)if(-1!=u.indexOf("[native code]")){var l=u.indexOf(" ",8)+1;t+=u.slice(l,u.indexOf("(",l))}else for(var d in t+=u,a.prototype)t+=";"+c+".prototype."+d+"="+a.prototype[d].toString();else t+=u}else n[c]=a}return t},Nb=[],Db=function(){return[Gy,Xy,Yy,Qy,Zy,eb,rb,ob,pb,lb,hb,db,ib,Eb,Ib,ub,bb,vb,_b,Sb,wb,kb,xb,Tb,fb,mb,Cb,Ob,Bb,Pb]},Lb=function(){return[$b,jb,Fb,Rb,Mb]},Pb=function(e){return postMessage(e,[e.buffer])},Fb=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},$b=function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&Fb(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var s=0;s<=n.length;++s)e[s+10]=n.charCodeAt(s)}},jb=function(e){return 10+(e.filename?e.filename.length+1:0)};function Bb(e,t){return Ob(e,t||{},0,0)}function Ub(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&yb(7),function(e,t,n,s,r,o){var i=function(e,t,n,s){if(!Nb[n]){for(var r="",o={},i=e.length-1,a=0;a<i;++a)r=Ab(e[a],r,o);Nb[n]={c:Ab(e[i],r,o),e:o}}var c=function(e,t){var n={};for(var s in e)n[s]=e[s];for(var s in t)n[s]=t[s];return n}({},Nb[n].e);return function(e,t,n,s,r){var o=new Worker(Ky[t]||(Ky[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return o.onmessage=function(e){var t=e.data,n=t.$e$;if(n){var s=new Error(n[0]);s.code=n[1],s.stack=n[2],r(s,null)}else r(null,t)},o.postMessage(n,s),o}(Nb[n].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,c,function(e){var t=[];for(var n in e)e[n].buffer&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t}(c),s)}(n,function(e){return Pb(Hb(e.data[0],e.data[1]))},2,function(e,t){i.terminate(),o(e,t)});return i.postMessage([e,t],t.consume?[e.buffer]:[]),function(){i.terminate()}}(e,t,[Db,Lb,function(){return[Hb]}],0,0,n)}function Hb(e,t){t||(t={});var n=Rb(),s=e.length;n.p(e);var r=Ob(e,t,jb(t),8),o=r.length;return $b(r,t),Fb(r,o-8,n.d()),Fb(r,o-4,s),r}var zb="undefined"!=typeof TextDecoder&&new TextDecoder;try{zb.decode(Ib,{stream:!0})}catch(e){}class qb{constructor(){this.lastTs=0,this.lastSuffix=1,this.backDict={},this.getKey=e=>{let t=!1;const n=`__${e}`;if(!this.backDict[n]){t=!0;const e=Date.now()%10**11;let s=e;s===this.lastTs?(s=1e4*s+this.lastSuffix,this.lastSuffix+=1):this.lastSuffix=1,this.backDict[n]=s,this.lastTs=e}return[this.backDict[n],t]}}}class Wb{constructor(e){this.sendSetAttribute=(e,t,n)=>{if(this.isDictDisabled){const s=[12,e,t,n];return this.app.send(s)}{const s=[35,e,this.applyDict(t),this.applyDict(n)];return this.app.send(s)}},this.app=e.app,this.isDictDisabled=e.isDictDisabled,this.dict=new qb}applyDict(e){const[t,n]=this.dict.getKey(e);return n&&this.app.send([34,t,e]),t}clear(){this.dict=new qb}}class Vb{constructor(e,t){this.app=e,this.startParams=t,this.conditions=[],this.hasStarted=!1,this.createConditionFromFilter=e=>{const t=Kb(e);if(t.type)return t},this.durationInt=null}setConditions(e){this.conditions=e}async fetchConditions(e,t){try{const n=await fetch(`${this.app.options.ingestPoint}/v1/web/conditions/${e}`,{method:"GET",headers:{Authorization:`Bearer ${t}`}}),{conditions:s}=await n.json(),r=[];s.forEach(e=>{e.filters.forEach(t=>{let n;"fetch"===t.type?(n={type:"network_request",subConditions:[],name:e.name},t.filters.forEach(e=>{const t=this.createConditionFromFilter(e);t&&n.subConditions.push(t)})):n=this.createConditionFromFilter(t),n&&("session_duration"===n.type&&this.processDuration(n.value[0],e.name),r.push({...n,name:e.name}))})}),this.conditions=r}catch(e){this.app.debug.error("Critical: cannot fetch start conditions")}}trigger(e){if(!this.hasStarted)try{this.hasStarted=!0,this.app.start(this.startParams,void 0,e)}catch(e){this.app.debug.error(e)}}processMessage(e){if(!this.hasStarted)switch(e[0]){case 78:this.jsExceptionEvent(e);break;case 27:this.customEvent(e);break;case 68:this.clickEvent(e);break;case 122:this.pageLocationEvent(e);break;case 83:this.networkRequest(e)}}processFlags(e){const t=this.conditions.filter(e=>"feature_flag"===e.type);t.length&&t.forEach(t=>{const n=Jb[t.operator];n&&e.find(e=>n(e.key,t.value))&&this.trigger(t.name)})}processDuration(e,t){this.durationInt=setInterval(()=>{performance.now()>e&&this.trigger(t)},1e3),this.app.attachStopCallback(()=>{this.durationInt&&clearInterval(this.durationInt)})}networkRequest(e){const t=this.conditions.filter(e=>"network_request"===e.type);t.length&&t.forEach(t=>{const n=t.subConditions.filter(e=>"isAny"!==e.operator);n.length?n.every(t=>{let n;switch(t.key){case"url":n=e[3];break;case"status":n=e[6];break;case"method":n=e[2];break;case"duration":n=e[8]}const s=Jb[t.operator];if(s&&s(n,t.value))return!0})&&this.trigger(t.name):0===n.length&&t.subConditions.length&&this.trigger(t.name)})}customEvent(e){const t=this.conditions.filter(e=>"custom_event"===e.type);t.length&&t.forEach(t=>{const n=Jb[t.operator];n&&(n(e[1],t.value)||n(e[2],t.value))&&this.trigger(t.name)})}clickEvent(e){const t=this.conditions.filter(e=>"click"===e.type);t.length&&t.forEach(t=>{const n=Jb[t.operator];n&&(n(e[3],t.value)||n(e[4],t.value))&&this.trigger(t.name)})}pageLocationEvent(e){const t=this.conditions.filter(e=>"visited_url"===e.type);t&&t.forEach(t=>{const n=Jb[t.operator];n&&n(e[1],t.value)&&this.trigger(t.name)})}jsExceptionEvent(e){const t=[e[1],e[2],e[3]],n=this.conditions.filter(e=>"exception"===e.type);n&&n.forEach(e=>{const n=Jb[e.operator];n&&t.some(t=>n(t,e.value))&&this.trigger(e.name)})}}const Jb={is:(e,t)=>t.some(t=>e.includes(t)),isAny:()=>!0,isNot:(e,t)=>!t.some(t=>e.includes(t)),contains:(e,t)=>t.some(t=>e.includes(t)),notContains:(e,t)=>!t.some(t=>e.includes(t)),startsWith:(e,t)=>t.some(t=>e.startsWith(t)),endsWith:(e,t)=>t.some(t=>e.endsWith(t)),greaterThan:(e,t)=>e>t,greaterOrEqual:(e,t)=>e>=t,lessOrEqual:(e,t)=>e<=t,lessThan:(e,t)=>e<t},Kb=e=>{const t={on:"is",notOn:"isNot",">":"greaterThan","<":"lessThan","=":"is","<=":"lessOrEqual",">=":"greaterOrEqual"},n=e=>{if(Object.keys(t).includes(e))return t[e]};let s={type:"",operator:"",value:e.value,key:""};switch(e.type){case"click":s={type:"click",operator:n(e.operator),value:e.value,key:""};break;case"location":s={type:"visited_url",operator:e.operator,value:e.value,key:""};break;case"custom":s={type:"custom_event",operator:e.operator,value:e.value,key:""};break;case"metadata":s={type:"featureFlag"===e.source?"feature_flag":e.type,operator:e.operator,value:e.value,key:""};break;case"error":s={type:"exception",operator:e.operator,value:e.value,key:""};break;case"duration":s={type:"session_duration",value:e.value,key:"",operator:"is"};break;case"fetchUrl":s={type:"network_request",key:"url",operator:e.operator,value:e.value};break;case"fetchStatusCode":s={type:"network_request",key:"status",operator:n(e.operator),value:e.value};break;case"fetchMethod":s={type:"network_request",key:"method",operator:n(e.operator),value:e.value};break;case"fetchDuration":s={type:"network_request",key:"duration",operator:n(e.operator),value:e.value}}return s};class Gb{constructor(e){this.app=e,this.flags=[],this.storageKey="__openreplay_flags";const t=this.app.sessionStorage.getItem(this.storageKey);if(t){const e=t.split(";").filter(Boolean);this.flags=e.map(e=>JSON.parse(e))}}getFeatureFlag(e){return this.flags.find(t=>t.key===e)}isFlagEnabled(e){return-1!==this.flags.findIndex(t=>t.key===e)}onFlagsLoad(e){this.onFlagsCb=e}async reloadFlags(e){const t=this.app.sessionStorage.getItem(this.storageKey),n={};t&&t.split(";").filter(Boolean).forEach(e=>{const t=JSON.parse(e);n[t.key]={key:t.key,value:t.value}});const s=this.app.session.getInfo(),r=this.app.session.userInfo,o={projectID:s.projectID,userID:s.userID,metadata:s.metadata,referrer:document.referrer,os:r.userOS,device:r.userDevice,country:r.userCountry,state:r.userState,city:r.userCity,browser:r.userBrowser,persistFlags:n},i=e??this.app.session.getSessionToken(),a=await fetch(this.app.options.ingestPoint+"/v1/web/feature-flags",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(o)});if(200===a.status){const e=await a.json();return this.handleFlags(e.flags)}}handleFlags(e){const t=[];e.forEach(e=>{e.is_persist&&t.push(e)});let n="";return this.diffPersist(t).forEach(e=>{n+=`${JSON.stringify(e)};`}),this.app.sessionStorage.setItem(this.storageKey,n),this.flags=e,this.onFlagsCb?.(e)}clearPersistFlags(){this.app.sessionStorage.removeItem(this.storageKey)}diffPersist(e){const t=this.app.sessionStorage.getItem(this.storageKey);if(!t)return e;const n=t.split(";").filter(Boolean).map(e=>JSON.parse(e));return e.filter(e=>-1===n.findIndex(t=>t.key===e.key))}}const Xb={htmlmasked:"hidden",masked:"obscured"},Yb=!("undefined"==typeof window),Qb=Yb&&navigator.userAgent.match(/firefox|fxios/i);let Zb=Yb?Date.now()-performance.now():0;function ev(){Zb=Date.now()-performance.now()}function tv(){return Zb}const nv=Yb&&performance.now?()=>Math.round(performance.now()+Zb):()=>Date.now(),sv="repeat"in String.prototype?e=>"*".repeat(e.length):e=>e.replace(/./g,"*");function rv(e){return e.trim().replace(/\s+/g," ")}function ov(e){return e.startsWith("https://")||e.startsWith("http://")}const iv="https://docs.openreplay.com",av={};function cv(e,t,n="/"){av[e]||(console.warn(`OpenReplay: ${e} is deprecated. ${t?`Please, use ${t} instead.`:""} Visit ${iv}${n} for more information.`),av[e]=!0)}function uv(e){let t=e.getAttribute("data-openreplay-label");return null!==t||(t=e.getAttribute("data-asayer-label"),null!==t&&cv('"data-asayer-label" attribute','"data-openreplay-label" attribute',"/")),t}function lv(e,t){const n=`data-openreplay-${t}`;return!!e.hasAttribute(n)&&(Xb[t]&&cv(`"${n}" attribute`,`"${Xb[t]}" attribute`,"/en/sdk/sanitize-data"),!0)}function dv(e){try{return e instanceof HTMLIFrameElement?e.contentDocument:e instanceof Window?e.document:e instanceof Document?e.defaultView:"nodeType"in e?e.nodeType:"addEventListener"in e&&e.addEventListener,!0}catch(e){if(e instanceof DOMException&&"SecurityError"===e.name)return!1}return!0}function pv(e){return e.toString(16).padStart(2,"0")}function hv(){try{return window.self&&window.top&&window.self!==window.top}catch(e){return!0}}function fv(e){return window.Zone&&"__symbol__"in window.Zone?window.Zone.__symbol__(e):e}function mv(e,t){if(t)return new MutationObserver(e);{const t=fv("MutationObserver");return new window[t](e)}}function gv(e,t,n,s,r){if(!dv(e))return;let o="addEventListener";r||(o=fv("addEventListener"));try{e[o]?e[o](t,n,s):e.addEventListener(t,n,s)}catch(n){const s=n.message;console.error(`Openreplay: ${s}; if this error is caused by an IframeObserver, ignore it`,t,e)}}function yv(e,t,n,s,r){if(!dv(e))return;let o="removeEventListener";r||(o=fv("removeEventListener"));try{e[o]?e[o](t,n,s):e.removeEventListener(t,n,s)}catch(n){const s=n.message;console.error(`Openreplay: ${s}; if this error is caused by an IframeObserver, ignore it`,t,e)}}const bv=new class{constructor(){this.taskQueue=[],this.isRunning=!1}addTask(e){this.taskQueue.push(e),this.runTasks()}runTasks(){if(this.isRunning||0===this.taskQueue.length)return;this.isRunning=!0;const e=()=>{if(0===this.taskQueue.length)return void(this.isRunning=!1);const t=this.taskQueue.shift();Promise.resolve(t()).then(()=>{requestAnimationFrame(()=>e())})};e()}};function vv(e){bv.addTask(e)}function _v(e,t){const n={...e};for(const s in t)if(t.hasOwnProperty(s)){const r=t[s],o=e[s];"object"!=typeof r||Array.isArray(r)||null===r?n[s]=r:n[s]=_v(o||{},r)}return n}function Sv(e){return[0,e]}function wv(e,t,n,s,r){return[8,e,t,n,s,r]}function kv(e,t,n){return[9,e,t,n]}function xv(e,t){return[13,e,t]}function Tv(e,t){return[30,e,t]}function Ev(e,t,n,s){return[57,e,t,n,s]}function Iv(e){return[58,e]}function Cv(e,t,n,s){return[60,e,t,n,s]}function Mv(e,t,n){return[61,e,t,n]}function Rv(e,t){return[70,e,t]}function Ov(e,t,n){return[71,e,t,n]}function Av(e,t,n,s){return[73,e,t,n,s]}function Nv(e,t){return[75,e,t]}function Dv(e,t){return[76,e,t]}function Lv(e,t){return[77,e,t]}function Pv(e,t,n,s){return[78,e,t,n,s]}function Fv(e,t,n,s,r,o,i,a,c){return[83,e,t,n,s,r,o,i,a,c]}function $v(e,t,n){return[113,e,t,n]}function jv(e){return[115,e]}function Bv(e,t,n,s,r,o,i,a,c,u){return[116,e,t,n,s,r,o,i,a,c,u]}function Uv(e){return[117,e]}function Hv(e){return[118,e]}const zv=Yb&&"performance"in window&&"memory"in performance?performance:{memory:{}},qv=Yb?1024*(navigator.deviceMemory||0):0,Wv=zv.memory.jsHeapSizeLimit||0,Vv="__or__watched_tags__";class Jv{constructor(e){this.intervals={},this.tags=[],this.sessionStorage=e.sessionStorage,this.errLog=e.errLog,this.onTag=e.onTag;const t=JSON.parse(e.sessionStorage.getItem(Vv)??"[]");this.setTags(t),this.observer=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting&&e.target){const t=e.target.__or_watcher_tagname;t&&this.onTagRendered(t),this.observer.unobserve(e.target)}})})}async fetchTags(e,t){return fetch(`${e}/v1/web/tags`,{method:"GET",headers:{Authorization:`Bearer ${t}`}}).then(e=>e.json()).then(({tags:e})=>{if(e&&e.length){this.setTags(e);const t=JSON.stringify(e);this.sessionStorage.setItem(Vv,t||"")}}).catch(e=>this.errLog(e))}setTags(e){this.tags=e,this.intervals={},e.forEach(e=>{this.intervals[e.id]=setInterval(()=>{const t=document.querySelectorAll(e.selector);if(t.length>0){const n=t[0];n.__or_watcher_tagname=e.id,this.observer.observe(n)}},500)})}onTagRendered(e){this.intervals[e]&&clearInterval(this.intervals[e]),this.onTag(e)}clear(){this.tags.forEach(e=>{clearInterval(this.intervals[e.id])}),this.tags=[],this.intervals={},this.observer.disconnect()}}const Kv={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.40)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},Gv={display:"flex",flexDirection:"column",gap:"2rem",alignItems:"center",padding:"1.5rem",borderRadius:"2px",border:"1px solid rgb(255 255 255 / var(--tw-bg-opacity, 1))",background:"#FFF",width:"22rem"},Xv={display:"flex","flex-direction":"column",gap:"unset","align-items":"center",padding:"unset",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',"border-radius":"2px",border:"1px solid rgb(255 255 255 / var(--tw-bg-opacity, 1))",background:"rgba(255, 255, 255, 0.75)",width:"22rem"},Yv={fontFamily:"Verdana, sans-serif",fontSize:"1.25rem",fontStyle:"normal",fontWeight:"500",lineHeight:"1.75rem",color:"rgba(0, 0, 0, 0.85)"},Qv={borderTop:"1px solid rgba(0, 0, 0, 0.06)",borderBottom:"1px solid rgba(0, 0, 0, 0.06)",padding:"1.25rem 0rem",color:"rgba(0, 0, 0, 0.85)",fontFamily:"Verdana, sans-serif",fontSize:"13px",fontStyle:"normal",fontWeight:"400",lineHeight:"auto",whiteSpace:"pre-wrap"},Zv={display:"flex",padding:"0.4rem 0.9375rem",justifyContent:"center",alignItems:"center",gap:"0.625rem",borderRadius:"0.25rem",border:"1px solid #394EFF",background:"#394EFF",boxShadow:"0px 2px 0px 0px rgba(0, 0, 0, 0.04)",color:"#FFF",textAlign:"center",fontFamily:"Verdana, sans-serif",fontSize:"1rem",fontStyle:"normal",fontWeight:"500",lineHeight:"1.5rem",cursor:"pointer"},e_={fontFamily:"Verdana, sans-serif",fontSize:"13px",fontWeight:"500",lineHeight:"auto",display:"flex",justifyContent:"space-between",width:"100%",cursor:"pointer"},t_={display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"0.625rem",fontSize:"13px",lineHeight:"auto"},n_={padding:"0.5rem",gap:"0.5rem",fontFamily:"Verdana, sans-serif",fontSize:"16px",fontStyle:"normal",fontWeight:"500",lineHeight:"auto",color:"white",display:"flex",alignItems:"center",width:"100%",borderRadius:"2px",background:"rgba(0, 0, 0, 0.75)",boxSizing:"border-box"},s_={boxSizing:"border-box",display:"block",width:"100%",borderBottom:"1px solid rgb(255 255 255 / var(--tw-bg-opacity, 1))",background:"#FFF",padding:"0.65rem",alignSelf:"stretch",color:"#000",fontFamily:"Verdana, sans-serif",fontStyle:"normal",fontWeight:"400"},r_={...s_,display:"flex",flexDirection:"column",alignItems:"center",gap:"0.625rem"},o_={fontSize:"1.25rem",fontWeight:"500",cursor:"pointer",color:"#394EFF"},i_={display:"flex",padding:"0.4rem 0.9375rem",justifyContent:"center",alignItems:"center",gap:"0.625rem",borderRadius:"0.25rem",border:"1px solid #394EFF",background:"#394EFF",boxShadow:"0px 2px 0px 0px rgba(0, 0, 0, 0.04)",color:"#FFF",textAlign:"center",fontFamily:"Verdana, sans-serif",fontSize:"1rem",fontStyle:"normal",fontWeight:"500",lineHeight:"1.5rem",width:"100%",boxSizing:"border-box",cursor:"pointer"},a_={marginTop:"1rem",marginBottom:"1rem",cursor:"pointer",display:"block",fontWeight:"500",fontSize:"13px!important",lineHeight:"auto"},c_={display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",padding:"0.5rem",width:"100%",boxSizing:"border-box"},u_={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"6.25em",outline:"1px solid #394EFF",fontSize:"13px",height:"24px",width:"24px"},l_={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"6.25em",outline:"1px solid #D2DFFF",boxShadow:"0px 2px 0px 0px rgba(0, 0, 0, 0.04)",background:"#D2DFFF",fontSize:"13px",height:"24px",width:"24px"},d_={borderRadius:"0.375rem",border:"1px solid rgba(0, 0, 0, 0.06)",background:"#F5F7FF",boxShadow:"0px 2px 0px 0px rgba(0, 0, 0, 0.04)",display:"flex",flexDirection:"column",padding:"0.625rem 0.9375rem",gap:"0.5rem",alignSelf:"stretch"},p_={fontWeight:"bold"},h_={fontSize:"13px",lineHeight:"auto"},f_={marginRight:"0.5rem",cursor:"pointer",color:"#394EFF",textAlign:"center",fontFamily:"Verdana, sans-serif",fontSize:"13px",fontStyle:"normal",fontWeight:"500",lineHeight:"auto"},m_={...f_,display:"flex",padding:"0.25rem 0.9375rem",justifyContent:"center",alignItems:"center",gap:"0.5rem",borderRadius:"0.25rem",border:"1px solid #394EFF"},g_={display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",boxSizing:"border-box"},y_={border:"4px solid rgba(255, 255, 255, 0.4)",width:"16px",height:"16px",borderRadius:"50%",borderLeftColor:"#fff",animation:"spin 0.5s linear infinite"},b_={width:1280,height:720};class v_{constructor(e){this.app=e,this.mediaRecorder=null,this.recordedChunks=[],this.stream=null,this.recStartTs=null}async startRecording(e,t,n,s){this.recStartTs=this.app.timestamp();const r=t;try{this.stream=await navigator.mediaDevices.getUserMedia({video:!!s&&{...r,frameRate:{ideal:e}},audio:n}),this.mediaRecorder=new MediaRecorder(this.stream,{mimeType:"video/webm;codecs=vp9"}),this.recordedChunks=[],this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&this.recordedChunks.push(e.data)},this.mediaRecorder.start()}catch(e){console.error(e)}}async stopRecording(){return new Promise(e=>{this.mediaRecorder&&(this.mediaRecorder.onstop=()=>{const t=new Blob(this.recordedChunks,{type:"video/webm"});e(t)},this.mediaRecorder.stop())})}async sendToAPI(){const e=await this.stopRecording();return fetch(`${this.app.options.ingestPoint}/v1/web/uxt/upload-url`,{headers:{Authorization:`Bearer ${this.app.session.getSessionToken()}`}}).then(e=>{if(e.ok)return e.json();throw new Error("Failed to get upload url")}).then(({url:t})=>fetch(t,{method:"PUT",headers:{"Content-Type":"video/webm"},body:e})).catch(console.error).finally(()=>{this.discard()})}async saveToFile(e="recorded-video.webm"){const t=await this.stopRecording(),n=URL.createObjectURL(t),s=document.createElement("a");s.style.display="none",s.href=n,s.download=e,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(n),document.body.removeChild(s)}discard(){this.mediaRecorder?.stop(),this.stream?.getTracks().forEach(e=>e.stop())}}function __(e,t,n,s,r){const o=document.createElement(e);return o.className=t,Object.assign(o.style,n),s&&(o.textContent=s),r&&(o.id=r),o}const S_="or_uxt_test_start",w_="or_uxt_task_index",k_="or_uxt_session_id";class x_{constructor(e,t,n,s,r,o,i,a,c){this.ingestPoint=e,this.getTimestamp=t,this.token=n,this.testId=s,this.storageKey=r,this.setStorageKey=o,this.removeStorageKey=i,this.getStorageKey=a,this.getSessionId=c,this.durations={testStart:0,tasks:[]},this.getDurations=()=>this.durations,this.setDurations=e=>{this.durations.testStart=e.testStart,this.durations.tasks=e.tasks},this.signalTask=(e,t,n)=>{if(!e)return console.error("User Testing: No Task ID Given");const s=this.durations.tasks.find(t=>t.taskId===e),r=this.getTimestamp(),o=s?r-s.started:0;return fetch(`${this.ingestPoint}/v1/web/uxt/signals/task`,{method:"POST",headers:{Authorization:`Bearer ${this.token}`},body:JSON.stringify({testId:this.testId,taskId:e,status:t,duration:o,timestamp:r,taskAnswer:n})})},this.signalTest=e=>{const t=this.getTimestamp();if("begin"===e&&this.testId){const e=this.getSessionId();this.setStorageKey(k_,e),this.setStorageKey(this.storageKey,this.testId.toString()),this.setStorageKey(S_,t.toString())}else this.removeStorageKey(this.storageKey),this.removeStorageKey(w_),this.removeStorageKey(S_);const n=t-(this.durations.testStart||t);return fetch(`${this.ingestPoint}/v1/web/uxt/signals/test`,{method:"POST",headers:{Authorization:`Bearer ${this.token}`},body:JSON.stringify({testId:this.testId,status:e,duration:n,timestamp:t})})};const u=this.getStorageKey(S_);u&&(this.durations.testStart=parseInt(u,10))}}class T_{constructor(e,t){this.app=e,this.storageKey=t,this.bg=__("div","bg",Kv,void 0,"__or_ut_bg"),this.container=__("div","container",Gv,void 0,"__or_ut_ct"),this.widgetGuidelinesVisible=!0,this.widgetTasksVisible=!1,this.widgetVisible=!0,this.isActive=!1,this.descriptionSection=null,this.taskSection=null,this.endSection=null,this.stopButton=null,this.stopButtonContainer=null,this.test=null,this.testId=null,this.signalManager=null,this.getTest=(e,t,n)=>{this.testId=e;const s=this.app.options.ingestPoint;return fetch(`${s}/v1/web/uxt/test/${e}`,{headers:{Authorization:`Bearer ${t}`}}).then(e=>e.json()).then(({test:s})=>{this.isActive=!0,this.test=s,this.signalManager=new x_(this.app.options.ingestPoint,()=>this.app.timestamp(),t,e,this.storageKey,(e,t)=>this.app.localStorage.setItem(e,t),e=>this.app.localStorage.removeItem(e),e=>this.app.localStorage.getItem(e),()=>this.app.getSessionID()),this.createGreeting(s.title,s.reqMic,s.reqCamera),n&&((s.reqMic||s.reqCamera)&&this.userRecorder.startRecording(30,b_,s.reqMic,s.reqCamera),this.showWidget(s.description,s.tasks,!0),this.showTaskSection())}).then(()=>e).catch(e=>{console.log("OR: Error fetching test",e)})},this.hideTaskSection=()=>!1,this.showTaskSection=()=>!0,this.collapseWidget=()=>!1,this.removeGreeting=()=>!1,this.toggleDescriptionVisibility=()=>{},this.currentTaskIndex=0,this.userRecorder=new v_(e),this.app.getSessionID()!==this.app.localStorage.getItem(k_)&&(this.app.localStorage.removeItem(this.storageKey),this.app.localStorage.removeItem(k_),this.app.localStorage.removeItem("or_uxt_test_id"),this.app.localStorage.removeItem(w_),this.app.localStorage.removeItem(S_));const n=this.app.localStorage.getItem(w_);n&&(this.currentTaskIndex=parseInt(n,10))}getTestId(){return this.testId}createGreeting(e,t,n){const s=__("div","title",Yv,e),r=__("div","description",Qv,"Welcome, you're here to help us improve, not to be judged. Your insights matter!\n\n We're recording this browser tab to learn from your experience.\n Please enable mic and camera if asked, to give us a complete picture."),o=__("div","button",Zv,"Read guidelines to begin");this.removeGreeting=()=>((t||n)&&this.userRecorder.startRecording(30,b_,t,n),this.container.removeChild(o),this.container.removeChild(r),this.container.removeChild(s),!1),o.onclick=()=>{this.removeGreeting();const e=this.signalManager?.getDurations();e&&this.signalManager&&(e.testStart=this.app.timestamp(),this.signalManager.setDurations(e)),this.signalManager?.signalTest("begin"),this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',Object.assign(this.container.style,Xv),this.showWidget(this.test?.guidelines||"",this.test?.tasks||[])},this.container.append(s,r,o),this.bg.appendChild(this.container),document.body.appendChild(this.bg)}showWidget(e,t,n){this.container.innerHTML="",Object.assign(this.bg.style,{position:"fixed",zIndex:99999999999999,right:"8px",left:"unset",width:"fit-content",top:"8px",height:"fit-content",background:"unset",display:"unset",alignItems:"unset",justifyContent:"unset"});const s=this.createTitleSection();this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',Object.assign(this.container.style,Xv);const r=this.createDescriptionSection(e),o=this.createTasksSection(t),i=__("div","stop_bn_or",a_,"Abort Session"),a=__("div","stop_ct_or",{fontSize:"13px!important"});a.style.fontSize="13px",a.append(i),this.container.append(s,r,o,a),this.taskSection=o,this.descriptionSection=r,this.stopButton=i,this.stopButtonContainer=a,i.onclick=()=>{this.userRecorder.discard(),this.signalManager?.signalTest("skipped"),document.body.removeChild(this.bg),window.close()},n?this.toggleDescriptionVisibility():this.hideTaskSection()}createTitleSection(){const e=__("div","title",n_),t=function(){const e=document.createElement("div");e.className="grid";for(let t=0;t<16;t++){const t=document.createElement("div");Object.assign(t.style,{width:"2px",height:"2px",borderRadius:"10px",background:"white"}),t.className="cell",e.appendChild(t)}return Object.assign(e.style,{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"repeat(4, 1fr)",gap:"2px",cursor:"grab"}),e}(),n=__("div","title_text",{maxWidth:"19rem",overflow:"hidden",textOverflow:"ellipsis",width:"100%",fontSize:16,lineHeight:"auto",cursor:"pointer"},this.test?.title),s=function(){const e=document.createElement("div");Object.assign(e.style,{width:"0",height:"0",borderLeft:"7px solid transparent",borderRight:"7px solid transparent",borderBottom:"7px solid white"});const t=document.createElement("div");return t.appendChild(e),Object.assign(t.style,{display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",cursor:"pointer",marginLeft:"auto",transform:"rotate(180deg)"}),t}();e.append(t,n,s);const r=e=>(this.widgetVisible=e,this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',Object.assign(this.container.style,this.widgetVisible?Xv:{border:"none",background:"none",padding:0}),this.taskSection&&Object.assign(this.taskSection.style,this.widgetVisible?s_:{display:"none"}),this.descriptionSection&&Object.assign(this.descriptionSection.style,this.widgetVisible?s_:{display:"none"}),this.endSection&&Object.assign(this.endSection.style,this.widgetVisible?s_:{display:"none"}),this.stopButton&&Object.assign(this.stopButton.style,this.widgetVisible?a_:{display:"none"}),e),o=()=>{Object.assign(s.style,{transform:this.widgetVisible?"rotate(0deg)":"rotate(180deg)"}),r(!this.widgetVisible)};var i,a;return n.onclick=o,s.onclick=o,i=this.bg,(a=t).onmousedown=function(e){const t=i.getBoundingClientRect(),n=e.clientX-t.left,s=e.clientY-t.top;function r(e,r){let o=e-n,a=r-s;o<=5&&(o=5),a<=5&&(a=5),o>=window.innerWidth-t.width&&(o=window.innerWidth-t.width),a>=window.innerHeight-t.height&&(a=window.innerHeight-t.height),i.style.left=`${o}px`,i.style.top=`${a}px`}function o(e){r(e.pageX,e.pageY)}i.style.position="fixed",i.style.zIndex=99999999999999,r(e.pageX,e.pageY),document.addEventListener("mousemove",o);const a=()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a)};document.addEventListener("mouseup",a)},a.ondragstart=function(){return!1},this.collapseWidget=()=>r(!1),e}createDescriptionSection(e){const t=__("div","description_section_or",s_),n=__("div","description_s_title_or",e_),s=__("div","title",{fontSize:13,fontWeight:500,lineHeight:"auto"},"Introduction & Guidelines"),r=__("div","icon",o_,"-"),o=__("div","content",t_),i=__("div","text_description",{maxHeight:"250px",overflowY:"auto",whiteSpace:"pre-wrap",fontSize:13,color:"#454545",lineHeight:"auto"});i.innerHTML=e;const a=__("div","button_begin_or",i_,"Begin Test");n.append(s,r),o.append(i,a),t.append(n,o);const c=()=>{this.widgetGuidelinesVisible=!this.widgetGuidelinesVisible,r.textContent=this.widgetGuidelinesVisible?"-":"+",Object.assign(o.style,this.widgetGuidelinesVisible?t_:{display:"none"})};return n.onclick=c,this.toggleDescriptionVisibility=()=>{this.widgetGuidelinesVisible=!1,r.textContent=this.widgetGuidelinesVisible?"-":"+",Object.assign(o.style,this.widgetGuidelinesVisible?t_:{display:"none"}),o.removeChild(a)},a.onclick=()=>{if(c(),this.test){const e=this.signalManager?.getDurations(),t=e?e.tasks.findIndex(e=>this.test&&e.taskId===this.test.tasks[0].task_id):null;e&&-1===t&&(e.tasks.push({taskId:this.test.tasks[0].task_id,started:this.app.timestamp()}),this.signalManager?.setDurations(e)),this.signalManager?.signalTask(this.test.tasks[0].task_id,"begin")}this.showTaskSection(),o.removeChild(a)},t}createTasksSection(e){this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',Object.assign(this.container.style,Xv);const t=__("div","task_section_or",s_),n=__("div","description_t_title_or",e_),s=__("div","title",{fontSize:"13px",fontWeight:"500",lineHeight:"auto"},"Tasks"),r=__("div","icon",o_,"-"),o=__("div","content",t_),i=__("div","pagination",c_),a=__("div","taskCard",d_),c=__("div","taskText",p_),u=__("div","taskDescription",h_),l=__("div","taskButtons",g_),d=__("div","taskText",p_);d.textContent="Your answer";const p=__("textarea","taskDescription",{resize:"vertical"}),h=__("div","inputArea",d_);h.append(d,p);const f=__("div","closePanelButton",f_,"Collapse Panel"),m=__("div","nextButton",m_,"Done, Next");n.append(s,r),a.append(c,u),l.append(f,m),o.append(i,a,h,l),t.append(n,o);const g=()=>{const t=e[this.currentTaskIndex];c.textContent=t.title,u.textContent=t.description,t.allow_typing?h.style.display="flex":h.style.display="none"};e.forEach((e,t)=>{const n=__("span",`or_task_${t}`,{outline:"1px solid #efefef",fontSize:"13px",height:"24px",width:"24px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"6.25em"},(t+1).toString());n.id=`or_task_${t}`,i.append(n)}),this.hideTaskSection=()=>(r.textContent="+",Object.assign(o.style,{display:"none"}),this.widgetTasksVisible=!1,!1),this.showTaskSection=()=>(r.textContent="-",Object.assign(o.style,t_),this.widgetTasksVisible=!0,!0);const y=()=>{const e=document.getElementById(`or_task_${this.currentTaskIndex}`);e&&Object.assign(e.style,u_);for(let e=0;e<this.currentTaskIndex;e++){const t=document.getElementById(`or_task_${e}`);t&&Object.assign(t.style,l_)}};return n.onclick=()=>{this.widgetTasksVisible=!this.widgetTasksVisible,r.textContent=this.widgetTasksVisible?"-":"+",Object.assign(o.style,this.widgetTasksVisible?t_:{display:"none"})},f.onclick=this.collapseWidget,m.onclick=()=>{const t=e[this.currentTaskIndex].allow_typing?p.value:void 0;if(p.value="",this.signalManager?.signalTask(e[this.currentTaskIndex].task_id,"done",t),this.currentTaskIndex<e.length-1){this.currentTaskIndex++,g();const t=this.signalManager?.getDurations();t&&-1===t.tasks.findIndex(t=>t.taskId===e[this.currentTaskIndex].task_id)&&(t.tasks.push({taskId:e[this.currentTaskIndex].task_id,started:this.app.timestamp()}),this.signalManager?.setDurations(t)),this.signalManager?.signalTask(e[this.currentTaskIndex].task_id,"begin"),y()}else this.showEndSection();this.app.localStorage.setItem("or_uxt_task_index",this.currentTaskIndex.toString())},setTimeout(()=>{const e=document.getElementById("or_task_0");e&&Object.assign(e.style,u_),g(),y()},1),t}showEndSection(){let e=!0;this.signalManager?.signalTest("done");const t=__("div","end_section_or",r_),n=__("div","end_title_or",{fontSize:"1.25rem",fontWeight:"500"},"Thank you! "),s=__("div","end_description_or",{},this.test?.conclusion??"Thank you for participating in our usability test. Your feedback has been captured and will be used to enhance our website. \n\nWe appreciate your time and valuable input."),r=__("div","end_button_or",i_,"Submitting Feedback"),o=function(){!function(){const e=document.createElement("style");e.type="text/css",e.innerText="@keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n    }",document.head.appendChild(e)}();const e=document.createElement("div");return e.classList.add("spinner"),Object.assign(e.style,y_),e}();r.appendChild(o),this.test?.reqMic||this.test?.reqCamera?this.userRecorder.sendToAPI().then(()=>{r.removeChild(o),r.textContent="End Session",e=!1}).catch(t=>{console.error(t),r.removeChild(o),r.textContent="End Session",e=!1}):(r.removeChild(o),r.textContent="End Session",e=!1),this.taskSection&&this.container.removeChild(this.taskSection),this.descriptionSection&&this.container.removeChild(this.descriptionSection),this.stopButton&&this.stopButtonContainer&&this.container.removeChild(this.stopButtonContainer),r.onclick=()=>{e||(window.close(),document.body.removeChild(this.bg))},t.append(n,s,r),this.endSection=t,this.container.append(t)}}function E_(e){return!!e&&null!=e.nodeType}function I_(e){return"http://www.w3.org/2000/svg"===e.namespaceURI||"svg"===e.localName}function C_(e){return e.nodeType===Node.ELEMENT_NODE}function M_(e){return e.nodeType===Node.TEXT_NODE}function R_(e){return e.nodeType===Node.DOCUMENT_NODE}function O_(e){return e.nodeType===Node.DOCUMENT_NODE||e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function A_(e,t){return e.localName===t}class N_{constructor(e,t){this.app=e,this.options=t,this.snapshots={},this.intervals=[],this.restartTracking=()=>{this.clear(),this.app.nodes.scanTree(this.captureCanvas)},this.captureCanvas=e=>{const t=this.app.nodes.getID(e);t&&A_(e,"canvas")&&(this.app.sanitizer.isObscured(t)||this.app.sanitizer.isHidden(t)||!A_(e,"canvas")||this.snapshots[t]||new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target?this.snapshots[t]&&this.snapshots[t].createdAt?this.snapshots[t].paused=!1:this.recordCanvas(e.target,t):this.snapshots[t]&&(this.snapshots[t].paused=!0))})}).observe(e))},this.recordCanvas=(e,t)=>{const n=this.app.timestamp();this.snapshots[t]={images:[],createdAt:n,paused:!1,dummy:document.createElement("canvas")};const s=[119,t.toString(),n];this.app.send(s);const r=e=>{!function(e,t="medium",n,s=!1,r,o){const i=`image/${r}`;if(s){const s=window.devicePixelRatio||1;n.width=e.width/s,n.height=e.height/s;const r=n.getContext("2d");if(!r)return"";r.clearRect(0,0,n.width,n.height),r.drawImage(e,0,0,n.width,n.height),n.toBlob(o,i,D_[t])}else e.toBlob(o,i,D_[t])}(e,this.options.quality,this.snapshots[t].dummy,this.options.fixedScaling,this.fileExt,e=>{if(e){if(!this.snapshots[t])return this.app.debug.warn("Canvas not present in snapshots after capture:",this.snapshots,t);this.snapshots[t].images.push({id:this.app.timestamp(),data:e}),this.snapshots[t].images.length>9&&(this.sendSnaps(this.snapshots[t].images,t,this.snapshots[t].createdAt),this.snapshots[t].images=[])}})},o=setInterval(()=>{const n=this.app.nodes.getID(e),s=n?this.app.nodes.getNode(n):void 0;return this.snapshots[t]?s&&A_(s,"canvas")&&s===e?void(this.snapshots[t].paused||(this.options.useAnimationFrame?requestAnimationFrame(()=>{r(s)}):r(s))):(this.app.debug.log("Canvas element not in sync",s,e),void clearInterval(o)):(this.app.debug.log("Canvas is not present in {snapshots}"),void clearInterval(o))},this.interval);this.intervals.push(o)},this.fileExt=t.fileExt??"webp",this.interval=1e3/t.fps}startTracking(){setTimeout(()=>{this.app.nodes.scanTree(this.captureCanvas),this.app.nodes.attachNodeCallback(this.captureCanvas)},250)}sendSnaps(e,t,n){if(0===Object.keys(this.snapshots).length)return;const s=new FormData;e.forEach(e=>{const r=e.data;r&&(s.append("snapshot",r,`${n}_${t}_${e.id}.${this.fileExt}`),this.options.isDebug&&function(e,t){const n=URL.createObjectURL(e),s=document.createElement("a");s.href=n,s.download=t,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}(r,`${n}_${t}_${e.id}.${this.fileExt}`))});const r=()=>{this.app.debug.log("Restarting tracker; token expired"),this.app.stop(!1),setTimeout(()=>{this.app.start({},!0)},250)};fetch(this.app.options.ingestPoint+"/v1/web/images",{method:"POST",headers:{Authorization:`Bearer ${this.app.session.getSessionToken()??""}`},body:s}).then(e=>401!==e.status||r()).catch(e=>{this.app.debug.error("error saving canvas",e)})}clear(){this.intervals.forEach(e=>clearInterval(e)),this.snapshots={}}}const D_={low:.35,medium:.55,high:.8};class L_{constructor(e=0){this.shouldLog=e=>this.level>=e,this.info=(...e)=>{this.shouldLog(5)&&console.info(...e)},this.log=(...e)=>{this.shouldLog(4)&&console.log(...e)},this.warn=(...e)=>{this.shouldLog(3)&&console.warn(...e)},this.error=(...e)=>{this.shouldLog(2)&&console.error(...e)},this.level=e}}const P_={interval:3e4,batchSize:2500,enabled:!0};class F_{constructor(e,t,n){this.nodes=e,this.unregisterNode=t,this.start=()=>{this.options.enabled&&(this.stop(),this.interval=setInterval(()=>{!function(e,t,n){const s=e.entries();!function e(){const r=[];let o=s.next();for(;!o.done&&r.length<t;)r.push(o.value),o=s.next();r.length>0&&(r.forEach(([e,t])=>{t&&n(t)}),setTimeout(e,50))}()}(this.nodes,this.options.batchSize,e=>{const t=function(e){try{if(!e.isConnected)return[!1,"not connected"];const t=e.nodeType===Node.DOCUMENT_NODE,n=t?e.defaultView:e.ownerDocument?.defaultView,s=t?e:e.ownerDocument;return n?n.closed?[!1,"window closed"]:s?.documentElement.isConnected?[!0,"ok"]:[!1,"documentElement not connected"]:[!1,"no window"]}catch(e){return[!1,e]}}(e)[0];t||this.unregisterNode(e)})},this.options.interval))},this.stop=()=>{this.interval&&clearInterval(this.interval)},this.options={...P_,...n}}}class $_{constructor(e){this.nodes=new Map,this.totalNodeAmount=0,this.nodeCallbacks=[],this.elementListeners=new Map,this.nextNodeId=0,this.attachNodeCallback=e=>this.nodeCallbacks.push(e),this.scanTree=e=>{this.nodes.forEach(t=>t?e(t):void 0)},this.attachNodeListener=(e,t,n,s=!0)=>{const r=this.getID(e);if(void 0===r)return;gv(e,t,n,s,this.forceNgOff);let o=this.elementListeners.get(r);void 0===o&&(o=[],this.elementListeners.set(r,o)),o.push([t,n,s])},this.createFrameId=(e,t)=>function(e,t){if(e<0||e>3)throw new RangeError("OR: nesting level overflow, max 4");if(t<0||t>127)throw new RangeError("OR: frame order overflow, max 128");return((3&e)<<29|(127&t)<<22)>>>0}(e,t),this.unregisterNode=e=>{const t=e[this.node_id];if(void 0!==t){e[this.node_id]=void 0,delete e[this.node_id],this.nodes.delete(t);const n=this.elementListeners.get(t);void 0!==n&&(this.elementListeners.delete(t),n.forEach(t=>yv(e,t[0],t[1],t[2],this.forceNgOff))),this.totalNodeAmount--}return t},this.node_id=e.node_id,this.forceNgOff=e.forceNgOff,this.maintainer=new F_(this.nodes,this.unregisterNode,e.maintainer),this.maintainer.start()}crossdomainMode(e,t){this.nextNodeId=this.createFrameId(e,t)}registerNode(e){let t=e[this.node_id];const n=void 0===t;return n&&(t=this.nextNodeId,this.totalNodeAmount++,this.nextNodeId++,this.nodes.set(t,e),e[this.node_id]=t),[t,n]}cleanTree(){for(const[e,t]of this.nodes)t&&!document.contains(t)&&this.unregisterNode(t)}callNodeCallbacks(e,t){this.nodeCallbacks.forEach(n=>n(e,t))}getID(e){if(e)return e[this.node_id]}getNode(e){return this.nodes.get(e)}getNodeCount(){return this.totalNodeAmount}clear(){for(const[e,t]of this.nodes)t&&this.unregisterNode(t);this.nextNodeId=0,this.nodes.clear()}}let j_=99e6;function B_(e){return O_(e)&&!!e.adoptedStyleSheets}let U_=15;function H_(){return U_++}const z_=new Map,q_={},W_={};function V_(e){if(function(e){return e.nodeType===Node.COMMENT_NODE}(e))return!0;if(M_(e))return!1;if(!C_(e))return!0;const t=e.tagName.toUpperCase();if("LINK"===t){const t=e.getAttribute("rel"),n=e.getAttribute("as");return!(t?.includes("stylesheet")||"style"===n||"font"===n)}return"SCRIPT"===t||"NOSCRIPT"===t||"META"===t||"TITLE"===t||"BASE"===t}function J_(e){return!!O_(e)||!V_(e)}var K_,G_;!function(e){e[e.New=0]="New",e[e.Removed=1]="Removed",e[e.Changed=2]="Changed"}(K_||(K_={}));class X_{constructor(e,t=!1,n={}){this.app=e,this.isTopContext=t,this.commited=[],this.recents=new Map,this.indexes=[],this.attributesMap=new Map,this.textSet=new Set,this.disableSprites=!1,this.inlineRemoteCss=!1,this.inlinerOptions=void 0,this.domParser=new DOMParser,this.disableSprites=Boolean(n.disableSprites),this.inlineRemoteCss=Boolean(n.inlineRemoteCss),this.inlinerOptions=n.inlinerOptions,this.observer=mv(this.app.safe(e=>{for(const t of e){const e=t.target,n=t.type;if(!J_(e))continue;if("childList"===n){for(let e=0;e<t.removedNodes.length;e++)J_(t.removedNodes[e])&&this.bindNode(t.removedNodes[e]);for(let e=0;e<t.addedNodes.length;e++)this.bindTree(t.addedNodes[e]);continue}const s=this.app.nodes.getID(e);if(void 0!==s){if(this.recents.has(s)||this.recents.set(s,K_.Changed),"attributes"===n){const e=t.attributeName;if(null===e)continue;let n=this.attributesMap.get(s);void 0===n&&this.attributesMap.set(s,n=new Set),n.add(e);continue}"characterData"!==n||this.textSet.add(s)}}this.commitNodes()}),this.app.options.forceNgOff)}clear(){this.commited.length=0,this.recents.clear(),this.indexes.length=1,this.attributesMap.clear(),this.textSet.clear()}handleIframeSrcChange(e){const t=e.contentDocument;if(t&&void 0!==this.app.nodes.getID(t)){const n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,{acceptNode:e=>V_(e)||void 0===this.app.nodes.getID(e)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},!1);let s=0;const r=this.app.nodes.getNodeCount(),o=e.contentDocument,i=this.app.nodes.unregisterNode.bind(this.app.nodes);for(;n.nextNode();)o.contains(n.currentNode)||(s+=1,i(n.currentNode));const a=Math.floor(s/r*100);a>30&&this.app.send(jv(a))}}sendNodeAttribute(e,t,n,s){if(I_(t))return n.startsWith("xlink:")&&(n=n.substring(6)),null===s&&this.app.send(xv(e,n)),function(e){return"use"===e.localName}(t)&&"href"===n&&!this.disableSprites?void async function(e,t,n){try{const t=e.getAttribute("xlink:href")||e.getAttribute("href");if(!t)return void console.debug("Openreplay: xlink:href or href not found on <use>.");let s,[r,o]=t.split("#");if(!r&&o){let e;e=t.startsWith("#")?`#${CSS.escape(t.substring(1))}`:CSS.escape(t);const n=document.querySelector(e);if(n){const e=`\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="${n.getAttribute("viewBox")||"0 0 24 24"}">\n          ${n.innerHTML}\n        </svg>\n      `;return q_[o]=e,e}return void console.warn("Openreplay: Sprite symbol not found in the document.")}if(!r&&!o)return void console.warn("Openreplay: Invalid xlink:href or href found on <use>.");if(q_[o])return q_[o];if(W_[r])1===W_[r]?await new Promise(e=>{let t=0;const n=setInterval(()=>{t>100&&(clearInterval(n),e(!1)),1!==W_[r]?(s=W_[r],clearInterval(n),e(!0)):t++},100)}):s=W_[r]??'<svg xmlns="http://www.w3.org/2000/svg"></svg>';else{W_[r]=1;const e=await fetch(r),t=await e.text();s=n.parseFromString(t,"image/svg+xml"),W_[r]=s}const i=s.getElementById(o);if(!i)return console.debug("Openreplay: Symbol not found in SVG."),"";{const e=`\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="${i.getAttribute("viewBox")||"0 0 24 24"}">\n          ${i.innerHTML}\n        </svg>\n      `;return q_[o]=e,e}}catch(e){console.error("Openreplay: Error processing <use> element:",e)}}(t,0,this.domParser).then(t=>{t&&this.app.send(function(e,t,n){return[12,e,t,n]}(e,n,`_$OPENREPLAY_SPRITE$_${t}`))}).catch(e=>{console.error("Openreplay: Error parsing <use> element:",e)}):void("href"===n?(s.length>1e5&&(s=""),this.app.send(Cv(e,n,s,this.app.getBaseHref()))):this.app.attributeSender.sendSetAttribute(e,n,s));if("src"!==n&&"srcset"!==n&&"integrity"!==n&&"crossorigin"!==n&&"autocomplete"!==n&&"on"!==n.substring(0,2)&&("value"!==n||!A_(t,"input")||"button"===t.type||"reset"===t.type||"submit"===t.type))if(null!==s){if("style"===n||"href"===n&&A_(t,"link"))return"rel"in t&&"stylesheet"===t.rel&&this.inlineRemoteCss?void setTimeout(()=>{!function(e,t,n,s,r,o,i,a,c){const u=a?null:s();a||o(u,t);const l=e.sheet;if(l&&!i)try{const e=function e(t){try{const n=t.rules||t.cssRules;if(!n)return null;let s=t.href;!s&&t.ownerNode&&t.ownerNode.ownerDocument&&(s=t.ownerNode.ownerDocument.location.href);const r=Array.from(n,t=>function(t,n){if(function(e){return"styleSheet"in e}(t)){let n;try{n=e(t.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(t)}catch(e){n=t.cssText}return t.styleSheet.href?p(n,t.styleSheet.href):n}{let e=t.cssText;return function(e){return"selectorText"in e}(t)&&t.selectorText.includes(":")&&(e=function(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}(e)),n?p(e,n):e}}(t,s)).join("");return function(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),e}(r)}catch(e){return null}}(l);if(e)return void d(e)}catch(e){}function d(e){const t=function(e){const t=[];let n=!1,s=!1,r="",o=0,i="";for(let a=0;a<e.length;a++){const c=e[a],u=e[a+1]||"";s||"/"!==c||"*"!==u?n?"*"===c&&"/"===u&&(n=!1,a++):s||'"'!==c&&"'"!==c?s?(i+=c,c===r&&"\\"!==e[a-1]&&(s=!1)):(i+=c,"{"===c?o++:"}"===c&&(o--,0===o&&(t.push(i.trim()),i=""))):(s=!0,r=c,i+=c):(n=!0,a++)}return i.trim()&&t.push(i.trim()),t}(e=e.replace(/\/\*[\s\S]*?\*\//g,""));for(let e=0;e<t.length;e++)r(u,t[e],e,n)}function p(e,t){if(!e)return"";const n=/^(?:[a-z+]+:)?\/\//i,s=/^www\..*/i,r=/^(data:)([^,]*),(.*)/i;return e.replace(/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,(e,o,i,a,c,u)=>{const l=i||c||u,d=o||a||"";if(!l)return e;if(n.test(l)||s.test(l))return`url(${d}${l}${d})`;if(r.test(l))return`url(${d}${l}${d})`;if("/"===l[0])return`url(${d}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+l}${d})`;const p=t.split("/"),h=l.split("/");p.pop();for(const e of h)"."!==e&&(".."===e?p.pop():p.push(e));return`url(${d}${p.join("/")}${d})`})}e.href&&fetch(e.href).then(e=>{if(!e.ok)throw new Error(`response status ${e.status}`);return e.text()}).then(e=>{a&&c?c(e,j_++):d(e)}).catch(t=>{console.error(`OpenReplay: Failed to fetch CSS from ${e.href}:`,t)})}(t,e,this.app.getBaseHref(),H_,(e,t,n,s)=>{this.app.send(Av(e,t,n,s))},(e,t)=>{this.app.send(Dv(e,t))},this.inlinerOptions?.forceFetch,this.inlinerOptions?.forcePlain,(t,n)=>{this.app.send(kv(n,e,0)),setTimeout(()=>{this.app.send(Mv(n,t,this.app.getBaseHref()))},10)})},0):void this.app.send(Cv(e,n,s,this.app.getBaseHref()));("href"===n||s.length>1e5)&&(s=""),["alt","placeholder"].includes(n)&&this.app.sanitizer.privateMode&&(s=s.replaceAll(/./g,"*")),this.app.attributeSender.sendSetAttribute(e,n,s)}else this.app.send(xv(e,n))}sendNodeData(e,t,n){A_(t,"style")?this.app.send(Mv(e,n,this.app.getBaseHref())):(n=this.app.sanitizer.sanitize(e,n),this.app.send(function(e,t){return[14,e,t]}(e,n)))}bindNode(e){const[t,n]=this.app.nodes.registerNode(e);n?this.recents.set(t,K_.New):this.recents.get(t)!==K_.New&&this.recents.set(t,K_.Removed)}bindTree(e){if(!J_(e))return;this.bindNode(e);const t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,{acceptNode:e=>(void 0!==this.app.nodes.getID(e)&&this.app.debug.info("! Node is already bound",e),V_(e)||void 0!==this.app.nodes.getID(e)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT)},!1);for(;t.nextNode();)this.bindNode(t.currentNode)}unbindTree(e){const t=this.app.nodes.unregisterNode(e);if(void 0!==t&&this.recents.get(t)===K_.Removed){this.app.send(function(e){return[11,e]}(t));const n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,{acceptNode:e=>V_(e)||void 0===this.app.nodes.getID(e)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},!1);let s=0;const r=this.app.nodes.getNodeCount();for(;n.nextNode();)s+=1,this.app.nodes.unregisterNode(n.currentNode);const o=Math.floor(s/r*100);o>30&&this.app.send(jv(o))}}_commitNode(e,t){if(O_(t))return!0;const n=t.assignedSlot?t.assignedSlot:t.parentNode;let s;if(!A_(t,"html")||!this.isTopContext){if(null===n)return this.unbindTree(t),!1;if(s=this.app.nodes.getID(n),void 0===s)return this.unbindTree(t),!1;if(!this.commitNode(s))return this.unbindTree(t),!1;if(this.app.sanitizer.handleNode(e,s,t),this.app.sanitizer.isHidden(s))return!1}let r=t.previousSibling;for(;null!==r;){const t=this.app.nodes.getID(r);if(void 0!==t){this.commitNode(t),this.indexes[e]=this.indexes[t]+1;break}r=r.previousSibling}null===r&&(this.indexes[e]=0);const o=this.recents.get(e),i=o===K_.New,a=this.indexes[e];if(void 0===a)throw"commitNode: missing node index";if(i){if(C_(t)){let n=t;if(void 0!==s){if(this.app.sanitizer.isHidden(e)){const e=n.clientWidth,s=n.clientHeight;n=t.cloneNode(),n.style.width=`${e}px`,n.style.height=`${s}px`}"rel"in n&&"stylesheet"===n.rel&&this.inlineRemoteCss?this.app.send(wv(e,s,a,"STYLE",!1)):this.app.send(wv(e,s,a,n.tagName,I_(t)))}for(let t=0;t<n.attributes.length;t++){const s=n.attributes[t];this.sendNodeAttribute(e,n,s.nodeName,s.value)}}else M_(t)&&(this.app.send(kv(e,s,a)),this.sendNodeData(e,n,t.data));return!0}o===K_.Removed&&void 0!==s&&this.app.send(function(e,t,n){return[10,e,t,n]}(e,s,a));const c=this.attributesMap.get(e);if(void 0!==c){if(!C_(t))throw"commitNode: node is not an element";for(const n of c)this.sendNodeAttribute(e,t,n,t.getAttribute(n))}if(this.textSet.has(e)){if(!M_(t))throw"commitNode: node is not a text";this.sendNodeData(e,n,t.data)}return!0}commitNode(e){const t=this.app.nodes.getNode(e);if(!t)return!1;const n=this.commited[e];return void 0!==n?n:this.commited[e]=this._commitNode(e,t)}commitNodes(e=!1){let t;for(const[n,s]of this.recents.entries())this.commitNode(n),s===K_.New&&(t=this.app.nodes.getNode(n))&&this.app.nodes.callNodeCallbacks(t,e);this.clear()}observeRoot(e,t,n=e){this.observer.observe(e,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1}),this.bindTree(n),t(this.app.nodes.getID(e)),this.commitNodes(!0)}disconnect(){this.observer.disconnect(),this.clear()}}class Y_ extends X_{observe(e){const t=e.contentDocument,n=this.app.nodes.getID(e);t&&void 0!==n&&this.observeRoot(t,e=>{void 0!==e?(this.docId=e,this.app.send(Rv(n,e))):this.app.debug.log("OpenReplay: Iframe document not bound")})}syntheticObserve(e,t){this.observeRoot(t,t=>{void 0!==t?this.app.send(Rv(e,t)):this.app.debug.log("OpenReplay: Iframe document not bound")})}}class Q_ extends X_{observe(e){const t=e.shadowRoot,n=this.app.nodes.getID(e);t&&void 0!==n&&this.observeRoot(t,e=>{void 0!==e?this.app.send(Rv(n,e)):this.app.debug.error("OpenReplay: Shadow Root was not bound")})}}class Z_{constructor(){this.states=new WeakMap}calcOffset(e){let t=0,n=0;if(e.parent&&([t,n]=this.calcOffset(e.parent)),!e.offset){const{left:t,top:n}=e.iFrame.getBoundingClientRect();e.offset=[t,n]}const[s,r]=e.offset;return[t+s,n+r]}getDocumentOffset(e){const t=this.states.get(e);return t?this.calcOffset(t):[0,0]}observe(e){const t=e.contentDocument;if(!t)return;const n=e.ownerDocument,s={offset:null,iFrame:e,parent:this.states.get(n)||null,clear:()=>{n.removeEventListener("scroll",r),n.defaultView?.removeEventListener("resize",r)}},r=()=>{s.offset=null};n.addEventListener("scroll",r),n.defaultView?.addEventListener("resize",r),this.states.set(t,s)}clear(){this.states=new WeakMap}}function eS(e){switch(e){case G_.Inline:return{inlineRemoteCss:!0,inlinerOptions:{forceFetch:!1,forcePlain:!1}};case G_.InlineFetched:return{inlineRemoteCss:!0,inlinerOptions:{forceFetch:!0,forcePlain:!1}};case G_.PlainFetched:return{inlineRemoteCss:!0,inlinerOptions:{forceFetch:!0,forcePlain:!0}};case G_.Disabled:default:return{inlineRemoteCss:!1,inlinerOptions:{forceFetch:!1,forcePlain:!1}}}}!function(e){e[e.Disabled=0]="Disabled",e[e.Inline=1]="Inline",e[e.InlineFetched=2]="InlineFetched",e[e.PlainFetched=3]="PlainFetched"}(G_||(G_={}));const tS=Yb?Element.prototype.attachShadow:()=>new ShadowRoot;class nS extends X_{constructor(e){const t=Object.assign({captureIFrames:!0,disableSprites:!1,inlineCss:0},e.options),n={disableSprites:t.disableSprites,...eS(t.inlineCss)};super(e.app,!0,n),this.iframeOffsets=new Z_,this.contextCallbacks=[],this.contextsSet=new WeakSet,this.iframeObserversArr=[],this.iframeObservers=new WeakMap,this.docObservers=new WeakMap,this.shadowRootObservers=new WeakMap,this.app=e.app,this.options=t,this.app.nodes.attachNodeCallback(e=>{A_(e,"iframe")&&(this.options.captureIFrames&&!lv(e,"obscured")||lv(e,"capture"))&&this.handleIframe(e)}),this.app.nodes.attachNodeCallback(e=>{C_(e)&&null!==e.shadowRoot&&this.handleShadowRoot(e.shadowRoot)})}attachContextCallback(e){this.contextCallbacks.push(e)}getDocumentOffset(e){return this.iframeOffsets.getDocumentOffset(e)}handleIframe(e){const t=this.app.safe(()=>setTimeout(()=>{const t=this.app.nodes.getID(e);if(void 0===t||!function(e){try{return Boolean(e.contentDocument)}catch(e){return!1}}(e))return;const n=e.contentWindow,s=e.contentDocument;if(!s)return void this.app.debug.warn("no doc for iframe found",e);if(s&&this.docObservers.has(s))return void this.app.debug.info("doc already observed for",t);const r=new Y_(this.app,!1,{});this.iframeObservers.set(e,r),this.docObservers.set(s,r),this.iframeObserversArr.push(r),r.observe(e),this.iframeOffsets.observe(e),n&&n===n.window&&!this.contextsSet.has(n)&&(this.contextsSet.add(n),this.contextCallbacks.forEach(e=>e(n)))},250));e.addEventListener("load",t),t()}handleShadowRoot(e){const t=new Q_(this.app);this.shadowRootObservers.set(e,t),t.observe(e.host)}observe(){const e=this;Element.prototype.attachShadow=function(){const t=tS.apply(this,arguments);return e.handleShadowRoot(t),t},this.app.nodes.clear(),this.observeRoot(window.document,()=>{this.app.send([7]),this.app.nodes.callNodeCallbacks(document,!0)},window.document.documentElement)}crossdomainObserve(e,t,n){const s=this;Element.prototype.attachShadow=function(){const e=tS.apply(this,arguments);return s.handleShadowRoot(e),e},this.app.nodes.clear(),this.app.nodes.crossdomainMode(n,t);const r=new Y_(this.app);this.iframeObservers.set(window.document,r),r.syntheticObserve(e,window.document)}disconnect(){this.iframeOffsets.clear(),Element.prototype.attachShadow=tS,this.iframeObserversArr.forEach(e=>e.disconnect()),this.iframeObserversArr=[],this.iframeObservers=new WeakMap,this.shadowRootObservers=new WeakMap,this.docObservers=new WeakMap,super.disconnect()}}var sS;!function(e){e[e.Plain=0]="Plain",e[e.Obscured=1]="Obscured",e[e.Hidden=2]="Hidden"}(sS||(sS={}));const rS=e=>e.trim().replace(/[^\f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff\s]/g,"*");class oS{constructor(e){this.obscured=new Set,this.hidden=new Set,this.app=e.app;this.privateMode=e.options?.privateMode??!1,this.options=Object.assign({obscureTextEmails:!0,obscureTextNumbers:!1,privateMode:!1,domSanitizer:void 0},e.options)}handleNode(e,t,n){if(this.options.privateMode){if(C_(n)&&!lv(n,"unmask"))return this.obscured.add(e);if(M_(n)&&!lv(n.parentNode,"unmask"))return this.obscured.add(e)}if((this.obscured.has(t)||C_(n)&&(lv(n,"masked")||lv(n,"obscured")))&&this.obscured.add(e),(this.hidden.has(t)||C_(n)&&(lv(n,"htmlmasked")||lv(n,"hidden")))&&this.hidden.add(e),void 0!==this.options.domSanitizer&&C_(n)){const t=this.options.domSanitizer(n);t===sS.Obscured&&this.obscured.add(e),t===sS.Hidden&&this.hidden.add(e)}}sanitize(e,t){return this.obscured.has(e)?rS(t):(this.options.obscureTextNumbers&&(t=t.replace(/\d/g,"0")),this.options.obscureTextEmails&&(t=t.replace(/^\w+([+.-]\w+)*@\w+([.-]\w+)*\.\w{2,3}$/g,e=>{const[t,n]=e.split("@"),[s,r]=n.split(".");return`${sv(t)}@${sv(s)}.${sv(r)}`})),t)}isObscured(e){return this.obscured.has(e)}isHidden(e){return this.hidden.has(e)}getInnerTextSecure(e){const t=this.app.nodes.getID(e);return t?this.sanitize(t,e.innerText):""}clear(){this.obscured.clear(),this.hidden.clear()}}class iS{constructor(e){this.metadata={},this.userID=null,this.callbacks=[],this.timestamp=0,this.getPageNumber=()=>{const e=this.app.sessionStorage.getItem(this.options.session_pageno_key);if(null!=e)return parseInt(e)},this.incPageNo=()=>{let e=this.getPageNumber();return void 0===e?e=0:e++,this.app.sessionStorage.setItem(this.options.session_pageno_key,e.toString()),e},this.getSessionToken=e=>{const t=this.token||this.app.sessionStorage.getItem(this.options.session_token_key);if(e&&t){const n=t.split("_&_")[1];if(!n||n!==e)return this.app.sessionStorage.removeItem(this.options.session_token_key),void(this.token=void 0)}return(t?t.split("_&_")[0]:null)||void 0},this.setSessionToken=(e,t)=>{this.token=`${e}_&_${t}`,this.app.sessionStorage.setItem(this.options.session_token_key,`${e}_&_${t}`)},this.app=e.app,this.options=e.options,this.createTabId()}attachUpdateCallback(e){this.callbacks.push(e)}handleUpdate(e){null==e.userID&&delete e.userID,null==e.sessionID&&delete e.sessionID,this.callbacks.forEach(t=>t(e))}assign(e){void 0!==e.userID&&(this.userID=e.userID),void 0!==e.metadata&&Object.entries(e.metadata).forEach(([e,t])=>this.metadata[e]=t),void 0!==e.sessionID&&(this.sessionID=e.sessionID),void 0!==e.timestamp&&(this.timestamp=e.timestamp),void 0!==e.projectID&&(this.projectID=e.projectID),this.handleUpdate(e)}setMetadata(e,t){this.metadata[e]=t,this.handleUpdate({metadata:{[e]:t}})}setUserID(e){this.userID=e,this.handleUpdate({userID:e})}setUserInfo(e){this.userInfo=e}applySessionHash(e){const t=decodeURI(e).split("&");let n=e,s="100500";2==t.length&&([s,n]=t),s&&n&&(this.app.sessionStorage.setItem(this.options.session_token_key,n),this.app.sessionStorage.setItem(this.options.session_pageno_key,s))}getSessionHash(){const e=this.getPageNumber(),t=this.getSessionToken();if(void 0!==e&&void 0!==t)return encodeURI(String(e)+"&"+t)}getTabId(){return this.tabId||this.createTabId(),this.tabId}regenerateTabId(){const e=function(){const e=new Uint8Array(6),t=window.crypto||window.msCrypto;return t?(t.getRandomValues(e),Array.from(e,pv).join("")):Array.from({length:12},()=>pv(Math.floor(16*Math.random()))).join("")}();this.app.sessionStorage.setItem(this.options.session_tabid_key,e),this.tabId=e}createTabId(){const e=this.app.sessionStorage.getItem(this.options.session_tabid_key);e?this.tabId=e:this.regenerateTabId()}getInfo(){return{sessionID:this.sessionID,metadata:this.metadata,userID:this.userID,timestamp:this.timestamp,projectID:this.projectID}}reset(){this.app.sessionStorage.removeItem(this.options.session_token_key),this.metadata={},this.userID=null,this.sessionID=void 0,this.timestamp=0}}class aS{constructor(e){this.app=e,this.timer=null,this.callbacks=[]}attach(e,t=0,n=!0,s){s&&(e=e.bind(s)),n&&(e=this.app.safe(e)),this.callbacks.unshift(t?function(e,t){let n=0;return()=>{n++>=t&&(n=0,e())}}(e,t):e)}start(){null===this.timer&&(this.timer=setInterval(()=>this.callbacks.forEach(e=>{e&&e()}),30))}stop(){null!==this.timer&&(clearInterval(this.timer),this.timer=null)}}const cS="canceled",uS="or_uxt_active",lS="or_buffer_1",dS=e=>({reason:e,success:!1}),pS=e=>({...e,success:!0});var hS;function fS(){const e=-1*(new Date).getTimezoneOffset(),t=e>=0?"+":"-",n=Math.floor(Math.abs(e)/60),s=Math.abs(e)%60;return`UTC${t}${String(n).padStart(2,"0")}:${String(s).padStart(2,"0")}`}!function(e){e[e.NotActive=0]="NotActive",e[e.Starting=1]="Starting",e[e.Active=2]="Active",e[e.ColdStart=3]="ColdStart"}(hS||(hS={}));const mS=e=>new Promise(t=>setTimeout(t,e)),gS="never-gonna-give-you-up",yS="never-gonna-let-you-down",bS="never-gonna-run-around-and-desert-you",vS="tracker inside a child iframe",_S="getting node id for child iframe",SS="batch of messages from an iframe window",wS="signal that parent is live",kS="stop tracker inside frame",xS="start tracker inside frame",TS="hello-how-are-you-im-under-the-water-please-help-me";class ES{constructor(e,t,n,s,r){this.signalError=s,this.insideIframe=r,this.messages=[],this.bufferedMessages1=[],this.bufferedMessages2=[],this.startCallbacks=[],this.stopCallbacks=[],this.commitCallbacks=[],this.activityState=hS.NotActive,this.version="16.4.10",this.socketMode=!1,this.compressionThreshold=24e3,this.bc=null,this.canvasRecorder=null,this.conditionsManager=null,this.canStart=!1,this.rootId=null,this.pageFrames=[],this.frameOderNumber=0,this.frameLevel=0,this.features={},this.emptyBatchCounter=0,this.parentActive=!1,this.checkStatus=()=>this.parentActive,this.parentCrossDomainFrameListener=e=>{const{data:t}=e;if(t&&e.source!==window){if(t.line===xS){if(this.active())return;try{this.allowAppStart(),this.start()}catch(e){console.error("children frame restart failed:",e)}}t.line===wS&&(this.parentActive=!0),t.line===_S&&(this.parentActive=!0,this.rootId=t.id,this.session.setSessionToken(t.token,this.projectKey),this.frameOderNumber=t.frameOrderNumber,this.frameLevel=t.frameLevel,this.debug.log("starting iframe tracking",t),this.allowAppStart()),t.line===kS&&this.active()&&this.stop()}},this.trackedFrames=[],this.crossDomainIframeListener=e=>{if(!this.active()||e.source===window)return;const{data:t}=e;if(t){if(t.line===vS){e.source?.postMessage({ping:!0,line:wS},"*");const n=async()=>{if(null===e.source)return console.error("Couldnt connect to event.source for child iframe tracking");const n=await this.checkNodeId(e.source);if(n)try{this.trackedFrames.includes(t.context)?this.debug.log("Trying to observe already added iframe; ignore if its a restart"):this.trackedFrames.push(t.context),await this.waitStarted();const s=this.session.getSessionToken(this.projectKey),r=this.trackedFrames.findIndex(e=>e===t.context)+1;0===r&&this.debug.error("Couldnt get order number for iframe",t.context,this.trackedFrames);const o={line:_S,id:n,token:s,frameOrderNumber:r,frameLevel:this.frameLevel+1};this.debug.log("Got child frame signal; nodeId",n,e.source,o),e.source?.postMessage(o,"*")}catch(e){console.error(e)}else this.debug.log("Couldnt get node id for iframe",e.source)};n(),this.active()?e.source?.postMessage({line:xS},"*"):this.addCommand(xS)}if(t.line===SS){const n=t.messages.map(t=>{if(20===t[0]){let n=t;return this.pageFrames.forEach(s=>{if(s.contentWindow===e.source){const[e,r,o]=t,{left:i,top:a}=s.getBoundingClientRect();n=[e,r+i,o+a]}}),n}if(68===t[0]){let n=t;return this.pageFrames.forEach(s=>{if(s.contentWindow===e.source){const[e,r,o,i,a,c,u]=t,{left:l,top:d,width:p,height:h}=s.getBoundingClientRect(),f=(c/100*p+l)/document.documentElement.scrollWidth,m=(u/100*h+d)/document.documentElement.scrollHeight;n=[e,r,o,i,a,Math.round(1e3*f)/10,Math.round(1e3*m)/10]}}),n}return t});this.messages.push(...n)}if(t.line===TS){if(!this.pollingQueue.order.length)return;const n=this.pollingQueue.order[0];if(n&&0===this.pollingQueue[n].length)return void(this.pollingQueue.order=this.pollingQueue.order.filter(e=>e!==n));this.pollingQueue[n].includes(t.context)&&(this.pollingQueue[n]=this.pollingQueue[n].filter(e=>e!==t.context),e.source?.postMessage({line:n},"*"),0===this.pollingQueue[n].length&&this.pollingQueue.order.shift())}}},this.pollingQueue={order:[]},this.addCommand=e=>{this.pollingQueue.order.push(e),this.pollingQueue[e]=[...this.trackedFrames]},this.bootChildrenFrames=async()=>{await this.waitStarted(),this.addCommand(xS)},this.killChildrenFrames=()=>{this.addCommand(kS)},this.signalIframeTracker=()=>{const e=this.session.getTabId();window.parent.postMessage({line:vS,source:e,context:this.contextId},this.options.crossdomain?.parentDomain??"*");let t=0,n=250,s=0,r=!1;const o=()=>{r||this.checkStatus()?r=!0:(window.parent.postMessage({line:vS,source:e,context:this.contextId},this.options.crossdomain?.parentDomain??"*"),this.debug.info("Trying to signal to parent, attempt:",t+1),t++)};for(let e=0;e<10;e++){if(this.checkStatus()){r=!0;break}s+=n,setTimeout(()=>{o()},s),n*=1.5}},this.startTimeout=null,this.send=(e,t=!1)=>{this.activityState!==hS.NotActive&&(this.activityState===hS.ColdStart?(this.bufferedMessages1.push(e),this.singleBuffer||this.bufferedMessages2.push(e),this.conditionsManager?.processMessage(e)):this.messages.push(e),this.activityState===hS.Active&&t&&this.commit())},this.coldStartCommitN=0,this.delay=0,this.attachStartCallback=(e,t=!1)=>{t&&(e=this.safe(e)),this.startCallbacks.push(e)},this.attachStopCallback=(e,t=!1)=>{t&&(e=this.safe(e)),this.stopCallbacks.push(e)},this.attachEventListener=(e,t,n,s=!0,r=!0)=>{s&&(n=this.safe(n)),this.attachStartCallback(()=>e?gv(e,t,n,r,this.options.forceNgOff):null,s),this.attachStopCallback(()=>e?yv(e,t,n,r,this.options.forceNgOff):null,s)},this.coldInterval=null,this.orderNumber=0,this.coldStartTs=0,this.singleBuffer=!1,this.coldStart=async(e={},t)=>{this.singleBuffer=!1;const n=this.checkSessionToken(e.forceNew);t&&await this.setupConditionalStart(e);const s=()=>{this.orderNumber+=1,ev(),this.coldStartTs=nv(),this.orderNumber%2==0?(this.bufferedMessages1.length=0,this.bufferedMessages1.push(Sv(this.timestamp())),this.bufferedMessages1.push(Hv(this.session.getTabId()))):(this.bufferedMessages2.length=0,this.bufferedMessages2.push(Sv(this.timestamp())),this.bufferedMessages2.push(Hv(this.session.getTabId()))),this.stop(!1),this.activityState=hS.ColdStart,e.sessionHash&&this.session.applySessionHash(e.sessionHash),e.forceNew&&this.session.reset(),this.session.assign({userID:e.userID,metadata:e.metadata}),n||(this.debug.log("continuing session on new tab",this.session.getTabId()),this.send(Uv(this.session.getTabId()))),this.observer.observe(),this.ticker.start()};this.coldInterval=setInterval(()=>{s()},3e4),s()},this.setupConditionalStart=async e=>{this.conditionsManager=new Vb(this,e);const t=await fetch(this.options.ingestPoint+"/v1/web/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...this.getTrackerInfo(),timestamp:nv(),doNotRecord:!0,bufferDiff:0,userID:this.session.getInfo().userID,token:void 0,deviceMemory:qv,jsHeapSizeLimit:Wv,timezone:fS(),width:window.screen.width,height:window.screen.height})}),{token:n,userBrowser:s,userCity:r,userCountry:o,userDevice:i,userOS:a,userState:c,projectID:u,features:l}=await t.json();this.features=l||this.features,this.session.assign({projectID:u}),this.session.setUserInfo({userBrowser:s,userCity:r,userCountry:o,userDevice:i,userOS:a,userState:c});const d={sessionToken:n,userUUID:"",sessionID:""};this.startCallbacks.forEach(e=>e(d)),await(this.conditionsManager?.fetchConditions(u,n)),this.features["feature-flags"]&&(await this.featureFlags.reloadFlags(n),this.conditionsManager?.processFlags(this.featureFlags.flags)),await this.tagWatcher.fetchTags(this.options.ingestPoint,n)},this.onSessionSent=()=>{},this.offlineRecording=(e={},t)=>{this.onSessionSent=t,this.singleBuffer=!0;const n=this.checkSessionToken(e.forceNew);ev(),this.coldStartTs=nv();const s=this.localStorage.getItem(lS);if(s){const e=JSON.parse(s);this.bufferedMessages1=Array.isArray(e)?e:this.bufferedMessages1,this.localStorage.removeItem(lS)}this.bufferedMessages1.push(Sv(this.timestamp())),this.bufferedMessages1.push(Hv(this.session.getTabId())),this.activityState=hS.ColdStart,e.sessionHash&&this.session.applySessionHash(e.sessionHash),e.forceNew&&this.session.reset(),this.session.assign({userID:e.userID,metadata:e.metadata});const r={sessionToken:"",userUUID:"",sessionID:""};return this.startCallbacks.forEach(e=>e(r)),n||this.send(Uv(this.session.getTabId())),this.observer.observe(),this.ticker.start(),{saveBuffer:this.saveBuffer,getBuffer:this.getBuffer,setBuffer:this.setBuffer}},this.saveBuffer=()=>{this.localStorage.setItem(lS,JSON.stringify(this.bufferedMessages1))},this.getBuffer=()=>this.bufferedMessages1,this.setBuffer=e=>{this.bufferedMessages1=e},this.prevOpts={},this.restartCanvasTracking=()=>{this.canvasRecorder?.restartTracking()},this.flushBuffer=async e=>new Promise((t,n)=>{if(0===e.length)return void t(null);let s=1;for(;s<e.length&&0!==e[s][0];)s++;vv(()=>{try{const n=e.splice(0,s);this.postToWorker(n.map(e=>[...e])),t(null)}catch(e){this._debug("flushBuffer",e),n(new Error("flushBuffer failed"))}})}),this.onUxtCb=[],this.contextId=Math.random().toString(36).slice(2),this.projectKey=e,this.networkOptions=n.network;const o={revID:"",node_id:"__openreplay_id",session_token_key:"__openreplay_token",session_pageno_key:"__openreplay_pageno",session_reset_key:"__openreplay_reset",session_tabid_key:"__openreplay_tabid",local_uuid_key:"__openreplay_uuid",ingestPoint:"https://api.openreplay.com/ingest",resourceBaseHref:null,__is_snippet:!1,__debug_report_edp:null,__debug__:0,localStorage:null,sessionStorage:null,forceSingleTab:!1,assistSocketHost:"",captureIFrames:!0,obscureTextEmails:!1,obscureTextNumbers:!1,disableStringDict:!1,crossdomain:{parentDomain:"*"},canvas:{disableCanvas:!1,fixedCanvasScaling:!1,__save_canvas_locally:!1,useAnimationFrame:!1},forceNgOff:!1,inlineCss:0,disableSprites:!1};if(this.options=_v(o,n),!this.insideIframe&&!this.options.forceSingleTab&&globalThis&&"BroadcastChannel"in globalThis){const e=location.hostname.split(".").slice(-2).join("_");this.bc=new BroadcastChannel(`rick_${e}`)}else this.options.forceSingleTab&&this.allowAppStart();this.revID=this.options.revID,this.localStorage=this.options.localStorage??window.localStorage,this.sessionStorage=this.options.sessionStorage??window.sessionStorage,this.sanitizer=new oS({app:this,options:n}),this.nodes=new $_({node_id:this.options.node_id,forceNgOff:Boolean(n.forceNgOff),maintainer:this.options.nodes?.maintainer}),this.observer=new nS({app:this,options:n}),this.ticker=new aS(this),this.ticker.attach(()=>this.commit()),this.debug=new L_(this.options.__debug__),this.session=new iS({app:this,options:this.options}),this.attributeSender=new Wb({app:this,isDictDisabled:Boolean(this.options.disableStringDict||this.options.crossdomain?.enabled)}),this.featureFlags=new Gb(this),this.tagWatcher=new Jv({sessionStorage:this.sessionStorage,errLog:this.debug.error,onTag:e=>this.send([120,e])}),this.session.attachUpdateCallback(({userID:e,metadata:t})=>{null!=e&&this.send([28,e]),null!=t&&Object.entries(t).forEach(([e,t])=>this.send(Tv(e,t)))}),null!=t&&this.session.applySessionHash(t);const i=this.session.getTabId();this.insideIframe?(window.addEventListener("message",this.parentCrossDomainFrameListener),window.addEventListener("message",this.crossDomainIframeListener),setInterval(()=>{document.hidden||window.parent.postMessage({line:TS,context:this.contextId},n.crossdomain?.parentDomain??"*")},250)):(this.initWorker(),window.addEventListener("message",this.crossDomainIframeListener)),null!==this.bc&&(this.bc.postMessage({line:gS,source:i,context:this.contextId,projectKey:this.projectKey}),this.startTimeout=setTimeout(()=>{this.allowAppStart()},250),this.bc.onmessage=e=>{if(e.data.context!==this.contextId&&this.projectKey===e.data.projectKey){if(this.debug.log(e),e.data.line===yS){const t=e.data.token;this.session.setSessionToken(t,this.projectKey),this.allowAppStart()}if(e.data.line===bS){const t=e.data.token;this.session.regenerateTabId(),this.session.setSessionToken(t,this.projectKey),this.allowAppStart()}if(e.data.line===gS){const t=this.session.getSessionToken(this.projectKey);t&&this.bc&&this.bc.postMessage({line:e.data.source===i?bS:yS,token:t,source:i,context:this.contextId,projectKey:this.projectKey})}}else this.debug.log("same ctx event",e)})}allowAppStart(){this.canStart=!0,this.startTimeout&&(clearTimeout(this.startTimeout),this.startTimeout=null)}async checkNodeId(e){let t;if(this.pageFrames.length>0&&(t=this.pageFrames.find(t=>t.contentWindow===e)),!t||!this.pageFrames.length){const n=Array.from(document.querySelectorAll("iframe"));this.pageFrames=n,t=n.find(t=>t.contentWindow===e)}if(!t)return null;let n=0;for(;n<100;){const e=t[this.options.node_id];if(void 0!==e)return n=100,e;n++,await mS(100)}return null}initWorker(){try{this.worker=new Worker(URL.createObjectURL(new Blob(['!function(){"use strict";class t{constructor(t,s,i,e=10,n=250,h,r){this.onUnauthorised=s,this.onFailure=i,this.MAX_ATTEMPTS_COUNT=e,this.ATTEMPT_TIMEOUT=n,this.onCompress=h,this.pageNo=r,this.attemptsCount=0,this.busy=!1,this.queue=[],this.token=null,this.lastBatchNum=0,this.ingestURL=t+"/v1/web/i",this.isCompressing=void 0!==h}getQueueStatus(){return 0===this.queue.length&&!this.busy}authorise(t){this.token=t,this.busy||this.sendNext()}push(t){if(this.busy||!this.token)this.queue.push(t);else if(this.busy=!0,this.isCompressing&&this.onCompress)this.onCompress(t);else{const s=++this.lastBatchNum;this.sendBatch(t,!1,s)}}sendNext(){const t=this.queue.shift();if(t)if(this.busy=!0,this.isCompressing&&this.onCompress)this.onCompress(t);else{const s=++this.lastBatchNum;this.sendBatch(t,!1,s)}else this.busy=!1}retry(t,s,i){this.attemptsCount>=this.MAX_ATTEMPTS_COUNT?this.onFailure(`Failed to send batch after ${this.attemptsCount} attempts.`):(this.attemptsCount++,setTimeout((()=>this.sendBatch(t,s,i)),this.ATTEMPT_TIMEOUT*this.attemptsCount))}sendBatch(t,s,i){var e;const n=null==i?void 0:i.toString().replace(/^([^_]+)_([^_]+).*/,"$1_$2_$3");this.busy=!0;const h={Authorization:`Bearer ${this.token}`};s&&(h["Content-Encoding"]="gzip"),null!==this.token?fetch(`${this.ingestURL}?batch=${null!==(e=this.pageNo)&&void 0!==e?e:"noPageNum"}_${null!=n?n:"noBatchNum"}`,{body:t,method:"POST",headers:h,keepalive:t.length<65536}).then((e=>{if(401===e.status)return this.busy=!1,void this.onUnauthorised();e.status>=400?this.retry(t,s,`${null!=i?i:"noBatchNum"}_network:${e.status}`):(this.attemptsCount=0,this.sendNext())})).catch((e=>{console.warn("OpenReplay:",e),this.retry(t,s,`${null!=i?i:"noBatchNum"}_reject:${e.message}`)})):setTimeout((()=>{this.sendBatch(t,s,`${null!=i?i:"noBatchNum"}_newToken`)}),500)}sendCompressed(t){const s=++this.lastBatchNum;this.sendBatch(t,!0,s)}sendUncompressed(t){const s=++this.lastBatchNum;this.sendBatch(t,!1,s)}clean(){this.sendNext(),setTimeout((()=>{this.token=null,this.queue.length=0}),10)}}const s="function"==typeof TextEncoder?new TextEncoder:{encode(t){const s=t.length,i=new Uint8Array(3*s);let e=-1;for(let n=0,h=0,r=0;r!==s;){if(n=t.charCodeAt(r),r+=1,n>=55296&&n<=56319){if(r===s){i[e+=1]=239,i[e+=1]=191,i[e+=1]=189;break}if(h=t.charCodeAt(r),!(h>=56320&&h<=57343)){i[e+=1]=239,i[e+=1]=191,i[e+=1]=189;continue}if(n=1024*(n-55296)+h-56320+65536,r+=1,n>65535){i[e+=1]=240|n>>>18,i[e+=1]=128|n>>>12&63,i[e+=1]=128|n>>>6&63,i[e+=1]=128|63&n;continue}}n<=127?i[e+=1]=0|n:n<=2047?(i[e+=1]=192|n>>>6,i[e+=1]=128|63&n):(i[e+=1]=224|n>>>12,i[e+=1]=128|n>>>6&63,i[e+=1]=128|63&n)}return i.subarray(0,e+1)}};class i{constructor(t){this.size=t,this.offset=0,this.checkpointOffset=0,this.data=new Uint8Array(t)}getCurrentOffset(){return this.offset}checkpoint(){this.checkpointOffset=this.offset}get isEmpty(){return 0===this.offset}skip(t){return this.offset+=t,this.offset<=this.size}set(t,s){this.data.set(t,s)}boolean(t){return this.data[this.offset++]=+t,this.offset<=this.size}uint(t){for((t<0||t>Number.MAX_SAFE_INTEGER)&&(t=0);t>=128;)this.data[this.offset++]=t%256|128,t=Math.floor(t/128);return this.data[this.offset++]=t,this.offset<=this.size}int(t){return t=Math.round(t),this.uint(t>=0?2*t:-2*t-1)}string(t){const i=s.encode(t),e=i.byteLength;return!(!this.uint(e)||this.offset+e>this.size)&&(this.data.set(i,this.offset),this.offset+=e,!0)}reset(){this.offset=0,this.checkpointOffset=0}flush(){const t=this.data.slice(0,this.checkpointOffset);return this.reset(),t}}class e extends i{encode(t){switch(t[0]){case 0:case 11:case 114:case 115:return this.uint(t[1]);case 4:case 44:case 47:return this.string(t[1])&&this.string(t[2])&&this.uint(t[3]);case 5:case 20:case 38:case 70:case 75:case 76:case 77:case 82:return this.uint(t[1])&&this.uint(t[2]);case 6:return this.int(t[1])&&this.int(t[2]);case 7:return!0;case 8:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.string(t[4])&&this.boolean(t[5]);case 9:case 10:case 24:case 35:case 51:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3]);case 12:case 52:case 61:case 71:return this.uint(t[1])&&this.string(t[2])&&this.string(t[3]);case 13:case 14:case 17:case 34:case 50:case 54:return this.uint(t[1])&&this.string(t[2]);case 16:return this.uint(t[1])&&this.int(t[2])&&this.int(t[3]);case 18:return this.uint(t[1])&&this.string(t[2])&&this.int(t[3]);case 19:return this.uint(t[1])&&this.boolean(t[2]);case 21:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4])&&this.string(t[5])&&this.uint(t[6])&&this.uint(t[7])&&this.uint(t[8]);case 22:case 27:case 30:case 41:case 45:case 46:case 43:case 63:case 64:case 79:case 124:return this.string(t[1])&&this.string(t[2]);case 23:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.uint(t[4])&&this.uint(t[5])&&this.uint(t[6])&&this.uint(t[7])&&this.uint(t[8])&&this.uint(t[9]);case 28:case 29:case 42:case 117:case 118:return this.string(t[1]);case 37:return this.uint(t[1])&&this.string(t[2])&&this.uint(t[3]);case 39:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4])&&this.uint(t[5])&&this.uint(t[6])&&this.uint(t[7]);case 40:return this.string(t[1])&&this.uint(t[2])&&this.string(t[3])&&this.string(t[4]);case 48:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4])&&this.int(t[5]);case 49:return this.int(t[1])&&this.int(t[2])&&this.uint(t[3])&&this.uint(t[4]);case 53:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.uint(t[4])&&this.uint(t[5])&&this.uint(t[6])&&this.string(t[7])&&this.string(t[8]);case 55:return this.boolean(t[1]);case 57:case 60:return this.uint(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4]);case 58:case 120:return this.int(t[1]);case 59:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.uint(t[4])&&this.string(t[5])&&this.string(t[6])&&this.string(t[7]);case 67:case 73:return this.uint(t[1])&&this.string(t[2])&&this.uint(t[3])&&this.string(t[4]);case 68:return this.uint(t[1])&&this.uint(t[2])&&this.string(t[3])&&this.string(t[4])&&this.uint(t[5])&&this.uint(t[6]);case 69:return this.uint(t[1])&&this.uint(t[2])&&this.string(t[3])&&this.string(t[4]);case 78:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4]);case 81:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.int(t[4])&&this.string(t[5]);case 83:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4])&&this.string(t[5])&&this.uint(t[6])&&this.uint(t[7])&&this.uint(t[8])&&this.uint(t[9]);case 84:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.uint(t[4])&&this.string(t[5])&&this.string(t[6]);case 112:return this.uint(t[1])&&this.string(t[2])&&this.boolean(t[3])&&this.string(t[4])&&this.int(t[5])&&this.int(t[6]);case 113:return this.uint(t[1])&&this.uint(t[2])&&this.string(t[3]);case 116:return this.uint(t[1])&&this.uint(t[2])&&this.uint(t[3])&&this.uint(t[4])&&this.uint(t[5])&&this.uint(t[6])&&this.string(t[7])&&this.string(t[8])&&this.uint(t[9])&&this.boolean(t[10]);case 119:return this.string(t[1])&&this.uint(t[2]);case 121:return this.string(t[1])&&this.string(t[2])&&this.uint(t[3])&&this.uint(t[4]);case 122:return this.string(t[1])&&this.string(t[2])&&this.uint(t[3])&&this.string(t[4]);case 123:return this.string(t[1])&&this.string(t[2])&&this.string(t[3])&&this.string(t[4])&&this.uint(t[5])}}}class n{constructor(t,s,i,n,h,r){this.pageNo=t,this.timestamp=s,this.url=i,this.onBatch=n,this.tabId=h,this.onOfflineEnd=r,this.nextIndex=0,this.beaconSize=2e5,this.encoder=new e(this.beaconSize),this.sizeBuffer=new Uint8Array(3),this.isEmpty=!0,this.checkpoints=[],this.beaconSizeLimit=1e6,this.prepare()}writeType(t){return this.encoder.uint(t[0])}writeFields(t){return this.encoder.encode(t)}writeSizeAt(t,s){for(let s=0;s<3;s++)this.sizeBuffer[s]=t>>8*s;this.encoder.set(this.sizeBuffer,s)}prepare(){if(!this.encoder.isEmpty)return;this.checkpoints.length=0;const t=[81,1,this.pageNo,this.nextIndex,this.timestamp,this.url],s=[0,this.timestamp],i=[118,this.tabId];this.writeType(t),this.writeFields(t),this.writeWithSize(s),this.writeWithSize(i),this.isEmpty=!0}writeWithSize(t){const s=this.encoder;if(!this.writeType(t)||!s.skip(3))return!1;const i=s.getCurrentOffset(),e=this.writeFields(t);if(e){const e=s.getCurrentOffset()-i;if(e>16777215)return console.warn("OpenReplay: max message size overflow."),!1;this.writeSizeAt(e,i-3),s.checkpoint(),this.checkpoints.push(s.getCurrentOffset()),this.isEmpty=this.isEmpty&&0===t[0],this.nextIndex++}return e}setBeaconSizeLimit(t){this.beaconSizeLimit=t}writeMessage(t){if("q_end"===t[0])return this.finaliseBatch(),this.onOfflineEnd();0===t[0]&&(this.timestamp=t[1]),122===t[0]&&(this.url=t[1]),this.writeWithSize(t)||(this.finaliseBatch(),this.writeWithSize(t)||(this.encoder=new e(this.beaconSizeLimit),this.prepare(),this.writeWithSize(t)?this.finaliseBatch():console.warn("OpenReplay: beacon size overflow. Skipping large message.",t,this),this.encoder=new e(this.beaconSize),this.prepare()))}finaliseBatch(t=!1){if(this.isEmpty)return;const s=this.encoder.flush();this.onBatch(s,t),this.prepare()}clean(){this.encoder.reset(),this.checkpoints.length=0}}var h;!function(t){t[t.NotActive=0]="NotActive",t[t.Starting=1]="Starting",t[t.Stopping=2]="Stopping",t[t.Active=3]="Active",t[t.Stopped=4]="Stopped"}(h||(h={}));let r=null,a=null,u=h.NotActive;function o(t){a&&a.finaliseBatch(t)}function c(){return new Promise((t=>{u=h.Stopping,null!==p&&(clearInterval(p),p=null),a&&(a.clean(),a=null),r&&(r.clean(),setTimeout((()=>{r=null}),20)),setTimeout((()=>{u=h.NotActive,t(null)}),100)}))}function g(){[h.Stopped,h.Stopping].includes(u)||(postMessage("a_stop"),c().then((()=>{postMessage("a_start")})))}let l,p=null;self.onmessage=({data:s})=>{if("stop"===s)return o(),void c().then((()=>{u=h.Stopped}));if("forceFlushBatch"!==s)if("closing"!==s){if(!Array.isArray(s)){if("compressed"===s.type){if(!r)return console.debug("OR WebWorker: sender not initialised. Compressed batch."),void g();s.batch&&r.sendCompressed(s.batch)}if("uncompressed"===s.type){if(!r)return console.debug("OR WebWorker: sender not initialised. Uncompressed batch."),void g();s.batch&&r.sendUncompressed(s.batch)}return"start"===s.type?(u=h.Starting,r=new t(s.ingestPoint,(()=>{g()}),(t=>{!function(t){postMessage({type:"failure",reason:t}),c()}(t)}),s.connAttemptCount,s.connAttemptGap,(t=>{postMessage({type:"compress",batch:t},[t.buffer])}),s.pageNo),a=new n(s.pageNo,s.timestamp,s.url,((t,s)=>{r&&(s?r.sendUncompressed(t):r.push(t))}),s.tabId,(()=>postMessage({type:"queue_empty"}))),null===p&&(p=setInterval(o,3e4)),u=h.Active):"auth"===s.type?r?a?(r.authorise(s.token),void(s.beaconSizeLimit&&a.setBeaconSizeLimit(s.beaconSizeLimit))):(console.debug("OR WebWorker: writer not initialised. Received auth."),void g()):(console.debug("OR WebWorker: sender not initialised. Received auth."),void g()):void 0}if(a){const t=a;s.forEach((s=>{55===s[0]&&(s[1]?l=setTimeout((()=>g()),18e5):clearTimeout(l)),t.writeMessage(s)}))}else postMessage("not_init"),g()}else o(!0);else o()}}();\n'],{type:"text/javascript"}))),this.worker.onerror=e=>{this._debug("webworker_error",e)},this.worker.onmessage=({data:e})=>{this.handleWorkerMsg(e)};let e=!1;const t=()=>{e||(e=!0,setTimeout(()=>{e=!1},500),this.worker&&this.worker.postMessage("closing"))};this.attachEventListener(document.body,"mouseleave",t,!1,!1),this.attachEventListener(window,"pagehide",t,!1,!1),this.attachEventListener(document,"visibilitychange",e=>"hidden"===document.visibilityState&&t(),!1)}catch(e){this._debug("worker_start",e)}}handleWorkerMsg(e){if("a_stop"===e)this.stop(!1);else if("a_start"===e)this.waitStatus(hS.NotActive).then(()=>{this.allowAppStart(),this.start(this.prevOpts,!0).then(e=>{this.debug.info("Worker restart, session too long",e)}).catch(e=>{this.debug.error("Worker restart failed",e)})});else if("not_init"===e)this.debug.warn("OR WebWorker: writer not initialised. Restarting tracker");else if("failure"===e.type)this.stop(!1),this.debug.error("worker_failed",e.reason),this._debug("worker_failed",e.reason);else if("compress"===e.type){const t=e.batch;t.byteLength>this.compressionThreshold?Ub(e.batch,{mtime:0},(e,n)=>{e?(this.debug.error("Openreplay compression error:",e),this.worker?.postMessage({type:"uncompressed",batch:t})):this.worker?.postMessage({type:"compressed",batch:n})}):this.worker?.postMessage({type:"uncompressed",batch:t})}else"queue_empty"===e.type&&this.onSessionSent()}_debug(e,t){null!==this.options.__debug_report_edp&&fetch(this.options.__debug_report_edp,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:e,error:`${t}`})}),this.debug.error("OpenReplay error: ",e,t)}_nCommit(){if(this.socketMode)return this.messages.unshift(Sv(this.timestamp()),Hv(this.session.getTabId())),this.commitCallbacks.forEach(e=>e(this.messages)),void(this.messages.length=0);if(this.insideIframe)return window.parent.postMessage({line:SS,messages:this.messages},this.options.crossdomain?.parentDomain??"*"),this.commitCallbacks.forEach(e=>e(this.messages)),void(this.messages.length=0);if(void 0!==this.worker&&this.messages.length)if(!this.messages.length&&this.emptyBatchCounter<1e3)this.emptyBatchCounter++;else{this.emptyBatchCounter=0;try{vv(()=>{this.messages.unshift(Sv(this.timestamp()),Hv(this.session.getTabId())),this.worker?.postMessage(this.messages),this.commitCallbacks.forEach(e=>e(this.messages)),this.messages.length=0})}catch(e){this._debug("worker_commit",e),this.stop(!0),setTimeout(()=>{this.start()},500)}}}_cStartCommit(){if(this.coldStartCommitN+=1,2===this.coldStartCommitN){const e=[Sv(this.timestamp()),Hv(this.session.getTabId())];this.bufferedMessages1.push(...e),this.bufferedMessages2.push(...e),this.coldStartCommitN=0}}commit(){this.activityState===hS.ColdStart?this._cStartCommit():this._nCommit()}postToWorker(e){this.worker?.postMessage(e),this.commitCallbacks.forEach(t=>t(e))}timestamp(){return nv()+this.delay}safe(e){const t=this;return function(...n){try{e.apply(this,n)}catch(e){t._debug("safe_fn_call",e)}}}attachCommitCallback(e){this.commitCallbacks.push(e)}checkRequiredVersion(e){const t=e.split(/[.-]/),n=this.version.split(/[.-]/);for(let e=0;e<3;e++){if(isNaN(Number(n[e]))||isNaN(Number(t[e])))return!1;if(Number(n[e])>Number(t[e]))return!0;if(Number(n[e])<Number(t[e]))return!1}return!0}getTrackerInfo(){return{userUUID:this.localStorage.getItem(this.options.local_uuid_key),projectKey:this.projectKey,revID:this.revID,trackerVersion:this.version,isSnippet:this.options.__is_snippet}}getSessionInfo(){return{...this.session.getInfo(),...this.getTrackerInfo()}}getSessionToken(){return this.session.getSessionToken(this.projectKey)}getSessionID(){return this.session.getInfo().sessionID||void 0}getSessionURL(e){const{projectID:t,sessionID:n,timestamp:s}=this.session.getInfo();if(!t||!n)return void this.debug.error("OpenReplay error: Unable to build session URL");const r=this.options.ingestPoint,o=(/api\.openreplay\.com/.test(r)?"https://app.openreplay.com/ingest":r).replace(/ingest$/,`${t}/session/${n}`);return e?.withCurrentTime?`${o}?jumpto=${nv()-s}`:o}getHost(){return new URL(this.options.ingestPoint).host}getProjectKey(){return this.projectKey}getBaseHref(){return"string"==typeof this.options.resourceBaseHref?this.options.resourceBaseHref:(this.options.resourceBaseHref,document.baseURI?document.baseURI:document.head?.getElementsByTagName("base")[0]?.getAttribute("href")||location.origin+location.pathname)}resolveResourceURL(e){const t=new URL(this.getBaseHref());return t.pathname+="/"+new URL(e).pathname,t.pathname.replace(/\/+/g,"/"),t.toString()}isServiceURL(e){return e.startsWith(this.options.ingestPoint)}active(){return this.activityState===hS.Active}resetNextPageSession(e){e?this.sessionStorage.setItem(this.options.session_reset_key,"t"):this.sessionStorage.removeItem(this.options.session_reset_key)}checkSessionToken(e){const t=null!==this.sessionStorage.getItem(this.options.session_reset_key),n=e||t,s=this.session.getSessionToken(this.projectKey);return n||!s}async uploadOfflineRecording(){this.stop(!1);const e=nv();this.worker?.postMessage({type:"start",pageNo:this.session.incPageNo(),ingestPoint:this.options.ingestPoint,timestamp:this.coldStartTs,url:document.URL,connAttemptCount:this.options.connAttemptCount,connAttemptGap:this.options.connAttemptGap,tabId:this.session.getTabId()});const t=await fetch(this.options.ingestPoint+"/v1/web/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...this.getTrackerInfo(),timestamp:e,doNotRecord:!1,bufferDiff:e-this.coldStartTs,userID:this.session.getInfo().userID,token:void 0,deviceMemory:qv,jsHeapSizeLimit:Wv,timezone:fS()})}),{token:n,userBrowser:s,userCity:r,userCountry:o,userDevice:i,userOS:a,userState:c,beaconSizeLimit:u,projectID:l}=await t.json();for(this.worker?.postMessage({type:"auth",token:n,beaconSizeLimit:u}),this.session.assign({projectID:l}),this.session.setUserInfo({userBrowser:s,userCity:r,userCountry:o,userDevice:i,userOS:a,userState:c});this.bufferedMessages1.length>0;)await this.flushBuffer(this.bufferedMessages1);this.postToWorker([["q_end"]]),this.clearBuffers()}async _start(e={},t=!1,n){0!==Object.keys(e).length&&(this.prevOpts=e);const s=this.activityState===hS.ColdStart;if(s&&this.coldInterval&&clearInterval(this.coldInterval),!this.worker&&!this.insideIframe){const e="No worker found: perhaps, CSP is not set.";return this.signalError(e,[]),Promise.resolve(dS(e))}if(this.activityState===hS.Active||this.activityState===hS.Starting){const e="OpenReplay: trying to call `start()` on the instance that has been started already.";return Promise.resolve(dS(e))}this.activityState=hS.Starting,s||ev(),e.sessionHash&&this.session.applySessionHash(e.sessionHash),e.forceNew&&this.session.reset(),this.session.assign({userID:e.userID,metadata:e.metadata});const r=nv();this.worker?.postMessage({type:"start",pageNo:this.session.incPageNo(),ingestPoint:this.options.ingestPoint,timestamp:s?this.coldStartTs:r,url:document.URL,connAttemptCount:this.options.connAttemptCount,connAttemptGap:this.options.connAttemptGap,tabId:this.session.getTabId()});const o=this.session.getSessionToken(this.projectKey),i=this.checkSessionToken(e.forceNew);this.sessionStorage.removeItem(this.options.session_reset_key),this.debug.log("OpenReplay: starting session; need new session id?",i,"session token: ",o);try{const t=await window.fetch(this.options.ingestPoint+"/v1/web/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...this.getTrackerInfo(),timestamp:r,doNotRecord:!1,bufferDiff:r-this.coldStartTs,userID:this.session.getInfo().userID,token:i?void 0:o,deviceMemory:qv,jsHeapSizeLimit:Wv,timezone:fS(),condition:n,assistOnly:e.assistOnly??this.socketMode,width:window.screen.width,height:window.screen.height})});if(200!==t.status){const e=await t.text(),n=e===cS?cS:`Server error: ${t.status}. ${e}`;return dS(n)}if(!this.worker&&!this.insideIframe){const e="no worker found after start request (this should not happen in real world)";return this.signalError(e,[]),dS(e)}const{token:a,userUUID:c,projectID:u,beaconSizeLimit:l,compressionThreshold:d,delay:p,sessionID:h,startTimestamp:f,userBrowser:m,userCity:g,userCountry:y,userDevice:b,userOS:v,userState:_,canvasEnabled:S,canvasQuality:w,canvasFPS:k,assistOnly:x,features:T}=await t.json();if(this.features=T||this.features,"string"!=typeof a||"string"!=typeof c||"number"!=typeof f&&void 0!==f||"string"!=typeof h||"number"!=typeof p||"number"!=typeof l&&void 0!==l){const e=`Incorrect server response: ${JSON.stringify(t)}`;return this.signalError(e,[]),dS(e)}this.delay=p,this.session.setSessionToken(a,this.projectKey),this.session.setUserInfo({userBrowser:m,userCity:g,userCountry:y,userDevice:b,userOS:v,userState:_}),this.session.assign({sessionID:h,timestamp:f||r,projectID:u}),x?(this.socketMode=!0,this.worker?.postMessage("stop")):this.worker?.postMessage({type:"auth",token:a,beaconSizeLimit:l}),i||a!==o||(this.debug.log("continuing session on new tab",this.session.getTabId()),this.send(Uv(this.session.getTabId()))),Object.entries(this.session.getInfo().metadata).forEach(([e,t])=>this.send(Tv(e,t))),this.localStorage.setItem(this.options.local_uuid_key,c),this.compressionThreshold=d;const E={sessionToken:a,userUUID:c,sessionID:h};if(this.startCallbacks.forEach(e=>e(E)),e.startCallback&&e.startCallback(pS(E)),this.features["feature-flags"])try{this.featureFlags.reloadFlags()}catch(e){this.debug.log("Error getting feature flags",e)}if(await this.tagWatcher.fetchTags(this.options.ingestPoint,a),this.activityState=hS.Active,this.options.crossdomain?.enabled&&this.bootChildrenFrames(),S&&!this.options.canvas.disableCanvas&&(this.canvasRecorder=this.canvasRecorder??new N_(this,{fps:k,quality:w,isDebug:this.options.canvas.__save_canvas_locally,fixedScaling:this.options.canvas.fixedCanvasScaling,useAnimationFrame:this.options.canvas.useAnimationFrame})),s){const e=this.bufferedMessages1.length>this.bufferedMessages2.length?this.bufferedMessages1:this.bufferedMessages2;for(;e.length>0;)await this.flushBuffer(e);this.clearBuffers(),this.commit()}else this.insideIframe&&this.rootId?this.observer.crossdomainObserve(this.rootId,this.frameOderNumber,this.frameLevel):this.observer.observe(),this.ticker.start();if(this.canvasRecorder?.startTracking(),this.features["usability-test"]&&!this.insideIframe){let e;this.uxtManager=this.uxtManager?this.uxtManager:new T_(this,uS);const t=this.localStorage.getItem(uS);if(t&&(e=parseInt(t,10)),location?.search){const t=new URLSearchParams(location.search);if(t.has("oruxt")){const n=t.get("oruxt");e=n?parseInt(n,10):void 0}}e&&(this.uxtManager.isActive?this.onUxtCb.forEach(t=>t(e)):this.uxtManager.getTest(e,a,Boolean(t)).then(e=>{e&&this.onUxtCb.forEach(t=>t(e))}))}return pS(E)}catch(e){if(this.stop(),this.session.reset(),!e)return console.error("Unknown error during start"),this.signalError("Unknown error",[]),dS("Unknown error");if(e===cS)return this.signalError(cS,[]),dS(cS);this._debug("session_start",e);const t=e instanceof Error?e.message:e.toString();return this.signalError(t,[]),dS(t)}}addOnUxtCb(e){this.onUxtCb.push(e)}getUxtId(){return this.uxtManager?.getTestId()}async waitStart(){return new Promise(e=>{const t=setInterval(()=>{this.canStart&&(clearInterval(t),e(!0))},100)})}async waitStarted(){return this.waitStatus(hS.Active)}async waitStatus(e){return new Promise(t=>{const n=()=>{this.activityState===e?t(!0):setTimeout(n,25)};n()})}async start(...e){if(this.activityState===hS.Active||this.activityState===hS.Starting){const e="OpenReplay: trying to call `start()` on the instance that has been started already.";return Promise.resolve(dS(e))}return this.insideIframe&&this.signalIframeTracker(),document.hidden?new Promise(t=>{const n=async()=>{document.hidden||(await this.waitStart(),document.removeEventListener("visibilitychange",n),t(this._start(...e)))};document.addEventListener("visibilitychange",n)}):(await this.waitStart(),this._start(...e))}forceFlushBatch(){this.worker?.postMessage("forceFlushBatch")}getTabId(){return this.session.getTabId()}clearBuffers(){this.bufferedMessages1.length=0,this.bufferedMessages2.length=0}trackWs(e){const t=e;return(e,n,s="down")=>{"string"!=typeof e||"string"!=typeof n||n.length>5242880||e.length>255||this.send(function(e,t,n,s,r,o){return[84,e,t,n,s,r,o]}("websocket",t,n,this.timestamp(),s,e))}}stop(e=!0){if(this.activityState!==hS.NotActive)try{this.options.crossdomain?.enabled&&this.killChildrenFrames(),this.attributeSender.clear(),this.sanitizer.clear(),this.observer.disconnect(),this.nodes.clear(),this.ticker.stop(),this.stopCallbacks.forEach(e=>e()),this.tagWatcher.clear(),this.worker&&e&&this.worker.postMessage("stop"),this.canvasRecorder?.clear(),this.messages.length=0,this.parentActive=!1}finally{this.activityState=hS.NotActive,this.debug.log("OpenReplay tracking stopped.")}}}const IS=Yb&&"InstallTrigger"in window?e=>e.message+"\n"+e.stack:e=>e.stack||e.message;function CS(e){return void 0===e?"undefined":null===e?"null":e instanceof Error?IS(e):Array.isArray(e)?`Array(${e.length})`:String(e)}function MS(e){if(void 0===e)return"undefined";if(null===e)return"null";if(e instanceof Error)return IS(e);if(Array.isArray(e))return`Array(${e.length})[${e.slice(0,10).map(CS).join(", ")}]`;if("object"==typeof e){const t=[];let n=0;for(const s in e){if(10===++n)break;const r=e[s];t.push(s+": "+CS(r))}return"{"+t.join(", ")+"}"}return e.toString()}const RS=["log","info","warn","error","debug","assert"];function OS(e,t){const n=Object.assign({consoleMethods:RS,consoleThrottling:30},t);if(!Array.isArray(n.consoleMethods)||0===n.consoleMethods.length)return;const s=e.safe((t,n)=>{let s=function(e){return"string"==typeof e[0]&&e.unshift(e.shift().replace(/%(o|s|f|d|i)/g,(t,n)=>{const s=e.shift();if(void 0===s)return t;switch(n){case"o":return MS(s);case"s":return CS(s);case"f":return function(e){return"number"!=typeof e?"NaN":e.toString()}(s);case"d":case"i":return function(e){return"number"!=typeof e?"NaN":Math.floor(e).toString()}(s);default:return t}})),e.map(MS).join(" ")}(n);e.sanitizer.privateMode&&(s=s.replaceAll(/./g,"*")),e.send(function(e,t){return[22,e,t]}(t,s))});let r=0;const o=()=>{r=0};e.attachStartCallback(o),e.ticker.attach(o,33,!1);const i=e.safe(t=>((t,o)=>{const i={apply:function(e,t,i){Reflect.apply(e,o,i),r+=1,r>n.consoleThrottling||s(e.name,i)}};n.consoleMethods.forEach(n=>{if(-1===RS.indexOf(n))return void e.debug.error(`OpenReplay: unsupported console method "${n}"`);const s=o.console[n];t[n]=new Proxy(s,i)})})(t.console,t));i(window),e.observer.attachContextCallback(i)}const AS=/(^|@)\S+:\d+/,NS=/^\s*at .*(\S+:\d+|\(native\))/m,DS=/^(eval@)?(\[native code\])?$/;function LS(e){if(!e.includes(":"))return[e,void 0,void 0];const t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]}function PS(e,t){return e}function FS(e){return[{columnNumber:e.colno,lineNumber:e.lineno,fileName:e.filename,functionName:"",source:""}]}function $S(e,t,n={}){let s=t;try{s=function(e){return function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return!(t=e).stacktrace||t.message.includes("\n")&&t.message.split("\n").length>t.stacktrace.split("\n").length?function(e){const t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),s=[];for(let e=2,r=n.length;e<r;e+=2){const r=t.exec(n[e]);r&&s.push({file:r[2],line:+r[1],raw:n[e]})}return PS(s)}(t):t.stack?function(e){return PS(e.stack.split("\n").filter(e=>!!e.match(AS)&&!e.match(/^Error created at/))).map(e=>{const t=e.split("@"),n=LS(t.pop()),s=t.shift()||"",r=s.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;let o;return s.match(/\(([^)]*)\)/)&&(o=s.replace(/^[^(]+\(([^)]*)\)$/,"$1")),{function:r,args:void 0===o||"[arguments not available]"===o?void 0:o.split(","),file:n[0],line:n[1]?+n[1]:void 0,col:n[2]?+n[2]:void 0,raw:e}})}(t):function(e){const t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),s=[];for(let e=0,r=n.length;e<r;e+=2){const r=t.exec(n[e]);r&&s.push({function:r[3]||void 0,file:r[2],line:r[1]?+r[1]:void 0,raw:n[e]})}return PS(s)}(t);var t;if(e.stack&&e.stack.match(NS))return function(e){return PS(e.stack.split("\n").filter(e=>!!e.match(NS))).map(e=>{e.includes("(eval ")&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));let t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,"");const n=t.match(/ (\(.+\)$)/);t=n?t.replace(n[0],""):t;const s=LS(n?n[1]:t);return{function:n&&t||void 0,file:["eval","<anonymous>"].includes(s[0])?void 0:s[0],line:s[1]?+s[1]:void 0,col:s[2]?+s[2]:void 0,raw:e}})}(e);if(e.stack)return function(e){return PS(e.stack.split("\n").filter(e=>!e.match(DS))).map(e=>{if(e.includes(" > eval")&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),e.includes("@")||e.includes(":")){const t=/(([^\n\r"\u2028\u2029]*".[^\n\r"\u2028\u2029]*"[^\n\r@\u2028\u2029]*(?:@[^\n\r"\u2028\u2029]*"[^\n\r@\u2028\u2029]*)*(?:[\n\r\u2028\u2029][^@]*)?)?[^@]*)@/,n=e.match(t),s=n&&n[1]?n[1]:void 0,r=LS(e.replace(t,""));return{function:s,file:r[0],line:r[1]?+r[1]:void 0,col:r[2]?+r[2]:void 0,raw:e}}return{function:e}})}(e);throw new Error("Cannot parse given Error object")}(e).map(e=>({functionName:e.function,args:e.args,fileName:e.file,lineNumber:e.line,columnNumber:e.col,source:e.raw}))}(e)}catch(e){}return Pv(e.name,e.message,JSON.stringify(s),JSON.stringify(n))}function jS(e,t=window,n={}){if(e instanceof ErrorEvent){if(e.error instanceof Error)return $S(e.error,FS(e),n);{let[t,s]=e.message.split(":");return s||(t="Error",s=e.message),Pv(t,s,JSON.stringify(FS(e)),JSON.stringify(n))}}if("PromiseRejectionEvent"in t&&e instanceof t.PromiseRejectionEvent){if(e.reason instanceof Error)return $S(e.reason,[],n);{let t;try{t=JSON.stringify(e.reason)}catch(n){t=String(e.reason)}return Pv("Unhandled Promise Rejection",t,"[]",JSON.stringify(n))}}return null}function BS(e,t=document.location){return(e=e.trim()).startsWith("//")||e.startsWith("http://")||e.startsWith("https://")||e.startsWith("data:")?e:e.startsWith("/")?t.origin+e:t.origin+t.pathname+e}const US=["text","password","email","search","number","range","date","tel","time"],HS=Yb&&"labels"in HTMLInputElement.prototype?e=>{let t=e;for(;null!==(t=t.parentNode);)if(A_(t,"label"))return t;const n=e.labels;if(null!==n&&1===n.length)return n[0]}:e=>{let t=e;for(;null!==(t=t.parentNode);)if(A_(t,"label"))return t;const n=e.id;if(n){const t=e.ownerDocument.querySelectorAll('label[for="'+n+'"]');if(null!==t&&1===t.length)return t[0]}};function zS(e){let t=uv(e);if(null===t){const n=HS(e);t=n&&n.innerText||e.placeholder||e.name||e.id||e.className||e.type}return rv(t).slice(0,100)}const qS="undefined"!=typeof CSS&&CSS.escape||(e=>e),WS=new WeakMap;function VS(e){const t=e.tagName.toUpperCase();return"BUTTON"===t||"A"===t||"LI"===t||"SELECT"===t||"TR"===t||"TH"===t||null!=e.onclick||"button"===e.getAttribute("role")}function JS(e,t){return e instanceof Element?function(e,t){let n=e;for(;null!==n&&n!==t.documentElement;){if(lv(n,"masked"))return null;n=n.parentElement}if(I_(e)){let t=e.ownerSVGElement;for(;null!==t;)e=t,t=t.ownerSVGElement}for(n=e;null!==n&&n!==t.documentElement;){const e=n.tagName.toUpperCase();if("LABEL"===e)return null;if("INPUT"===e)return n;if(VS(n)||null!==uv(n))return n;n=n.parentElement}return e===t.documentElement?null:e}(e,t):null}function KS(e,t){const{disableClickmaps:n=!1}=t||{};let s,r=-1,o=-1,i=!1,a=null,c=0,u={},l=0,d=0,p=0,h=0;e.attachStartCallback(()=>{s=setInterval(()=>function(){const t=h/225;l?(p>4&&(t-l)/225>.008&&e.send([114,nv()]),h=0,p=0,l=t):l=t}(),225)}),e.attachStopCallback(()=>{r=-1,o=-1,i=!1,a=null,u={},s&&clearInterval(s)});const f=()=>{i&&(e.send(function(e,t){return[20,e,t]}(r,o)),i=!1)},m=(t,s=!1)=>{const l=s?e.attachEventListener.bind(e):e.nodes.attachNodeListener.bind(e.nodes);l(t.documentElement,"mouseover",e=>{const n=JS(e.target,t);n!==a&&(a=n,c=performance.now())}),l(t,"mousemove",n=>{const[s,a]=e.observer.getDocumentOffset(t);r=n.clientX+s,o=n.clientY+a,i=!0;const c=Math.sign(n.movementX);h+=Math.abs(n.movementX)+Math.abs(n.movementY),c!==d&&(d=c,p++)},!1),l(t,"click",s=>{const r=JS(s.target,t);if(!s.clientX&&!s.clientY||null===r)return;const o=e.nodes.getID(r);if(void 0!==o){const i=s.pageX,l=s.pageY,d=t.documentElement.scrollWidth,p=t.documentElement.scrollHeight,h=GS(i/d),m=GS(l/p);f();const g=function(t){const n=uv(t);if(null!==n)return n;if(A_(t,"input"))return zS(t);if(VS(t)){let n="";return t instanceof HTMLElement&&(n=e.sanitizer.getInnerTextSecure(t)),n=n||t.id||t.className,rv(n).slice(0,100)}return""}(r);e.send(function(e,t,n,s,r,o){return[68,e,t,n,s,r,o]}(o,a===r?Math.round(performance.now()-c):0,e.sanitizer.privateMode?g.replaceAll(/./g,"*"):g,VS(r)&&!n?function(e,t){return u[e]=u[e]||function(e){return function(e){if(!e||1!==e.nodeType)return!1;if(e.id)return`#${qS(e.id)}`;const t=[];for(;e&&1===e.nodeType&&e!==e.ownerDocument;){if(e.id){t.unshift(`#${qS(e.id)}`);break}const n=e.tagName.toLowerCase();if(e.classList?.length)for(const s of e.classList)if(YS(s)&&XS(s,e.ownerDocument))return t.unshift(`${n}.${qS(s)}`),t.join(" > ");const s=QS(e);if(s)t.unshift(`${n}.${qS(s)}`);else if(e===e.ownerDocument.body||e===e.ownerDocument.documentElement)t.unshift(n);else{let s=1;for(let t=e.previousElementSibling;t;t=t.previousElementSibling)t.tagName.toLowerCase()===n&&s++;t.unshift(`${n}:nth-of-type(${s})`)}e=e.parentNode}return t.join(" > ")}(e)||""}(t)}(o,r):"",h,m),!0)}a=null})};e.nodes.attachNodeCallback(e=>{R_(e)&&m(e)}),m(document,!0),e.ticker.attach(f,t?.trackingOffset||7)}function GS(e){return Math.round(1e4*e)}function XS(e,t){let n=WS.get(t);if(n||(n=Object.create(null),WS.set(t,n)),e in n)return n[e];const s=1===t.querySelectorAll(`.${qS(e)}`).length;return n[e]=s,s}function YS(e){if(/^[a-z\-]{3,}$/i.test(e)){const t=e.split(/-|[A-Z]/);for(const e of t){if(e.length<=2)return!1;if(/[^aeiou]{4,}/i.test(e))return!1}return!0}return!1}function QS(e){if(!e.classList?.length||!e.parentNode)return null;const t=e.parentNode.children;e:for(const n of e.classList)if(YS(n)&&XS(n,e.ownerDocument)){for(const s of t)if(s!==e&&s.classList?.contains(n))continue e;return n}return null}let ZS=-1;const ew=e=>{addEventListener("pageshow",t=>{t.persisted&&(ZS=t.timeStamp,e(t))},!0)},tw=(e,t,n,s)=>{let r,o;return i=>{t.value>=0&&(i||s)&&(o=t.value-(r??0),(o||void 0===r)&&(r=t.value,t.delta=o,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,n),e(t)))}},nw=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},sw=()=>{const e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},rw=()=>{const e=sw();return e?.activationStart??0},ow=(e,t=-1)=>{const n=sw();let s="navigate";return ZS>=0?s="back-forward-cache":n&&(document.prerendering||rw()>0?s="prerender":document.wasDiscarded?s="restore":n.type&&(s=n.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:s}},iw=new WeakMap;function aw(e,t){return iw.get(e)||iw.set(e,new t),iw.get(e)}class cw{t;i=0;o=[];h(e){if(e.hadRecentInput)return;const t=this.o[0],n=this.o.at(-1);this.i&&t&&n&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}}const uw=(e,t,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const s=new PerformanceObserver(e=>{Promise.resolve().then(()=>{t(e.getEntries())})});return s.observe({type:e,buffered:!0,...n}),s}}catch{}},lw=e=>{let t=!1;return()=>{t||(e(),t=!0)}};let dw=-1;const pw=new Set,hw=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,fw=e=>{if("hidden"===document.visibilityState){if("visibilitychange"===e.type)for(const e of pw)e();isFinite(dw)||(dw="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("prerenderingchange",fw,!0))}},mw=()=>{if(dw<0){const e=rw(),t=document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(t=>"hidden"===t.name&&t.startTime>e)[0]?.startTime;dw=t??hw(),addEventListener("visibilitychange",fw,!0),addEventListener("prerenderingchange",fw,!0),ew(()=>{setTimeout(()=>{dw=hw()})})}return{get firstHiddenTime(){return dw},onHidden(e){pw.add(e)}}},gw=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},yw=[1800,3e3],bw=[.1,.25];let vw=0,_w=1/0,Sw=0;const ww=e=>{for(const t of e)t.interactionId&&(_w=Math.min(_w,t.interactionId),Sw=Math.max(Sw,t.interactionId),vw=Sw?(Sw-_w)/7+1:0)};let kw;const xw=()=>kw?vw:performance.interactionCount??0;let Tw=0;class Ew{u=[];l=new Map;m;p;v(){Tw=xw(),this.u.length=0,this.l.clear()}L(){const e=Math.min(this.u.length-1,Math.floor((xw()-Tw)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&"first-input"!==e.entryType)return;const t=this.u.at(-1);let n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>t.P){if(n?e.duration>n.P?(n.entries=[e],n.P=e.duration):e.duration===n.P&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],P:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort((e,t)=>t.P-e.P),this.u.length>10){const e=this.u.splice(10);for(const t of e)this.l.delete(t.id)}this.p?.(n)}}}const Iw=e=>{const t=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?e():(e=lw(e),addEventListener("visibilitychange",e,{once:!0,capture:!0}),t(()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})}))},Cw=[200,500];class Mw{m;h(e){this.m?.(e)}}const Rw=[2500,4e3],Ow=[800,1800],Aw=e=>{document.prerendering?gw(()=>Aw(e)):"complete"!==document.readyState?addEventListener("load",()=>Aw(e),!0):setTimeout(e)};function Nw(e,t){const n=Object.assign({captureResourceTimings:!0,capturePageLoadTimings:!0,capturePageRenderTimings:!0,excludedResourceUrls:[]},t);if("PerformanceObserver"in window||(n.captureResourceTimings=!1),!n.captureResourceTimings)return;let s={};function r(t){if(t.duration<0||!ov(t.name)||e.isServiceURL(t.name))return;null!==s&&(s[t.name]=t.startTime+t.duration);let r=!1;if(n.excludedResourceUrls?.forEach(e=>{t.name.startsWith(e)&&(r=!0)}),r)return;const o=n.resourceNameSanitizer?n.resourceNameSanitizer(t.name):t.name,i=t.responseStatus&&304===t.responseStatus||t.deliveryType&&"cache"===t.deliveryType||0===t.transferSize&&t.decodedBodySize>0,a=t.responseStatus&&t.responseStatus>=400?-111:t.decodedBodySize||0;e.send(Bv(t.startTime+tv(),t.duration,t.responseStart&&t.startTime?t.responseStart-t.startTime:0,t.transferSize>t.encodedBodySize?t.transferSize-t.encodedBodySize:0,t.encodedBodySize||0,a,e.sanitizer.privateMode?t.name.replaceAll(/./g,"*"):o,t.initiatorType,t.transferSize,i))}const o=new PerformanceObserver(e=>e.getEntries().forEach(r));function i(t){if(e.active())return e.send((n=t.name,s=String(t.value),[124,n,s]));var n,s}e.attachStartCallback(function({sessionID:e}){o.observe({type:"resource",buffered:!0}),((e,t={})=>{const n=mw();((e,t={})=>{gw(()=>{const n=mw();let s,r=ow("FCP");const o=uw("paint",e=>{for(const t of e)"first-contentful-paint"===t.name&&(o.disconnect(),t.startTime<n.firstHiddenTime&&(r.value=Math.max(t.startTime-rw(),0),r.entries.push(t),s(!0)))});o&&(s=tw(e,r,yw,t.reportAllChanges),ew(n=>{r=ow("FCP"),s=tw(e,r,yw,t.reportAllChanges),nw(()=>{r.value=performance.now()-n.timeStamp,s(!0)})}))})})(lw(()=>{let s,r=ow("CLS",0);const o=aw(t,cw),i=e=>{for(const t of e)o.h(t);o.i>r.value&&(r.value=o.i,r.entries=o.o,s())},a=uw("layout-shift",i);a&&(s=tw(e,r,bw,t.reportAllChanges),n.onHidden(()=>{i(a.takeRecords()),s(!0)}),ew(()=>{o.i=0,r=ow("CLS",0),s=tw(e,r,bw,t.reportAllChanges),nw(()=>s())}),setTimeout(s))}))})(i),((e,t={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const n=mw();gw(()=>{"interactionCount"in performance||kw||(kw=uw("event",ww,{type:"event",buffered:!0,durationThreshold:0}));let s,r=ow("INP");const o=aw(t,Ew),i=e=>{Iw(()=>{for(const t of e)o.h(t);const t=o.L();t&&t.P!==r.value&&(r.value=t.P,r.entries=t.entries,s())})},a=uw("event",i,{durationThreshold:t.durationThreshold??40});s=tw(e,r,Cw,t.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),n.onHidden(()=>{i(a.takeRecords()),s(!0)}),ew(()=>{o.v(),r=ow("INP"),s=tw(e,r,Cw,t.reportAllChanges)}))})})(i),((e,t={})=>{gw(()=>{const n=mw();let s,r=ow("LCP");const o=aw(t,Mw),i=e=>{t.reportAllChanges||(e=e.slice(-1));for(const t of e)o.h(t),t.startTime<n.firstHiddenTime&&(r.value=Math.max(t.startTime-rw(),0),r.entries=[t],s())},a=uw("largest-contentful-paint",i);if(a){s=tw(e,r,Rw,t.reportAllChanges);const n=lw(()=>{i(a.takeRecords()),a.disconnect(),s(!0)}),o=e=>{e.isTrusted&&(Iw(n),removeEventListener(e.type,o,{capture:!0}))};for(const e of["keydown","click","visibilitychange"])addEventListener(e,o,{capture:!0});ew(n=>{r=ow("LCP"),s=tw(e,r,Rw,t.reportAllChanges),nw(()=>{r.value=performance.now()-n.timeStamp,s(!0)})})}})})(i),((e,t={})=>{let n=ow("TTFB"),s=tw(e,n,Ow,t.reportAllChanges);Aw(()=>{const r=sw();r&&(n.value=Math.max(r.responseStart-rw(),0),n.entries=[r],s(!0),ew(()=>{n=ow("TTFB",0),s=tw(e,n,Ow,t.reportAllChanges),s(!0)}))})})(i)}),e.attachStopCallback(function(){o.disconnect()});let a=0,c=0;if(n.capturePageLoadTimings){let t=!1;e.ticker.attach(()=>{if(!t&&(0!==a&&0!==c||performance.getEntriesByType("paint").forEach(e=>{const{name:t,startTime:n}=e;switch(t){case"first-paint":a=n;break;case"first-contentful-paint":c=n}}),performance.timing.loadEventEnd||performance.now()>3e4)){t=!0;const{navigationStart:n,requestStart:s,responseStart:r,responseEnd:o,domContentLoadedEventStart:i,domContentLoadedEventEnd:u,loadEventStart:l,loadEventEnd:d}=performance.timing;e.send(function(e,t,n,s,r,o,i,a,c){return[23,e,t,n,s,r,o,i,a,c]}(s-n||0,r-n||0,o-n||0,i-n||0,u-n||0,l-n||0,d-n||0,a,c))}},30)}if(n.capturePageRenderTimings){let t=0,n=0,r=0,o=null,i=!1;e.ticker.attach(()=>{if(i)return;const u=performance.now();if(null!==s&&(t=Math.max.apply(null,Object.keys(s).map(e=>s[e])),u-t>1e3&&(o=function(e){const t=[],n=document.getElementsByTagName("*"),s=/url\(("[^"]*"|'[^']*'|[^)]*)\)/i;for(let r=0;r<n.length;r++){const o=n[r];let i="";if(A_(o,"img")&&(i=o.currentSrc||o.src),!i){const e=getComputedStyle(o).getPropertyValue("background-image");if(e){const t=s.exec(e);null!==t&&(i=t[1],(i.startsWith('"')||i.startsWith("'"))&&(i=i.substr(1,i.length-2)))}}if(!i)continue;const a="data:image"===i.substr(0,10)?0:e[i];if(void 0===a)continue;const c=o.getBoundingClientRect(),u=Math.max(c.top,0),l=Math.max(c.left,0),d=Math.min(c.bottom,window.innerHeight||document.documentElement&&document.documentElement.clientHeight||0),p=Math.min(c.right,window.innerWidth||document.documentElement&&document.documentElement.clientWidth||0);if(d<=u||p<=l)continue;const h=(d-u)*(p-l);t.push({time:a,area:h})}return t}(s),s=null)),null!==r&&(u-r>50&&(n=u),r=u-n>5e3?null:u),null!==o&&null===r||u>3e4){i=!0,s=null;const u=null===o?0:function(e,t){let n=Math.max(document.documentElement&&document.documentElement.clientWidth||0,window.innerWidth||0)*Math.max(document.documentElement&&document.documentElement.clientHeight||0,window.innerHeight||0)/10,s=n*e;for(let r=0;r<t.length;r++){const{time:o,area:i}=t[r];n+=i,s+=i*(o>e?o:e)}return 0===n?0:s/n}(c||a,o),{domContentLoadedEventEnd:l,navigationStart:d}=performance.timing,p=null===r?Math.max(n,c,l-d||0):0;e.send(function(e,t,n){return[24,e,t,n]}(u,c>t?c:t,p))}})}}function Dw(e){const t=e.defaultView;return[t&&t.scrollX||e.documentElement&&e.documentElement.scrollLeft||e.body&&e.body.scrollLeft||0,t&&t.scrollY||e.documentElement&&e.documentElement.scrollTop||e.body&&e.body.scrollTop||0]}const Lw={checkCssInterval:200,scanInMemoryCSS:!1,checkLimit:void 0};const Pw=new Set(["password","pass","pwd","mdp","token","bearer","jwt","api_key","api-key","apiKey","secret","ssn","zip","zipcode","x-api-key","www-authenticate","x-csrf-token","x-requested-with","x-forwarded-for","x-real-ip","cookie","authorization","auth","proxy-authorization","set-cookie","account_key"]);function Fw(e){if("number"==typeof e){const t=function(e){return 1+(0|Math.log10((e^e>>31)-(e>>31)))}(e);return"9".repeat(t)}return"string"==typeof e?e.replace(/[^\f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff\s]/g,"*"):e}function $w(e){const t={};if(Array.isArray(e))e.forEach(({name:e,value:n})=>{Pw.has(e.toLowerCase())?t[e]=Fw(n):t[e]=n});else for(const[n,s]of Object.entries(e))Pw.has(n.toLowerCase())?t[n]=Fw(s):t[n]=s;return t}function jw(e){if(!e)return e;let t,n=!1;try{t=JSON.parse(e),n=!0}catch(e){}if(n)return Bw(t),JSON.stringify(t);if("string"!=typeof e||!e.includes("?")||!e.includes("="))return e;try{const t=new URLSearchParams(e);for(const e of t.keys())if(Pw.has(e.toLowerCase())){const n=Fw(t.get(e));t.set(e,n)}return t.toString()}catch(t){return e}}function Bw(e){if(Array.isArray(e))e.forEach(Bw);else if(e&&"object"==typeof e)for(const t in e)Object.hasOwn(e,t)&&(Pw.has(t.toLowerCase())?e[t]=Fw(e[t]):null!==e[t]&&"object"==typeof e[t]&&Bw(e[t]))}function Uw(e){if(!e)return"";try{const t=new URL(e);if(t.searchParams)for(const e of t.searchParams.keys())Pw.has(e.toLowerCase())&&t.searchParams.set(e,"******");return t.toString()}catch(t){return e}}class Hw{constructor(e=[],t,n){this.ignoredHeaders=e,this.setSessionTokenHeader=t,this.sanitize=n,this.id="",this.name="",this.method="",this.url="",this.status=0,this.statusText="",this.cancelState=0,this.readyState=0,this.header={},this.responseType="",this.requestType="xhr",this.requestHeader={},this.responseSize=0,this.responseSizeText="",this.startTime=0,this.endTime=0,this.duration=0,this.getData={},this.requestData=null}getMessage(){const{reqHs:e,resHs:t}=this.writeHeaders(),n="GET"===this.method?JSON.stringify((Bw(s=this.getData),s)):jw(this.requestData);var s;const r={headers:$w(e),body:n},o={headers:$w(t),body:jw(this.response)},i=this.sanitize({url:Uw(this.url),method:this.method,status:this.status,request:r,response:o});if(!i)return null;const a=i.url.includes("/graphql")||Object.values(i.request.headers).some(e=>e.includes("application/graphql-response"));if(a&&i.response.body&&"string"==typeof i.response.body){const e=i.response.body.includes("errors");i.status=e?400:200,this.requestType="graphql"}return{requestType:this.requestType,method:i.method,url:i.url,request:JSON.stringify(i.request),response:JSON.stringify(i.response),status:i.status,startTime:this.startTime,duration:this.duration,responseSize:this.responseSize}}writeHeaders(){const e={};Object.entries(this.requestHeader).forEach(([t,n])=>{this.isHeaderIgnored(t)||(e[t]=n)}),this.setSessionTokenHeader((t,n)=>{e[t]=n});const t={};return Object.entries(this.header).forEach(([e,n])=>{this.isHeaderIgnored(e)||(t[e]=n)}),{reqHs:e,resHs:t}}isHeaderIgnored(e){return Array.isArray(this.ignoredHeaders)?this.ignoredHeaders.map(e=>e.toLowerCase()).includes(e.toLowerCase()):this.ignoredHeaders}}const zw=(e,t)=>{let n="";switch(e){case"":case"text":case"json":"string"==typeof t?n=t:Ww(t)||Array.isArray(t)?n=JSON.stringify(t):void 0!==t&&(n=Object.prototype.toString.call(t));break;default:void 0!==t&&(n=Object.prototype.toString.call(t))}return n},qw=e=>{if(!e)return null;let t;try{if("string"==typeof e){"{"!==e[0]&&"["!==e[0]||(t=e);const n=e.split("&");t=1===n.length?e:n.join(",")}else if(null==(n=e)||ArrayBuffer.isView(n)||"undefined"==typeof Symbol||"function"!=typeof n[Symbol.iterator])t=e instanceof Blob||e instanceof ReadableStream||e instanceof ArrayBuffer?"byte data":Ww(e)?e:"can't parse body "+typeof e;else{const n=[];for(const[t,s]of e)n.push(`${t}=${"string"==typeof s?s:"[object Object]"}`);t=n.join(",")}return t}catch(e){return"can't parse body"}var n};function Ww(e){return null!==e&&"object"==typeof e}function Vw(e){return e<=0?"":e>=1e6?(e/1e3/1e3).toFixed(1)+" MB":e>=1e3?(e/1e3).toFixed(1)+" KB":`${e}B`}const Jw=e=>(e.startsWith("//")&&(e=`${new URL(window.location.href).protocol}${e}`),e.startsWith("http")?new URL(e):new URL(e,window.location.href)),Kw=e=>e instanceof Blob?e.type:e instanceof FormData?"multipart/form-data":e instanceof URLSearchParams?"application/x-www-form-urlencoded;charset=UTF-8":"text/plain;charset=UTF-8";class Gw{constructor(e,t,n,s,r){this.ignoredHeaders=e,this.setSessionTokenHeader=t,this.sanitize=n,this.sendMessage=s,this.isServiceUrl=r}apply(e,t,n){const s=n[0],r=n[1],o=new Hw(this.ignoredHeaders,this.setSessionTokenHeader,this.sanitize);if(this.isServiceUrl(s))return e.apply(t,n);const i=Jw(s);if(o.method="POST",o.url=s,o.name=(i.pathname.split("/").pop()||"")+i.search,o.requestType="beacon",o.requestHeader={"Content-Type":Kw(r)},o.status=0,o.statusText="Pending",i.search&&i.searchParams){o.getData={};for(const[e,t]of i.searchParams)o.getData[e]=t}o.requestData=qw(r),o.startTime||(o.startTime=performance.now());const a=e.apply(t,n);a?(o.endTime=performance.now(),o.duration=o.endTime-(o.startTime||o.endTime),o.status=0,o.statusText="Sent",o.readyState=4):(o.status=500,o.statusText="Unknown");const c=o.getMessage();return c&&this.sendMessage(c),a}}class Xw{static create(e,t,n,s,r,o){if(e)return new Proxy(e,new Gw(t,n,s,r,o))}}class Yw{constructor(e,t){this.resp=e,this.item=t}set(e,t,n){return Reflect.set(e,t,n)}get(e,t){const n=Reflect.get(e,t);if("arrayBuffer"===t||"blob"===t)return"function"==typeof n?n.bind(e):n;switch(t){case"formData":case"json":case"text":return()=>(this.item.responseType=t.toLowerCase(),n.apply(e).then(e=>(this.item.response=zw(this.item.responseType,e),e)))}return"function"==typeof n?n.bind(e):n}}class Qw{constructor(e,t,n,s,r,o){this.ignoredHeaders=e,this.setSessionTokenHeader=t,this.sanitize=n,this.sendMessage=s,this.isServiceUrl=r,this.tokenUrlMatcher=o}apply(e,t,n){var s;const r=n[0],o=n[1];if(!r||"string"!=typeof r&&!(null==r?void 0:r.url))return e.apply(window,n);if(r instanceof URL||"string"==typeof r?this.isServiceUrl(String(r)):this.isServiceUrl(String(r.url)))return e.apply(window,n);const i=new Hw(this.ignoredHeaders,this.setSessionTokenHeader,this.sanitize);this.beforeFetch(i,r,o);const a=(n[0]instanceof Request?n[0].signal:void 0)||(null===(s=n[1])||void 0===s?void 0:s.signal);let c=!1;const u=()=>{if(c)return;c=!0,i.endTime=performance.now(),i.duration=i.endTime-(i.startTime||i.endTime),i.status=0,i.statusText="Aborted",i.readyState=0;const e=i.getMessage();e&&this.sendMessage(e)};return a&&(a.aborted?u():a.addEventListener("abort",u,{once:!0})),this.setSessionTokenHeader((e,t)=>{if(void 0===this.tokenUrlMatcher||this.tokenUrlMatcher(i.url))return void 0===n[1]&&n[0]instanceof Request?n[0].headers.append(e,t):(n[1]||(n[1]={}),void 0===n[1].headers&&(n[1]=Object.assign(Object.assign({},n[1]),{headers:{}})),void(n[1].headers instanceof Headers?n[1].headers.append(e,t):Array.isArray(n[1].headers)?n[1].headers.push([e,t]):n[1].headers[e]=t))}),e.apply(window,n).then(this.afterFetch(i,()=>{c=!0})).catch(e=>{if(i.endTime=performance.now(),i.duration=i.endTime-(i.startTime||i.endTime),e&&"AbortError"===e.name&&(i.status=0,i.statusText="Aborted",i.readyState=0,!c)){const e=i.getMessage();e&&this.sendMessage(e)}throw e})}beforeFetch(e,t,n){let s,r="GET",o={};if("string"==typeof t?(r=(null==n?void 0:n.method)||"GET",s=Jw(t),o=(null==n?void 0:n.headers)||{}):(r=t.method||"GET",s=Jw(t.url),o=t.headers),e.method=r,e.requestType="fetch",e.requestHeader=o,e.url=s.toString(),e.name=(s.pathname.split("/").pop()||"")+s.search,e.status=0,e.statusText="Pending",e.readyState=1,e.startTime||(e.startTime=performance.now()),"[object Headers]"===Object.prototype.toString.call(o)){e.requestHeader={};for(const[t,n]of o)e.requestHeader[t]=n}else e.requestHeader=o;if(s.search&&s.searchParams){e.getData={};for(const[t,n]of s.searchParams)e.getData[t]=n}(null==n?void 0:n.body)&&(e.requestData=qw(n.body))}afterFetch(e,t){return n=>{t&&(null==t||t()),e.endTime=performance.now(),e.duration=e.endTime-(e.startTime||e.endTime),e.status=n.status,e.statusText=String(n.status);let s=!1;e.header={};for(const[t,r]of n.headers)e.header[t]=r,s=r.toLowerCase().indexOf("chunked")>-1||s;s?e.readyState=3:(e.readyState=4,this.handleResponseBody(n.clone(),e).then(t=>{e.responseSize="string"==typeof t?t.length:t.byteLength,e.responseSizeText=Vw(e.responseSize),e.response=zw(e.responseType,t);const n=e.getMessage();n&&this.sendMessage(n)}).catch(t=>{if("AbortError"!==t.name)throw t;{e.status=0,e.statusText="Aborted",e.readyState=0;const t=e.getMessage();t&&this.sendMessage(t)}}));const r=(n.headers.get("content-type")||"").toLowerCase();return r.includes("application/json")||r.startsWith("text/")?new Proxy(n,new Yw(n,e)):n}}handleResponseBody(e,t){const n=e.headers.get("content-type");return n&&n.includes("application/json")?(t.responseType="json",e.text()):n&&(n.includes("text/html")||n.includes("text/plain"))?(t.responseType="text",e.text()):(t.responseType="arraybuffer",e.arrayBuffer())}}class Zw{static create(e,t,n,s,r,o){return new Proxy(fetch,new Qw(e,t,n,s,r,o))}}var ek;!function(e){e[e.UNSENT=0]="UNSENT",e[e.OPENED=1]="OPENED",e[e.HEADERS_RECEIVED=2]="HEADERS_RECEIVED",e[e.LOADING=3]="LOADING",e[e.DONE=4]="DONE"}(ek||(ek={}));class tk{constructor(e,t,n,s,r,o,i){this.ignoredHeaders=t,this.setSessionTokenHeader=n,this.sanitize=s,this.sendMessage=r,this.isServiceUrl=o,this.tokenUrlMatcher=i,this.XMLReq=e,this.XMLReq.onreadystatechange=()=>{this.onReadyStateChange()},this.XMLReq.onabort=()=>{this.onAbort()},this.XMLReq.ontimeout=()=>{this.onTimeout()},this.item=new Hw(t,n,s),this.item.requestType="xhr"}get(e,t){switch(t){case"open":return this.getOpen(e);case"send":return this.setSessionTokenHeader((t,n)=>{(void 0===this.tokenUrlMatcher||this.tokenUrlMatcher(this.item.url))&&1===e.readyState&&e.setRequestHeader(t,n)}),this.getSend(e);case"setRequestHeader":return this.getSetRequestHeader(e);default:const n=Reflect.get(e,t);return"function"==typeof n?n.bind(e):n}}set(e,t,n){switch(t){case"onreadystatechange":return this.setOnReadyStateChange(e,t,n);case"onabort":return this.setOnAbort(e,t,n);case"ontimeout":return this.setOnTimeout(e,t,n)}return Reflect.set(e,t,n)}onReadyStateChange(){if(this.item.url&&this.isServiceUrl(this.item.url))return;this.item.readyState=this.XMLReq.readyState,this.item.responseType=this.XMLReq.responseType,this.item.endTime=performance.now(),this.item.duration=this.item.endTime-this.item.startTime,this.updateItemByReadyState();const e=this.item.responseType||"";if(""!==e&&"text"!==e&&"json"!==e||setTimeout(()=>{this.item.response=zw(e,this.XMLReq.response)},0),this.XMLReq.readyState===ek.DONE){const e=this.item.getMessage();e&&this.sendMessage(e)}}onAbort(){this.item.cancelState=1,this.item.statusText="Abort";const e=this.item.getMessage();e&&this.sendMessage(e)}onTimeout(){this.item.cancelState=3,this.item.statusText="Timeout";const e=this.item.getMessage();e&&this.sendMessage(e)}getOpen(e){const t=Reflect.get(e,"open");return(...n)=>{var s,r,o;const i=n[0],a=n[1];return this.item.method=i?i.toUpperCase():"GET",this.item.url=(null===(s=a.toString)||void 0===s?void 0:s.call(a))||"",this.item.name=null!==(o=null===(r=this.item.url)||void 0===r?void 0:r.replace(new RegExp("/*$"),"").split("/").pop())&&void 0!==o?o:"",this.item.getData=((e,t={})=>{Ww(t)||(t={});let n=e?e.split("?"):[];if(n.shift(),n.length>0){n=n.join("?").split("&");for(const e of n){const n=e.split("=");try{t[n[0]]=decodeURIComponent(n[1])}catch(e){t[n[0]]=n[1]}}}return t})(this.item.url,{}),t.apply(e,n)}}getSend(e){const t=Reflect.get(e,"send");return(...n)=>{const s=n[0];return this.item.requestData=qw(s),t.apply(e,n)}}getSetRequestHeader(e){const t=Reflect.get(e,"setRequestHeader");return(...n)=>(this.item.requestHeader||(this.item.requestHeader={}),this.item.requestHeader[n[0]]=n[1],t.apply(e,n))}setOnReadyStateChange(e,t,n){return Reflect.set(e,t,(...t)=>{this.onReadyStateChange(),null==n||n.apply(e,t)})}setOnAbort(e,t,n){return Reflect.set(e,t,(...t)=>{this.onAbort(),n.apply(e,t)})}setOnTimeout(e,t,n){return Reflect.set(e,t,(...t)=>{this.onTimeout(),n.apply(e,t)})}updateItemByReadyState(){switch(this.XMLReq.readyState){case ek.UNSENT:case ek.OPENED:this.item.status=ek.UNSENT,this.item.statusText="Pending",this.item.startTime||(this.item.startTime=performance.now());break;case ek.HEADERS_RECEIVED:this.item.status=this.XMLReq.status,this.item.statusText="Loading",this.item.header={};const e=(this.XMLReq.getAllResponseHeaders()||"").split("\n");for(let t=0;t<e.length;t++){const n=e[t];if(!n)continue;const s=n.split(": "),r=s[0];this.item.header[r]=s.slice(1).join(": ")}break;case ek.LOADING:this.item.status=this.XMLReq.status,this.item.statusText="Loading";const t=this.XMLReq.response;if(t){const e="string"==typeof t?t.length:t instanceof ArrayBuffer?t.byteLength:"undefined"!=typeof Blob&&t instanceof Blob?t.size:0;e&&(this.item.responseSize=e,this.item.responseSizeText=Vw(this.item.responseSize))}break;case ek.DONE:this.item.status=this.XMLReq.status||this.item.status||0,this.item.statusText=String(this.item.status),this.item.endTime=performance.now(),this.item.duration=this.item.endTime-(this.item.startTime||this.item.endTime);const n=this.XMLReq.response,s=this.XMLReq.responseType||"";if(""!==s&&"text"!==s&&"json"!==s||(this.item.response=n),n){const e="string"==typeof n?n.length:n instanceof ArrayBuffer?n.byteLength:"undefined"!=typeof Blob&&n instanceof Blob?n.size:0;e&&(this.item.responseSize=e,this.item.responseSizeText=Vw(e))}break;default:this.item.status=this.XMLReq.status,this.item.statusText="Unknown"}}}class nk{static create(e,t,n,s,r,o){return new Proxy(XMLHttpRequest,{construct(i){const a=new i;return new Proxy(a,new tk(a,e,t,n,s,r,o))}})}}const sk=e=>{const t=`Openreplay: Can't find ${e} in global context.`;console.warn(t)},rk=Symbol("OpenReplayProxyOriginal"),ok=e=>(e=>!!e&&void 0!==e[rk])(e)?e[rk]:e,ik=(e,t)=>(e[rk]=t,e);function ak(e){return e.__or_req_data__||(e.__or_req_data__={body:void 0,headers:{}}),e.__or_req_data__}function ck(e){return"string"==typeof e?e.toUpperCase():"GET"}function uk(e,t={}){if(t.disabled)return;const n=Object.assign({failuresOnly:!1,ignoreHeaders:["cookie","set-cookie","authorization"],capturePayload:!1,sessionTokenHeader:!1,captureInIframes:!0,axiosInstances:void 0,useProxy:!0},t);!1===n.useProxy&&e.debug.warn("Network module is migrating to proxy api, to gradually migrate and test it set useProxy to true");const s=n.ignoreHeaders,r=Array.isArray(s)?e=>s.includes(e):()=>s,o=!0===n.sessionTokenHeader?"X-OpenReplay-SessionToken":n.sessionTokenHeader;function i(t){if(o){const n=e.getSessionToken();n&&e.safe(t)(o,n)}}function a(t){if(n.capturePayload&&!e.sanitizer.privateMode||(delete t.request.body,delete t.response.body),n.sanitizer){const e=t.response.body;if("string"==typeof e)try{t.response.body=JSON.parse(e)}catch{}return n.sanitizer(t)}return t}function c(t){if(t&&"string"!=typeof t.body)try{t.body=JSON.stringify(t.body)}catch{t.body="<unable to stringify>",e.notify.warn("Openreplay fetch couldn't stringify body:",t.body)}return JSON.stringify(t)}const u=t=>{if(n.useProxy)return function(e,t,n,s,r,o,i={xhr:!0,fetch:!0,beacon:!0},a){var c;if(e){if(i.xhr){const i=ok(e.XMLHttpRequest);i?e.XMLHttpRequest=ik(nk.create(t,n,s,r,o,a),i):sk("XMLHttpRequest")}if(i.fetch){const i=ok(e.fetch);i?e.fetch=ik(Zw.create(t,n,s,r,o,a),i):sk("fetch")}if(i.beacon&&(null===(c=e.navigator)||void 0===c?void 0:c.sendBeacon)){const i=ok(e.navigator.sendBeacon);e.navigator.sendBeacon=ik(Xw.create(i,t,n,s,r,o),i)}}}(t,!!e.sanitizer.privateMode||n.ignoreHeaders,i,a,t=>{if(n.failuresOnly&&t.status<400)return;const s=e.sanitizer.privateMode?"************":t.url;e.send(Fv(t.requestType,t.method,s,t.request,t.response,t.status,t.startTime+tv(),t.duration,t.responseSize))},t=>e.isServiceURL(t),{xhr:!0,fetch:!0,beacon:!0},n.tokenUrlMatcher);const o=t.fetch.bind(t);t.fetch=(t,u={})=>{if(!("string"==typeof t||t instanceof URL)||e.isServiceURL(String(t)))return o(t,u);i(function(e,t){void 0===u.headers&&(u.headers={}),u.headers instanceof Headers?u.headers.append(e,t):Array.isArray(u.headers)?u.headers.push([e,t]):u.headers[e]=t});const l=performance.now();return o(t,u).then(o=>{const i=performance.now()-l;if(n.failuresOnly&&o.status<400)return o;const d=o.clone();return d.text().then(n=>{const o={},p={};if(!0!==s){const e=([e,t])=>{r(e)||(o[e]=t)};u.headers instanceof Headers?u.headers.forEach((t,n)=>e([n,t])):Array.isArray(u.headers)?u.headers.forEach(e):"object"==typeof u.headers&&Object.entries(u.headers).forEach(e),d.headers.forEach((e,t)=>{r(t)||(p[t]=e)})}const h=ck(u.method),f=a({url:String(t),method:h,status:d.status,request:{headers:o,body:u.body||null},response:{headers:p,body:n}});f&&e.send(Fv("fetch",h,String(f.url),c(f.request),c(f.response),d.status,l+tv(),i,0))}).catch(t=>e.debug.error("Could not process Fetch response:",t)),o})};const u=t.XMLHttpRequest.prototype.open,l=t.XMLHttpRequest.prototype.setRequestHeader,d=t.XMLHttpRequest.prototype.send;n.axiosInstances||(t.XMLHttpRequest.prototype.open=function(t,n){const s=this;i((e,t)=>s.setRequestHeader(e,t));let o=0;return s.addEventListener("loadstart",e=>{o=e.timeStamp}),s.addEventListener("load",e.safe(i=>{const{headers:u,body:l}=ak(s),d=o>0?i.timeStamp-o:0,p=(s.getAllResponseHeaders()||"").trim().split(/[\r\n]+/),h={};p.forEach(function(e){const t=e.split(": "),n=t.shift();r(n)||(h[n]=t.join(": "))});const f=ck(t),m=a({url:String(n),method:f,status:s.status,request:{headers:u,body:l||null},response:{headers:h,body:s.response}});m&&e.send(Fv("xhr",f,String(m.url),c(m.request),c(m.response),s.status,o+tv(),d,0))})),u.apply(this,arguments)},t.XMLHttpRequest.prototype.send=function(e){return ak(this).body=e,d.apply(this,arguments)},t.XMLHttpRequest.prototype.setRequestHeader=function(e,t){return r(e)||(ak(this).headers[e]=t),l.apply(this,arguments)})};u(window),n.axiosInstances&&n.axiosInstances.forEach(t=>{!function(e,t,n,s,r){function o(t){e.debug.log("Openreplay: capturing axios response data",t);const{headers:o,data:i,method:a,url:c,baseURL:u}=t.config,{data:l,headers:d,status:p,response:h}=t,{data:f,headers:m,status:g}=h||{},y=n.ignoreHeaders,b=Array.isArray(y)?e=>y.includes(e):()=>y;function v(e,t){b(t[0])||(e[t[0]]=t[1])}let _={},S={};o.toJSON?_=o.toJSON():o instanceof Headers?o.forEach((e,t)=>v(_,[t,e])):Array.isArray(o)?o.forEach(e=>v(_,e)):"object"==typeof o&&Object.entries(o).forEach(e=>v(_,e));const w=m||d;w.toJSON?S=w.toJSON():w instanceof Headers?w.forEach((e,t)=>v(S,[t,e])):Array.isArray(w)?w.forEach(e=>v(S,e)):"object"==typeof w&&Object.entries(w).forEach(([e,t])=>{b(e)||(S[e]=t)});const k=s({url:c,method:a||"",status:p||g||0,request:{headers:_,body:i},response:{headers:S,body:f||l}});if(!k)return void e.debug.log("Openreplay: empty request/response info, skipping");const x=t.config.__openreplay_timing,T=performance.now()-x;e.debug.log("Openreplay: final req object",k),e.send(Fv("xhr",String(a),String(k.url),r(k.request),r(k.response),k.status,x+tv(),T,0))}e.debug.log("Openreplay: attaching axios spy to instance",t);const i=t.interceptors.request.use(function(t){if(e.debug.log("Openreplay: capturing API request",t),t.__openreplay_timing=performance.now(),n.sessionTokenHeader){const s="string"==typeof n.sessionTokenHeader?n.sessionTokenHeader:"X-OpenReplay-Session-Token",r=e.getSessionToken();r&&t.headers.set(s,r)}return t},function(t){e.debug.log("Openreplay: failed API request, skipping",t)},{synchronous:!0}),a=t.interceptors.response.use(function(e){return n.failuresOnly||o(e),e},function(t){var n,s;return e.debug.log("Openreplay: capturing API request error",t),null!==(s=n=t)&&"object"==typeof s&&!0===n.isAxiosError&&Boolean(t.response)?o(t.response):t instanceof Error&&e.send($S(t,[])),Promise.reject(t)},{synchronous:!0});e.attachStopCallback(()=>{t.interceptors.request.eject?.(i),t.interceptors.response.eject?.(a)})}(e,t,n,a,c)}),n.captureInIframes&&e.observer.attachContextCallback(e.safe(u))}const lk="/en/sdk/constructor";class dk{constructor(e){if(this.options=e,this.app=null,this.crossdomainMode=!1,this.checkDoNotTrack=()=>this.options.respectDoNotTrack&&("1"==navigator.doNotTrack||"1"==window.doNotTrack),this.signalStartIssue=(e,t)=>{const n=this.checkDoNotTrack();console.log("Tracker couldn't start due to:",JSON.stringify({trackerVersion:"16.4.10",projectKey:this.options.projectKey,doNotTrack:n,reason:t.length?`missing api: ${t.join(",")}`:e}))},this.restartCanvasTracking=()=>{null!==this.app&&this.app.restartCanvasTracking()},this.handleError=(e,t={})=>{if(null!==this.app)if(e instanceof Error){const n=$S(e,[],t);this.app.send(n)}else if(e instanceof ErrorEvent||"PromiseRejectionEvent"in window&&e instanceof PromiseRejectionEvent){const n=jS(e,void 0,t);null!=n&&this.app.send(n)}},this.crossdomainMode=Boolean(hv()&&e.crossdomain?.enabled),!Yb||!function(e){if(null==e)return console.error(`OpenReplay: invalid options argument type. Please, check documentation on ${iv}${lk}`),!1;if("string"!=typeof e.projectKey)if("number"!=typeof e.projectKey){if("number"!=typeof e.projectID)return console.error(`OpenReplay: projectKey is missing or wrong type (string is expected). Please, check ${iv}${lk} for more information.`),!1;e.projectKey=e.projectID.toString(),cv("`projectID` option","`projectKey` option",lk)}else console.warn("OpenReplay: projectKey is expected to have a string type."),e.projectKey=e.projectKey.toString();return null!=e.sessionToken&&cv("`sessionToken` option","`sessionHash` start() option","/"),!0}(e))return;if(window.__OPENREPLAY__||!this.crossdomainMode&&hv()&&(()=>{try{return Boolean(window.top?.document)}catch{return!1}})()&&window.top.__OPENREPLAY__)return void console.error("OpenReplay: one tracker instance has been initialised already");if(!e.__DISABLE_SECURE_MODE&&"https:"!==location.protocol)return void console.error("OpenReplay: Your website must be publicly accessible and running on SSL in order for OpenReplay to properly capture and replay the user session. You can disable this check by setting `__DISABLE_SECURE_MODE` option to `true` if you are testing in localhost. Keep in mind, that asset files on a local machine are not available to the outside world. This might affect tracking if you use css files.");const t=[],n=["Map","Set","MutationObserver","performance","timing","startsWith","Blob","Worker"];if(this.checkDoNotTrack())t.push("doNotTrack");else for(const e of n)if("timing"===e){if("performance"in window&&!(e in performance)){t.push(e);break}}else if("startsWith"===e){if(!(e in String.prototype)){t.push(e);break}}else if(!(e in window)){t.push(e);break}if(t.length>0){const e=t.join(",");return console.error(`OpenReplay: browser doesn't support API required for tracking or doNotTrack is set to 1. Reason: ${e}`),void this.signalStartIssue("missing_api",t)}const s=new ES(e.projectKey,e.sessionToken,e,this.signalStartIssue,this.crossdomainMode);this.app=s,this.crossdomainMode||(function(e,t){let n,s,r,o,i=document.referrer;const a=t?.urlSanitizer||(e=>e),c=t?.titleSanitizer||(e=>e),u=e.safe(()=>{const{URL:t}=document;if(t!==n){n=t;const s=a(n),r=e.sanitizer.privateMode?rS(document.title):c(document.title),u=e.sanitizer.privateMode?rS(s):s,l=e.sanitizer.privateMode?rS(i):i;e.send(function(e,t,n,s){return[122,e,t,n,s]}(u,l,o,r)),o=0,i=n}}),l=e.safe(()=>{const{innerWidth:t,innerHeight:n}=window;t===s&&n===r||(s=t,r=n,e.send(function(e,t){return[5,e,t]}(s,r)))}),d=void 0===document.hidden?Function.prototype:e.safe(()=>e.send([55,document.hidden]));e.attachStartCallback(()=>{n=null,o=tv(),s=r=-1,u(),l(),d()}),void 0!==document.hidden&&e.attachEventListener(document,"visibilitychange",d,!1,!1),e.ticker.attach(u,1,!1),e.ticker.attach(l,5,!1)}(s,e.urls),function(e){const t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(void 0===t)return;const n=()=>{return e.send((n=Math.round(1e3*t.downlink),s=t.type||"unknown",[54,n,s]));var n,s};n(),t.addEventListener("change",n)}(s),function(e,t){if(!Object.assign({capturePerformance:!0},t).capturePerformance)return;let n,s;const r=()=>{void 0!==n&&-1!==n&&(n++,requestAnimationFrame(r))};e.ticker.attach(()=>{void 0!==s&&-1!==s&&s++},0,!1);const o=()=>{void 0!==n&&void 0!==s&&(e.send(function(e,t,n,s){return[49,e,t,n,s]}(n,s,zv.memory.totalJSHeapSize||0,zv.memory.usedJSHeapSize||0)),s=n=document.hidden?-1:0)};e.attachStartCallback(()=>{s=n=-1,o(),r()}),e.attachStopCallback(()=>{s=n=void 0}),e.ticker.attach(o,165,!1),void 0!==document.hidden&&e.attachEventListener(document,"visibilitychange",o,!1,!1)}(s,e),function(e){e.attachEventListener(window,"focus",function(){document.hidden||(e.debug.log("Openreplay: tab change to"+e.session.getTabId()),e.send(Uv(e.session.getTabId())))},!1,!1)}(s)),KS(s,e.mouse),function(e,t){let n=!1;const s=new Map;function r(e){E_(e)&&(C_(e)&&s.set(e,[e.scrollLeft,e.scrollTop]),R_(e)&&s.set(e,Dw(e)))}const o=e.safe(()=>{t||e.send(function(e,t){return[6,e,t]}(...Dw(document)))}),i=e.safe((t,n)=>{const s=e.nodes.getID(n);void 0!==s&&e.send(function(e,t,n){return[16,e,t,n]}(s,t[0],t[1]))});e.attachStartCallback(o),e.attachStopCallback(()=>{n=!1,s.clear()}),e.nodes.attachNodeCallback((t,n)=>{n&&(C_(t)&&t.scrollLeft+t.scrollTop>0?s.set(t,[t.scrollLeft,t.scrollTop]):R_(t)&&s.set(t,Dw(t))),O_(t)&&e.nodes.attachNodeListener(t,"scroll",e=>{r(e.target)})}),e.attachEventListener(document,"scroll",e=>{const t=e.target;t!==document?r(t):n=!0}),e.ticker.attach(()=>{n&&(o(),n=!1),s.forEach(i),s.clear()},5,!1)}(s,this.crossdomainMode),function(e,t){if(null===e)return;if(!window.CSSStyleSheet)return void e.send((n="no_stylesheet_prototype_in_window",s="",[63,n,s]));var n,s;const r={...Lw,...t},o=new Map;let i=null;const a=new Set,c=r.checkCssInterval||200;let u={};function l(){if(!r.scanInMemoryCSS)return;const t=a.values();for(const n of t)try{const t=z_.get(n);if(!t)continue;if(r.checkLimit&&(u[t]?u[t]++:u[t]=0,u[t]>r.checkLimit))return void a.delete(n);for(let s=0;s<n.cssRules.length;s++)try{const r=n.cssRules[s],i=`${t}:${s}`,a=o.get(i),c=r.cssText;a!==c&&(void 0!==a?(e.send(Nv(t,s)),e.send(Av(t,c,s,e.getBaseHref()))):e.send(Av(t,c,s,e.getBaseHref())),o.set(i,c))}catch(e){}const s=Array.from(o.keys()).filter(e=>e.startsWith(`${t}:`));for(const e of s)parseInt(e.split(":")[1],10)>=n.cssRules.length&&o.delete(e)}catch(e){a.delete(n)}}const d=/{\s*}/;function p(e){return d.test(e)}const h=e.safe((t,n,s)=>{const r=z_.get(t);r&&("string"==typeof s?(e.send(Av(r,s,n,e.getBaseHref())),p(s)&&(o.set(`${r}:${n}`,s),a.add(t))):(e.send(Nv(r,n)),o.has(`${r}:${n}`)&&o.delete(`${r}:${n}`)))}),f=e.safe(t=>{let n=t;for(;n.parentRule;)n=n.parentRule;const s=n.parentStyleSheet;if(!s)return;const r=z_.get(s);if(!r)return;const i=n.cssText,c=Array.from(s.cssRules).indexOf(n);c>=0&&(e.send(Av(r,i,c,e.getBaseHref())),e.send(Nv(r,c+1)),p(i)&&(o.set(`${r}:${c}`,i),a.add(s)))}),m=e.safe(e=>{if(e.__css_tracking_patched__)return;e.__css_tracking_patched__=!0;const{insertRule:t,deleteRule:n}=e.CSSStyleSheet.prototype,{insertRule:s,deleteRule:r}=e.CSSGroupingRule.prototype;e.CSSStyleSheet.prototype.insertRule=function(e,n=0){const s=t.call(this,e,n);return h(this,s,e),s},e.CSSStyleSheet.prototype.deleteRule=function(e){return h(this,e),n.call(this,e)},e.CSSGroupingRule.prototype.insertRule=function(e,t=0){const n=s.call(this,e,t);return f(this),n},e.CSSGroupingRule.prototype.deleteRule=function(e){const t=r.call(this,e);return f(this),t}});m(window),e.observer.attachContextCallback(m),e.nodes.attachNodeCallback(t=>{if(!A_(t,"style")||!t.sheet)return;if(null!==t.textContent&&t.textContent.trim().length>0)return;const n=e.nodes.getID(t);if(!n)return;const s=t.sheet,r=H_();z_.set(s,r),e.send(Dv(r,n));for(let e=0;e<s.cssRules.length;e++)try{h(s,e,s.cssRules[e].cssText)}catch(e){}}),setTimeout(function(){!i&&r.scanInMemoryCSS&&(i=window.setInterval(l,c))},50),e.attachStopCallback(()=>{i&&(clearInterval(i),i=null),o.clear()})}(s,e.css),function(e){if(null===e)return;if(!B_(document))return;const t=new Map,n=new Map,s=s=>setTimeout(()=>{let r=e.nodes.getID(s);if(s===document&&(r=0),void 0===r)return;let o=n.get(r);o||(o=[]);const i=[],a=s.adoptedStyleSheets;if(a&&Symbol.iterator in a)for(const n of a){let s=t.get(n);const a=!s;if(s||(s=H_(),t.set(n,s)),o.includes(s)||e.send(Dv(s,r)),a){const t=n.cssRules;for(let n=0;n<t.length;n++)e.send(Av(s,t[n].cssText,n,e.getBaseHref()))}i.push(s)}if(Symbol.iterator in o)for(const t of o)i.includes(t)||e.send(Lv(t,r));n.set(r,i)},20);function r(e){const t=Object.getOwnPropertyDescriptor(e,"adoptedStyleSheets");t&&Object.defineProperty(e,"adoptedStyleSheets",{...t,set:function(e){const n=t.set.call(this,e);return s(this),n}})}const o=n=>{if(n.__openreplay_adpss_patched__)return;n.__openreplay_adpss_patched__=!0,r(n.Document.prototype),r(n.ShadowRoot.prototype);const{replace:s,replaceSync:o}=n.CSSStyleSheet.prototype;n.CSSStyleSheet.prototype.replace=function(n){return s.call(this,n).then(s=>{const r=t.get(this);return r&&e.send(Ov(r,n,e.getBaseHref())),s})},n.CSSStyleSheet.prototype.replaceSync=function(n){const s=t.get(this);return s&&e.send(Ov(s,n,e.getBaseHref())),o.call(this,n)}};o(window),e.observer.attachContextCallback(e.safe(o)),e.attachStopCallback(()=>{t.clear(),n.clear()}),e.attachStartCallback(()=>{s(document)}),e.nodes.attachNodeCallback(e=>{B_(e)&&s(e)})}(s),OS(s,e),function(e,t){function n(t){function n(n){const s=jS(n,t);null!=s&&e.send(s)}try{e.attachEventListener(t,"unhandledrejection",n),e.attachEventListener(t,"error",n)}catch(e){console.error("Error while attaching to error proto contexts",e)}}Object.assign({captureExceptions:!0},t).captureExceptions&&(e.observer.attachContextCallback(n),n(window))}(s,e),function(e){function t(t,n){e.attributeSender.sendSetAttribute(t,"src","https://static.openreplay.com/tracker/placeholder.jpeg");const{width:s,height:r}=n.getBoundingClientRect();n.hasAttribute("width")||e.attributeSender.sendSetAttribute(t,"width",String(s)),n.hasAttribute("height")||e.attributeSender.sendSetAttribute(t,"height",String(r))}const n=function(t,n){const{srcset:s}=n;if(!s)return;const r=s.split(s.match(/,\s+/)?/,\s+/:",").map(e=>BS(e)).join(", ");e.attributeSender.sendSetAttribute(t,"srcset",r)},s=function(n,s){s.src.length>1e5&&t(n,s),e.send(Cv(n,"src",s.src,e.getBaseHref()))},r=e.safe(function(t){const n=BS(t.src||"");ov(n)&&e.send(Bv(e.timestamp(),0,0,0,0,0,n,"img",0,!1))}),o=e.safe(function(o){const i=e.nodes.getID(o);var a;void 0!==i&&o.complete&&(0!==o.naturalHeight||0!==o.naturalWidth||(a=o.src,Qb&&(a.startsWith("data:image/svg+xml")||a.match(/.svg$|/i)))?e.sanitizer.isHidden(i)||e.sanitizer.isObscured(i)?t(i,o):(s(i,o),n(i,o)):r(o))}),i=mv(e.safe(t=>{for(const r of t)if("attributes"===r.type){const t=r.target,o=e.nodes.getID(t);if(void 0===o)return;"src"===r.attributeName&&s(o,t),"srcset"===r.attributeName&&n(o,t)}}),e.options.forceNgOff);e.attachStopCallback(()=>{i.disconnect()}),e.nodes.attachNodeCallback(t=>{A_(t,"img")&&(e.nodes.attachNodeListener(t,"error",()=>r(t)),e.nodes.attachNodeListener(t,"load",()=>o(t)),o(t),i.observe(t,{attributes:!0,attributeFilter:["src","srcset"]}))})}(s),function(e,t){const n=Object.assign({obscureInputNumbers:!0,obscureInputEmails:!0,defaultInputMode:1,obscureInputDates:!1},t);function s(t,s){let r=s.value,o=n.defaultInputMode;"password"===s.type||e.sanitizer.isHidden(t)?o=2:(e.sanitizer.isObscured(t)||0===o&&(n.obscureInputNumbers&&"date"!==s.type&&/\d\d\d\d/.test(r)||n.obscureInputDates&&"date"===s.type||n.obscureInputEmails&&("email"===s.type||~r.indexOf("@"))))&&(o=1);let i=0;switch(o){case 2:i=-1,r="";break;case 1:i=r.length,r=""}return{value:r,mask:i}}function r(t,n){const{value:r,mask:o}=s(t,n);e.send(function(e,t,n){return[18,e,t,n]}(t,r,o))}const o=new Map,i=new Map;function a(e,t){o.get(e)!==t.value&&(o.set(e,t.value),r(e,t))}function c(t,n){i.get(t)!==n&&(i.set(t,n),e.send(function(e,t){return[19,e,t]}(t,n)))}e.attachStopCallback(()=>{o.clear(),i.clear()}),e.ticker.attach(()=>{o.forEach((t,n)=>{const s=e.nodes.getNode(n);if(!s)return o.delete(n);a(n,s)}),i.forEach((t,n)=>{const s=e.nodes.getNode(n);if(!s)return i.delete(n);c(n,s.checked)})},3),e.nodes.attachNodeCallback(e.safe(t=>{const n=e.nodes.getID(t);if(void 0!==n){if(A_(t,"select")&&(r(n,t),e.nodes.attachNodeListener(t,"change",()=>r(n,t))),function(e){return!!A_(e,"textarea")||!!A_(e,"input")&&US.includes(e.type)}(t)){a(n,t);let r=0,o=0,i=0;const c=()=>{r=nv()},u=()=>{0===o&&0!==r&&(o=nv()-r)},l=()=>{0!==r&&(i=nv()-r),function(t,n,r,o){const{value:i,mask:a}=s(t,n);let c=zS(n);e.sanitizer.privateMode&&(c=c.replaceAll(/./g,"*")),e.send(function(e,t,n,s,r,o){return[112,e,t,n,s,r,o]}(t,i,0!==a,c,r,o))}(n,t,o,i),o=0,i=0,r=0};return e.nodes.attachNodeListener(t,"focus",c),e.nodes.attachNodeListener(t,"input",u),void e.nodes.attachNodeListener(t,"change",l)}return function(e){if(!A_(e,"input"))return!1;const t=e.type;return"checkbox"===t||"radio"===t}(t)?(c(n,t.checked),void e.nodes.attachNodeListener(t,"change",()=>c(n,t.checked))):void 0}}))}(s,e),Nw(s,e),function(e){function t(t){const n=e.nodes.getID(t);void 0!==n&&e.send(Iv(n))}let n=!1;e.nodes.attachNodeCallback(s=>{A_(s,"body")&&(e.nodes.attachNodeListener(s,"focus",e=>{E_(e.target)&&(t(e.target),n=!1)}),e.nodes.attachNodeListener(s,"blur",t=>{null===t.relatedTarget&&(n=!0,setTimeout(()=>{n&&e.send(Iv(-1))},0))}))}),e.attachStartCallback(()=>{let e=document.activeElement;for(;e&&A_(e,"iframe")&&e.contentDocument;)e=e.contentDocument.activeElement;e&&e!==e.ownerDocument.body&&t(e)},!0)}(s),function(e){if(!window.FontFace)return;const t=new Map,n=n=>{class s extends n.FontFace{constructor(...s){if("string"==typeof s[1]){let r="";s[2]&&e.safe(()=>{r=JSON.stringify(s[2])});const o=[s[0],s[1],r],i=t.get(n.document)||[];i.push(o),t.set(n.document,i);const a=n===window?0:e.nodes.getID(n.document);if(void 0===a)return;e.active()&&e.send(Ev(a,...o))}super(...s)}}n.FontFace=s};e.observer.attachContextCallback(n),n(window),e.nodes.attachNodeCallback(e.safe(n=>{if(!R_(n))return;const s=t.get(n);if(!s)return;const r=n.defaultView===window?0:e.nodes.getID(n);void 0!==r&&s.forEach(t=>{e.send(Ev(r,...t))})}))}(s);const r=e.network?.disabled;r||uk(s,e.network),function(e){e.attachEventListener(document,"selectionchange",()=>{const t=document.getSelection();if(null===t||t.isCollapsed)e.send($v(-1,-1,""));else{const n=e.nodes.getID(t.anchorNode),s=e.nodes.getID(t.focusNode),r=t.toString().replace(/\s+/g," ");n&&s&&e.send($v(n,s,r))}})}(s),window.__OPENREPLAY__=this,e.flags&&e.flags.onFlagsLoad&&this.onFlagsLoad(e.flags.onFlagsLoad);const o=window.open;(e.autoResetOnWindowOpen||e.resetTabOnWindowOpen)&&(s.attachStartCallback(()=>{const t=s.getTabId(),n=s.sessionStorage??window.sessionStorage;window.open=function(...r){return e.autoResetOnWindowOpen&&s.resetNextPageSession(!0),e.resetTabOnWindowOpen&&n.removeItem(e.session_tabid_key||"__openreplay_tabid"),s.resetNextPageSession(!1),n.setItem(e.session_tabid_key||"__openreplay_tabid",t),o.call(window,...r)}}),s.attachStopCallback(()=>{window.open=o}))}isFlagEnabled(e){return this.featureFlags.isFlagEnabled(e)}onFlagsLoad(e){this.app?.featureFlags.onFlagsLoad(e)}clearPersistFlags(){this.app?.featureFlags.clearPersistFlags()}reloadFlags(){return this.app?.featureFlags.reloadFlags()}getFeatureFlag(e){return this.app?.featureFlags.getFeatureFlag(e)}getAllFeatureFlags(){return this.app?.featureFlags.flags}use(e){return e(this.app,this.options)}isActive(){return null!==this.app&&this.app.active()}trackWs(e){if(null!==this.app)return this.app.trackWs(e)}start(e){return this.browserEnvCheck()?null===this.app?Promise.reject("Browser doesn't support required api, or doNotTrack is active."):this.app.start(e):Promise.reject("Trying to start not in browser.")}browserEnvCheck(){return!!Yb||(console.error(`OpenReplay: you are trying to start Tracker on a node.js environment. If you want to use OpenReplay with SSR, please, use componentDidMount or useEffect API for placing the \`tracker.start()\` line. Check documentation on ${iv}${lk}`),!1)}coldStart(e,t){return this.browserEnvCheck()?null===this.app?Promise.reject("Tracker not initialized"):void this.app.coldStart(e,t):Promise.reject("Trying to start not in browser.")}startOfflineRecording(e,t){return this.browserEnvCheck()?null===this.app?Promise.reject("Tracker not initialized"):this.app.offlineRecording(e,t):Promise.reject("Trying to start not in browser.")}uploadOfflineRecording(){if(null!==this.app)return this.app.uploadOfflineRecording()}stop(){if(null!==this.app)return this.app.stop(),this.app.session.getSessionHash()}forceFlushBatch(){null!==this.app&&this.app.forceFlushBatch()}getSessionToken(){return null===this.app?null:this.app.getSessionToken()}getSessionInfo(){return null===this.app?null:this.app.session.getInfo()}getSessionID(){return null===this.app?null:this.app.getSessionID()}getTabId(){return null===this.app?null:this.app.getTabId()}getUxId(){return null===this.app?null:this.app.getUxtId()}sessionID(){return cv("'sessionID' method","'getSessionID' method","/"),this.getSessionID()}getSessionURL(e){if(null!==this.app)return this.app.getSessionURL(e)}setUserID(e){"string"==typeof e&&null!==this.app&&this.app.session.setUserID(e)}userID(e){cv("'userID' method","'setUserID' method","/"),this.setUserID(e)}setUserAnonymousID(e){"string"==typeof e&&null!==this.app&&this.app.send(function(e){return[29,e]}(e))}userAnonymousID(e){cv("'userAnonymousID' method","'setUserAnonymousID' method","/"),this.setUserAnonymousID(e)}setMetadata(e,t){"string"==typeof e&&"string"==typeof t&&null!==this.app&&this.app.session.setMetadata(e,t)}metadata(e,t){cv("'metadata' method","'setMetadata' method","/"),this.setMetadata(e,t)}event(e,t=null,n=!1){if("string"==typeof e&&null!==this.app){if(n)return this.issue(e,t);try{t=JSON.stringify(t)}catch(e){return}this.app.send(function(e,t){return[27,e,t]}(e,t))}}issue(e,t=null){if("string"==typeof e&&null!==this.app){try{t=JSON.stringify(t)}catch(e){return}this.app.send(function(e,t){return[64,e,t]}(e,t))}}}function pk(e,t,n){return(t=function(e){var t=function(e){if("object"!=hk(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=hk(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==hk(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hk(e){return hk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hk(e)}new class{constructor(){this.instance=null,this.isConfigured=!1}configure(e){Yb&&(this.isConfigured?console.warn("OpenReplay: Tracker is already configured. You should only call configure once."):e.projectKey?(this.instance=new dk(e),this.isConfigured=!0):console.error("OpenReplay: Missing required projectKey option"))}get options(){return this.instance?.options||null}start(e){return Yb?this.ensureConfigured()?this.instance?.start(e)||Promise.resolve({success:!1,reason:"Tracker not initialized"}):Promise.resolve({success:!1,reason:"Tracker not configured"}):Promise.resolve({success:!1,reason:"Not in browser environment"})}stop(){if(Yb&&this.ensureConfigured()&&this.instance)return this.instance.stop()}setUserID(e){Yb&&this.ensureConfigured()&&this.instance&&this.instance.setUserID(e)}setMetadata(e,t){Yb&&this.ensureConfigured()&&this.instance&&this.instance.setMetadata(e,t)}getSessionURL(e){if(Yb&&this.ensureConfigured()&&this.instance)return this.instance.getSessionURL(e)}getSessionID(){return Yb&&this.ensureConfigured()&&this.instance?this.instance.getSessionID():null}getSessionToken(){return Yb&&this.ensureConfigured()&&this.instance?this.instance.getSessionToken():null}event(e,t=null,n=!1){Yb&&this.ensureConfigured()&&this.instance&&this.instance.event(e,t,n)}issue(e,t=null){Yb&&this.ensureConfigured()&&this.instance&&this.instance.issue(e,t)}handleError(e,t={}){Yb&&this.ensureConfigured()&&this.instance&&this.instance.handleError(e,t)}isFlagEnabled(e){return!!(Yb&&this.ensureConfigured()&&this.instance)&&this.instance.isFlagEnabled(e)}onFlagsLoad(...e){Yb&&this.ensureConfigured()&&this.instance&&this.instance.onFlagsLoad(...e)}clearPersistFlags(){Yb&&this.ensureConfigured()&&this.instance&&this.instance.clearPersistFlags()}reloadFlags(){if(Yb&&this.ensureConfigured()&&this.instance)return this.instance.reloadFlags()}getFeatureFlag(e){if(Yb&&this.ensureConfigured()&&this.instance)return this.instance.getFeatureFlag(e)}getAllFeatureFlags(){if(Yb&&this.ensureConfigured()&&this.instance)return this.instance.getAllFeatureFlags()}restartCanvasTracking(){Yb&&this.ensureConfigured()&&this.instance&&this.instance.restartCanvasTracking()}setUserAnonymousID(e){Yb&&this.ensureConfigured()&&this.instance&&this.instance.setUserAnonymousID(e)}isActive(){return!!(Yb&&this.ensureConfigured()&&this.instance)&&this.instance.isActive()}getInstance(){return this.ensureConfigured()&&Yb?this.instance:null}coldStart(e,t){if(Yb&&this.ensureConfigured()&&this.instance)return this.instance.coldStart(e,t)}trackWs(e){return Yb&&this.ensureConfigured()&&this.instance?this.instance.trackWs(e):()=>{}}ensureConfigured(){return!(!this.isConfigured&&Yb&&(console.warn('OpenReplay: Tracker must be configured before use. Call tracker.configure({projectKey: "your-project-key"}) first.'),1))}use(e){return Yb&&this.ensureConfigured()&&this.instance?this.instance.use(e):e(null)}startOfflineRecording(...e){if(Yb&&this.ensureConfigured()&&this.instance)return this.instance.startOfflineRecording(...e)}uploadOfflineRecording(){if(Yb&&this.ensureConfigured()&&this.instance)return this.instance.uploadOfflineRecording()}forceFlushBatch(){if(Yb&&this.ensureConfigured()&&this.instance)return this.instance.forceFlushBatch()}getSessionInfo(){return Yb&&this.ensureConfigured()&&this.instance?this.instance.getSessionInfo():null}getTabId(){return Yb&&this.ensureConfigured()&&this.instance?this.instance.getTabId():null}getUxId(){return Yb&&this.ensureConfigured()&&this.instance?this.instance.getUxId():null}};var fk="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):null,mk=1e4;function gk(e){if(null==e)return e;try{if(e.length>mk)return e.slice(0,mk)+"...[truncated ".concat(e.length-mk," chars]")}catch(e){}return e}function yk(e){if(null==e)return e;try{if(fk&&e instanceof ArrayBuffer)return gk(fk.decode(new Uint8Array(e)))}catch(e){}try{if(fk&&ArrayBuffer.isView(e))return gk(fk.decode(e))}catch(e){}if("undefined"!=typeof Blob&&e instanceof Blob)return"[Blob: ".concat(e.size||"unknown"," bytes, type: ").concat(e.type||"unknown","]");if("string"==typeof e)return gk(e);if("object"===hk(e))try{return gk(JSON.stringify(e))}catch(t){return"[object: ".concat(e&&e.constructor?e.constructor.name:"unknown","]")}try{return String(e)}catch(e){return"[unserializable]"}}window.NapkinOR={isReady:!1,init:function(){var e=this;try{var t=window.location.hostname;if(t.includes("local"))return void console.debug("Skipping OpenReplay on local environment.",t);this.tracker=new dk(pk(pk(pk({projectKey:qy()?"ST6CHB3GxKaUNbCNSHjO":"qEGEoiTtThbyhGAnnMX2",ingestPoint:"https://openreplay.napkin.ai/ingest",disableSprites:!0,capturePerformance:!0,consoleThrottling:500,defaultInputMode:0,obscureTextNumbers:!1,obscureTextEmails:!1,obscureInputEmails:!1},"defaultInputMode",0),"__DISABLE_SECURE_MODE",!0!==qy()),"network",{captureHeaders:!0,captureContent:!0,capturePayload:!0,sanitizer:function(e){try{if(e.status<300)e.request.body=null,e.response.body=null;else{try{e.request.body=yk(e.request.body)}catch(e){console.warn("[OpenReplay] Failed to decode request body",e)}try{e.response.body=yk(e.response.body)}catch(e){console.warn("[OpenReplay] Failed to decode response body",e)}}}catch(e){console.error("[OpenReplay] Error in network sanitizer: ",e)}return e}})),this.tracker.start().then(function(){if(e.isReady=!0,console.debug("[OpenReplay] Started",e.tracker.getSessionURL()),window.NapkinSentry){var t=window.NapkinSentry.getClient();t&&(t.setTag("openReplaySessionID",e.tracker.getSessionID()),t.setTag("openReplaySessionToken",e.tracker.getSessionToken()))}}),console.debug("[OpenReplay] Loaded")}catch(e){console.error("[OpenReplay] Error in init: ",e)}},getClient:function(){return this.tracker}},window.NapkinOR.init(),qy()?window.NapkinSentry.init():console.log("[Sentry] Sentry is not loaded in development mode")})();
//# sourceMappingURL=m.js.map?t=a9c702fd8