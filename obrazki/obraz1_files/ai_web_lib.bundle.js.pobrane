/*! For license information please see ai_web_lib.bundle.js.LICENSE.txt */
var ai_web_lib;(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function n(){var e,t,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function s(o,n,i,a){var s=n&&n.prototype instanceof c?n:c,u=Object.create(s.prototype);return r(u,"_invoke",function(o,n,r){var i,a,s,c=0,u=r||[],f=!1,d={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,o){return i=t,a=0,s=e,d.n=o,l}};function h(o,n){for(a=o,s=n,t=0;!f&&c&&!r&&t<u.length;t++){var r,i=u[t],h=d.p,p=i[2];o>3?(r=p===n)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=h&&((r=o<2&&h<i[1])?(a=0,d.v=n,d.n=i[1]):h<p&&(r=o<3||i[0]>n||n>p)&&(i[4]=o,i[5]=n,d.n=p,a=0))}if(r||o>1)return l;throw f=!0,n}return function(r,u,p){if(c>1)throw TypeError("Generator is already running");for(f&&1===u&&h(u,p),a=u,s=p;(t=a<2?e:s)||!f;){i||(a?a<3?(a>1&&(d.n=-1),h(a,s)):d.n=s:d.v=s);try{if(c=2,i){if(a||(r="next"),t=i[r]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=e}else if((t=(f=d.n<0)?s:o.call(n,d))!==l)break}catch(t){i=e,a=1,s=t}finally{c=1}}return{value:t,done:f}}}(o,i,a),!0),u}var l={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var d=[][i]?t(t([][i]())):(r(t={},i,function(){return this}),t),h=f.prototype=c.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,a,"GeneratorFunction")),e.prototype=Object.create(h),e}return u.prototype=f,r(h,"constructor",f),r(f,"constructor",u),u.displayName="GeneratorFunction",r(f,a,"GeneratorFunction"),r(h),r(h,a,"Generator"),r(h,i,function(){return this}),r(h,"toString",function(){return"[object Generator]"}),(n=function(){return{w:s,m:p}})()}function r(e,t,o,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}r=function(e,t,o,n){function a(t,o){r(e,t,function(e){return this._invoke(t,o,e)})}t?i?i(e,t,{value:o,enumerable:!n,configurable:!n,writable:!n}):e[t]=o:(a("next",0),a("throw",1),a("return",2))},r(e,t,o,n)}function i(e,t,o,n,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void o(e)}s.done?t(l):Promise.resolve(l).then(n,r)}function a(e){return function(){var t=this,o=arguments;return new Promise(function(n,r){var a=e.apply(t,o);function s(e){i(a,n,r,s,l,"next",e)}function l(e){i(a,n,r,s,l,"throw",e)}s(void 0)})}}function s(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}e.r(t),e.d(t,{TensorflowModel:()=>c});var c=function(){return e=function e(t,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modelName=t,this.shapes=o,this.lengths=this.shapes.map(function(e){return e.reduce(function(e,t){return e*t})}),this.model=void 0,this.state="not_loaded",this.modelLoadingPromise=void 0,console.log("TensorflowModel constructor: ",this.modelName)},t=[{key:"_getTensorflow",value:(c=a(n().m(function e(){var t;return n().w(function(e){for(;;)switch(e.n){case 0:if(window.tensorflow){e.n=2;break}if(!window.tensorflowModelLoadingPromise){e.n=1;break}return e.a(2,window.tensorflowModelLoadingPromise);case 1:return console.log("Loading TensorFlow..."),(t=document.createElement("script")).setAttribute("src","/bundle/ai-tensorflow-web-lib/ai_tensorflow_web_lib.bundle.js"),t.setAttribute("type","text/javascript"),t.setAttribute("charset","utf-8"),document.head.appendChild(t),window.tensorflowModelLoadingPromise=new Promise(function(e,o){t.onload=function(){if(window.tensorflow)console.log("TensorFlow loaded"),e(window.tensorflow);else var t=setInterval(function(){window.tensorflow?(console.log("TensorFlow loaded"),clearInterval(t),e(window.tensorflow)):console.log("Waiting for TensorFlow...")},100)},t.onerror=function(){console.error("Error loading TensorFlow"),o()}}),e.a(2,window.tensorflowModelLoadingPromise);case 2:return e.a(2,window.tensorflow)}},e)})),function(){return c.apply(this,arguments)})},{key:"loaded",value:function(){return"loaded"===this.state}},{key:"summary",value:function(){"loaded"===this.state&&void 0!==this.model?this.model.summary():console.log("Model not loaded")}},{key:"load",value:function(){return null!=this.modelLoadingPromise||(this.modelLoadingPromise=this.loadingInternal()),this.modelLoadingPromise}},{key:"loadingInternal",value:(l=a(n().m(function e(){var t=this;return n().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(){var e=a(n().m(function e(o,r){var i;return n().w(function(e){for(;;)switch(e.n){case 0:return console.log("loadingInternal",t.modelName),e.n=1,t._getTensorflow();case 1:if(i=e.v){e.n=2;break}return console.error("tensorflow not loaded yet"),e.a(2);case 2:return t.state="loading",e.n=3,i.loadLayersModel(t.modelName,{strict:!0}).then(function(e){return t.state="loaded",console.log("tensorflow model success",t.modelName),e},function(e){t.modelLoadingPromise=void 0,t.state="error",console.error("tensorflow model error",t.modelName,e)});case 3:t.model=e.v,t.model?o():r(null);case 4:return e.a(2)}},e)}));return function(t,o){return e.apply(this,arguments)}}()))},e)})),function(){return l.apply(this,arguments)})},{key:"predictAsync",value:(i=a(n().m(function e(t){var o;return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this._getTensorflow();case 1:if(o=e.v){e.n=2;break}return console.error("tensorflow not loaded yet"),e.a(2,[]);case 2:return e.a(2,this.predict(t,o))}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.tensorflow;if(!t)return console.debug("tensorflow not loaded yet"),[];if("loaded"!==this.state||void 0===this.model)return[];for(var o=t.tensor(e),n=[],r=0,i=0;i<this.shapes.length;i++)n.push(t.reshape(t.slice(o,r,this.lengths[i]<0?-1:this.lengths[i]),this.shapes[i])),r+=this.lengths[i];if(n.length!=this.model.inputs.length)throw"Unexpected tensor length, created ".concat(n.length," tensors instead of ").concat(this.model.inputs.length," expected tensors, shapes is [").concat(this.shapes,"] and input data [").concat(e,"]");var a=this.model.predict(n);if(Array.isArray(a)){for(var s in a)a[s]=t.reshape(a[s],[-1]);a=t.concat(a,0)}return t.reshape(a,[-1]).arraySync()}},{key:"getBackend",value:(r=a(n().m(function e(){var t;return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this._getTensorflow();case 1:if(t=e.v){e.n=2;break}return console.error("tensorflow not loaded yet"),e.a(2,"");case 2:return e.a(2,t.getBackend())}},e,this)})),function(){return r.apply(this,arguments)})},{key:"setBackend",value:(o=a(n().m(function e(t){var o;return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this._getTensorflow();case 1:if(o=e.v){e.n=2;break}return console.error("tensorflow not loaded yet"),e.a(2);case 2:o.setBackend(t);case 3:return e.a(2)}},e,this)})),function(e){return o.apply(this,arguments)})}],t&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,o,r,i,l,c}();ai_web_lib=t})();